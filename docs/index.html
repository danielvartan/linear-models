<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Daniel Vartanian">
<meta name="dcterms.date" content="2024-10-04">
<title>General linear models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="site_libs/quarto-diagram/mermaid.min.js"></script><script src="site_libs/quarto-diagram/mermaid-init.js"></script><link href="site_libs/quarto-diagram/mermaid.css" rel="stylesheet">
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="site_libs/rglWebGL-binding-1.3.1/rglWebGL.js"></script><link href="site_libs/rglwidgetClass-1.3.1/rgl.css" rel="stylesheet">
<script src="site_libs/rglwidgetClass-1.3.1/rglClass.src.js"></script><script src="site_libs/rglwidgetClass-1.3.1/utils.src.js"></script><script src="site_libs/rglwidgetClass-1.3.1/buffer.src.js"></script><script src="site_libs/rglwidgetClass-1.3.1/subscenes.src.js"></script><script src="site_libs/rglwidgetClass-1.3.1/shaders.src.js"></script><script src="site_libs/rglwidgetClass-1.3.1/shadersrc.src.js"></script><script src="site_libs/rglwidgetClass-1.3.1/textures.src.js"></script><script src="site_libs/rglwidgetClass-1.3.1/projection.src.js"></script><script src="site_libs/rglwidgetClass-1.3.1/mouse.src.js"></script><script src="site_libs/rglwidgetClass-1.3.1/init.src.js"></script><script src="site_libs/rglwidgetClass-1.3.1/pieces.src.js"></script><script src="site_libs/rglwidgetClass-1.3.1/draw.src.js"></script><script src="site_libs/rglwidgetClass-1.3.1/controls.src.js"></script><script src="site_libs/rglwidgetClass-1.3.1/selection.src.js"></script><script src="site_libs/rglwidgetClass-1.3.1/rglTimer.src.js"></script><script src="site_libs/rglwidgetClass-1.3.1/pretty.src.js"></script><script src="site_libs/rglwidgetClass-1.3.1/axes.src.js"></script><script src="site_libs/rglwidgetClass-1.3.1/animation.src.js"></script><script src="site_libs/CanvasMatrix4-1.3.1/CanvasMatrix.src.js"></script><link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item compact">
    <a class="nav-link" href="https://github.com/danielvartan/linear-models"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a></li>
  <li><a href="#question" id="toc-question" class="nav-link" data-scroll-target="#question">Question</a></li>
  <li><a href="#hypothesis" id="toc-hypothesis" class="nav-link" data-scroll-target="#hypothesis">Hypothesis</a></li>
  <li><a href="#methods" id="toc-methods" class="nav-link" data-scroll-target="#methods">Methods</a></li>
  <li>
<a href="#an-overview-of-general-linear-models" id="toc-an-overview-of-general-linear-models" class="nav-link" data-scroll-target="#an-overview-of-general-linear-models">An overview of general linear models</a>
  <ul class="collapse">
<li><a href="#definitions" id="toc-definitions" class="nav-link" data-scroll-target="#definitions">Definitions</a></li>
  <li><a href="#assumptions" id="toc-assumptions" class="nav-link" data-scroll-target="#assumptions">Assumptions</a></li>
  </ul>
</li>
  <li><a href="#setting-up-the-environment" id="toc-setting-up-the-environment" class="nav-link" data-scroll-target="#setting-up-the-environment">Setting up the environment</a></li>
  <li><a href="#preparing-the-data" id="toc-preparing-the-data" class="nav-link" data-scroll-target="#preparing-the-data">Preparing the data</a></li>
  <li><a href="#performing-the-power-analysis" id="toc-performing-the-power-analysis" class="nav-link" data-scroll-target="#performing-the-power-analysis">Performing the power analysis</a></li>
  <li><a href="#checking-distributions" id="toc-checking-distributions" class="nav-link" data-scroll-target="#checking-distributions">Checking distributions</a></li>
  <li><a href="#checking-correlations" id="toc-checking-correlations" class="nav-link" data-scroll-target="#checking-correlations">Checking correlations</a></li>
  <li>
<a href="#checking-for-outliers" id="toc-checking-for-outliers" class="nav-link" data-scroll-target="#checking-for-outliers">Checking for outliers</a>
  <ul class="collapse">
<li><a href="#boxplots" id="toc-boxplots" class="nav-link" data-scroll-target="#boxplots">Boxplots</a></li>
  <li><a href="#cooks-distance" id="toc-cooks-distance" class="nav-link" data-scroll-target="#cooks-distance">Cook’s distance</a></li>
  <li><a href="#outlier-removal" id="toc-outlier-removal" class="nav-link" data-scroll-target="#outlier-removal">Outlier removal</a></li>
  </ul>
</li>
  <li><a href="#fitting-the-model" id="toc-fitting-the-model" class="nav-link" data-scroll-target="#fitting-the-model">Fitting the model</a></li>
  <li>
<a href="#inspecting-the-model-fit" id="toc-inspecting-the-model-fit" class="nav-link" data-scroll-target="#inspecting-the-model-fit">Inspecting the model fit</a>
  <ul class="collapse">
<li><a href="#general-model" id="toc-general-model" class="nav-link" data-scroll-target="#general-model">General model</a></li>
  <li><a href="#adjusted-predictions" id="toc-adjusted-predictions" class="nav-link" data-scroll-target="#adjusted-predictions">Adjusted predictions</a></li>
  <li><a href="#posterior-predictive-checks" id="toc-posterior-predictive-checks" class="nav-link" data-scroll-target="#posterior-predictive-checks">Posterior predictive checks</a></li>
  </ul>
</li>
  <li>
<a href="#performing-model-diagnostics" id="toc-performing-model-diagnostics" class="nav-link" data-scroll-target="#performing-model-diagnostics">Performing model diagnostics</a>
  <ul class="collapse">
<li><a href="#normality" id="toc-normality" class="nav-link" data-scroll-target="#normality">Normality</a></li>
  <li><a href="#visual-inspection" id="toc-visual-inspection" class="nav-link" data-scroll-target="#visual-inspection">Visual inspection</a></li>
  <li><a href="#tests" id="toc-tests" class="nav-link" data-scroll-target="#tests">Tests</a></li>
  <li><a href="#linearity" id="toc-linearity" class="nav-link" data-scroll-target="#linearity">Linearity</a></li>
  <li><a href="#homoscedasticity-common-variance" id="toc-homoscedasticity-common-variance" class="nav-link" data-scroll-target="#homoscedasticity-common-variance">Homoscedasticity (common variance)</a></li>
  <li><a href="#independence" id="toc-independence" class="nav-link" data-scroll-target="#independence">Independence</a></li>
  <li><a href="#colinearitymulticollinearity" id="toc-colinearitymulticollinearity" class="nav-link" data-scroll-target="#colinearitymulticollinearity">Colinearity/Multicollinearity</a></li>
  <li><a href="#condition-index" id="toc-condition-index" class="nav-link" data-scroll-target="#condition-index">Condition Index</a></li>
  <li><a href="#measures-of-influence" id="toc-measures-of-influence" class="nav-link" data-scroll-target="#measures-of-influence">Measures of influence</a></li>
  </ul>
</li>
  <li><a href="#testing-the-hypothesis" id="toc-testing-the-hypothesis" class="nav-link" data-scroll-target="#testing-the-hypothesis">Testing the hypothesis</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  <li><a href="#notes" id="toc-notes" class="nav-link" data-scroll-target="#notes">Notes</a></li>
  <li><a href="#further-reading" id="toc-further-reading" class="nav-link" data-scroll-target="#further-reading">Further reading</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/danielvartan/linear-models/edit/main/index.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/danielvartan/linear-models/blob/main/index.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li><li><a href="https://github.com/danielvartan/linear-models/issues/" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">General linear models</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Daniel Vartanian </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">2024-10-04</p>
    </div>
  </div>
  
    
  </div>
  


</header><!-- badges: start --><p><a href="https://www.repostatus.org/#inactive"><img src="https://www.repostatus.org/badges/latest/inactive.svg" class="img-fluid" alt="Project Status: Inactive – The project has reached a stable, usable state but is no longer being actively developed; support/maintenance will be provided as time allows."></a> <a href="https://choosealicense.com/licenses/mit/"><img src="https://img.shields.io/badge/license-MIT-green.png" class="img-fluid" alt="License: MIT"></a> <!-- badges: end --></p>
<section id="overview" class="level2"><h2 class="anchored" data-anchor-id="overview">Overview</h2>
<p>This document demonstrates the application of <a href="https://en.wikipedia.org/wiki/General_linear_model">general linear models</a>, with a focus on multiple regression. It utilizes the <a href="https://allisonhorst.github.io/palmerpenguins/reference/penguins.html"><code>penguins</code></a> dataset from the <a href="https://github.com/allisonhorst/palmerpenguins/"><code>palmerpenguins</code></a> R package, which contains measurements of penguin species from the <a href="https://en.wikipedia.org/wiki/Palmer_Archipelago">Palmer Archipelago</a>. The dataset was originally introduced by <span class="citation" data-cites="gorman2014">Gorman et al. (<a href="#ref-gorman2014" role="doc-biblioref">2014</a>)</span>.</p>
<div id="fig-penguins-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-penguins-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/palmer_penguins.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:75.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-penguins-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Artwork by <a href="https://allisonhorst.com/">Allison Horst</a>.
</figcaption></figure>
</div>
</section><section id="question" class="level2"><h2 class="anchored" data-anchor-id="question">Question</h2>
<p><strong>Can bill length and bill depth alone effectively predict flipper length in <a href="https://en.wikipedia.org/wiki/Ad%C3%A9lie_penguin">Adélie penguins</a>?</strong></p>
<p>Imagine a debate between two marine biologists: one claims that bill length and depth could be used to predict flipper length, while the other disagrees.</p>
<p>To investigate this question, we will utilize a dataset from the <a href="https://github.com/allisonhorst/palmerpenguins/"><code>palmerpenguins</code></a> R package. The relevant variables are <code>bill_length_mm</code>,<code>bill_depth_mm</code> and <code>flipper_length_mm</code> for Adélie penguins. These variables are <a href="https://allisonhorst.github.io/palmerpenguins/reference/penguins.html">defined</a> as follows:</p>
<ul>
<li>
<code>bill_length_mm</code>: Numerical value representing the bill’s length in millimeters.</li>
<li>
<code>bill_depth_mm</code>: Numerical value representing the bill’s depth in millimeters.</li>
<li>
<code>flipper_length_mm</code>: Integer value representing the flipper’s length in millimeters.</li>
</ul>
<div id="fig-penguins-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-penguins-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/culmen_depth.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:75.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-penguins-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Artwork by <a href="https://allisonhorst.com/">Allison Horst</a>.
</figcaption></figure>
</div>
</section><section id="hypothesis" class="level2"><h2 class="anchored" data-anchor-id="hypothesis">Hypothesis</h2>
<p>To approach this question, we will apply Popper’s hypothetico-deductive method, also known as the <em>method of conjecture and refutation</em> <span class="citation" data-cites="popper1979">(<a href="#ref-popper1979" role="doc-biblioref">Popper, 1979, p. 164</a>)</span>. The basic structure of this approach can be summarized as follows:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-mermaid" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-mermaid-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div>
<pre class="mermaid mermaid-js" data-label="fig-mermaid">flowchart LR
  A(P1) --&gt; B(TT)
  B --&gt; C(EE)
  C --&gt; D(P2)
</pre>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mermaid-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Simplified schema of Popper’s hypothetico-deductive method.
</figcaption></figure>
</div>
</div>
</div>
<p>“Here <span class="math inline">\(\text{P}_1\)</span>, is the <strong>problem</strong> from which we start, <span class="math inline">\(\text{TT}\)</span> (the ‘tentative theory’) is the imaginative conjectural solution which we first reach, for example our first <strong>tentative interpretation</strong>. <span class="math inline">\(\text{EE}\)</span> (‘<strong>error- elimination</strong>’) consists of a severe critical examination of our conjecture, our tentative interpretation: it consists, for example, of the critical use of documentary evidence and, if we have at this early stage more than one conjecture at our disposal, it will also consist of a critical discussion and comparative evaluation of the competing conjectures. <span class="math inline">\(\text{P}_2\)</span> is the problem situation as it emerges from our first critical attempt to solve our problems. It leads up to our second attempt (<strong>and so on</strong>).” <span class="citation" data-cites="popper1979">(<a href="#ref-popper1979" role="doc-biblioref">Popper, 1979, p. 164</a>)</span></p>
<p>As our tentative theory or main hypothesis, we propose the following:</p>
<p><strong>Bill length and bill depth can effectively predict flipper length in Adélie penguins</strong>.</p>
<p>As a procedure method, we will employ a method <strong>inpired</strong> by the Neyman-Pearson approach to data testing <span class="citation" data-cites="neyman1928 neyman1928a perezgonzalez2015">(<a href="#ref-neyman1928" role="doc-biblioref">Neyman &amp; Pearson, 1928a</a>, <a href="#ref-neyman1928a" role="doc-biblioref">1928b</a>; <a href="#ref-perezgonzalez2015" role="doc-biblioref">Perezgonzalez, 2015</a>)</span>, evaluating the following hypotheses:</p>
<p><span class="math display">\[
\begin{cases}
\text{H}_{0}: \text{Bill length and bill depth cannot effectively predict flipper length in Adélie penguins} \\
\text{H}_{a}: \text{Bill length and bill depth can effectively predict flipper length in Adélie penguins}
\end{cases}
\]</span></p>
<div class="callout callout-style-simple callout-warning">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Technically, our procedural method is not a strictly Neyman-Pearson acceptance test; we might refer to it as an improved <a href="https://en.wikipedia.org/wiki/Statistical_hypothesis_test">NHST</a> (Null Hypothesis Significance Testing) approach, based on the original Neyman-Pearson ideas.</p>
</div>
</div>
</div>
</section><section id="methods" class="level2"><h2 class="anchored" data-anchor-id="methods">Methods</h2>
<p>To test this hypothesis, we will use a general linear model with multiple regression analysis, evaluating the relationship between multiple predictors and a response variable. Here, the response variable is <code>flipper_length_mm</code>, while the predictors are <code>bill_length_mm</code> and <code>bill_depth_mm</code>.</p>
<p>To define what we mean by “effectively predict,” we will establish the following decision criteria:</p>
<ul>
<li>Predictors must exert a statistically significant effect on the response variable.</li>
<li>The model should satisfy all validity assumptions.</li>
<li>The variance explained by the predictors (<span class="math inline">\(\text{R}^{2}_{\text{adj}}\)</span>) must exceed 0.5, indicating a substantial effect on the response variable (<span class="math inline">\(\text{Cohen's } f^2 = \cfrac{0.5}{1 - 0.5} = 1\)</span>.)</li>
</ul>
<p>This 0.5 threshold is not arbitrary; it represents the average level of variance explained in response variables during observational field studies in ecology, especially when there is limited control over factors influencing variance <span class="citation" data-cites="peek2003">(<a href="#ref-peek2003" role="doc-biblioref">Peek et al., 2003</a>)</span>.</p>
<p>Finally, our hypothesis test can be systematized as follows:</p>
<p><span class="math display">\[
\begin{cases}
\text{H}_{0}: \text{R}^{2}_{\text{adj}} \leq 0.5 \\
\text{H}_{a}: \text{R}^{2}_{\text{adj}} &gt; 0.5
\end{cases}
\]</span></p>
<p>In addition to an adjusted R-squared greater than 0.5, we will require predictor effects to be statistically significant and all model assumptions to be met.</p>
<p>We will set the significance level (<span class="math inline">\(\alpha\)</span>) at 0.05, allowing a 5% chance of a <a href="https://en.wikipedia.org/wiki/Type_I_and_type_II_errors">Type I error</a>. A power analysis will be performed to determine the necessary sample size for detecting a significant effect, targeting a power (<span class="math inline">\(1 - \beta\)</span>) of 0.8.</p>
<p>Assumption checks will include:</p>
<ul>
<li>Assessing the normality of residuals through visual inspections, such as <a href="https://en.wikipedia.org/wiki/Q%E2%80%93Q_plot">Q-Q plots</a>, and statistical tests like the <a href="https://en.wikipedia.org/wiki/Shapiro%E2%80%93Wilk_test">Shapiro-Wilk test</a>.</li>
<li>Evaluating homoscedasticity using tests like the <a href="https://en.wikipedia.org/wiki/Breusch%E2%80%93Pagan_test">Breusch-Pagan test</a> to ensure constant variance of residuals across predictor levels.</li>
</ul>
<p>We will assess multicollinearity by calculating variance inflation factors (<a href="https://en.wikipedia.org/wiki/Variance_inflation_factor">VIF</a>), with a VIF above 10 indicating potential issues. Influential points will be examined using <a href="https://en.wikipedia.org/wiki/Cook%27s_distance">Cook’s distance</a> and leverage values to identify any points that may disproportionately affect model outcomes.</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>It’s important to emphasize that we are assessing predictive power, not establishing causality. Predictive models alone should never be used to infer causal relationships <span class="citation" data-cites="arif2022">(<a href="#ref-arif2022" role="doc-biblioref">Arif &amp; MacNeil, 2022</a>)</span>.</p>
</div>
</div>
</div>
</section><section id="an-overview-of-general-linear-models" class="level2"><h2 class="anchored" data-anchor-id="an-overview-of-general-linear-models">An overview of general linear models</h2>
<p>Before proceeding, let’s briefly overview general linear models, with a focus on multiple regression analysis.</p>
<p>“[…] A problem of this type is called a problem of multiple linear regression because we are considering the regression of <span class="math inline">\(Y\)</span> on <span class="math inline">\(k\)</span> variables <span class="math inline">\(X_{1}, \dots, X_{k}\)</span>, rather than on just a single variable <span class="math inline">\(X\)</span>, and we are assuming also that this regression is a linear function of the parameters <span class="math inline">\(\beta_{0}, \dots, \beta_{k}\)</span>. In a problem of multiple linear regressions, we obtain <span class="math inline">\(n\)</span> vectors of observations (<span class="math inline">\(x_{i1}. \dots, x_{ik}, Y_{i}\)</span>), for <span class="math inline">\(i = 1, \dots, n\)</span>. Here <span class="math inline">\(x_{ij}\)</span> is the observed value of the variable <span class="math inline">\(X_{j}\)</span> for the <span class="math inline">\(i\)</span>th observation. The <span class="math inline">\(E(Y)\)</span> is given by the relation</p>
<p><span class="math display">\[
E(Y_{i}) = \beta_{0} + \beta_{1} x_{i1} + \dots + \beta_{k} x_{ik}
\]</span></p>
<p><span class="citation" data-cites="degroot2012">(<a href="#ref-degroot2012" role="doc-biblioref">DeGroot &amp; Schervish, 2012, p. 738</a>)</span></p>
<section id="definitions" class="level3"><h3 class="anchored" data-anchor-id="definitions">Definitions</h3>
<dl>
<dt>Residuals/Fitted values</dt>
<dd>
For <span class="math inline">\(i = 1, \dots, n\)</span>, the observed values of <span class="math inline">\(\hat{y} = \hat{\beta}_{0} + \hat{\beta}_{1} x_{i}\)</span> are called <em>fitted values</em>. For <span class="math inline">\(i = 1, \dots, n\)</span>, the observed values of <span class="math inline">\(e_{i} = y_{i} - \hat{y}_{i}\)</span> are called <em>residuals</em> <span class="citation" data-cites="degroot2012">(<a href="#ref-degroot2012" role="doc-biblioref">DeGroot &amp; Schervish, 2012, p. 717</a>)</span>.
</dd>
</dl>
<p>“[…] regression problems in which the observations <span class="math inline">\(Y_{i}, \dots, Y_{n}\)</span> […] we shall assume that each observation <span class="math inline">\(Y_{i}\)</span> has a normal distribution, that the observations <span class="math inline">\(Y_{1}, \dots, Y_{n}\)</span> are independent, and that the observations <span class="math inline">\(Y_{1}, \dots, Y_{n}\)</span> have the same variance <span class="math inline">\(\sigma^{2}\)</span>. Instead of a single predictor being associated with each <span class="math inline">\(Y_{i}\)</span>, we assume that a <span class="math inline">\(p\)</span>-dimensional vector <span class="math inline">\(z_{i} = (z_{i0}, \dots, z_{ip - 1})\)</span> is associated with each <span class="math inline">\(Y_{i}\)</span>” <span class="citation" data-cites="degroot2012">(<a href="#ref-degroot2012" role="doc-biblioref">DeGroot &amp; Schervish, 2012, p. 736</a>)</span>.</p>
<dl>
<dt>General linear model</dt>
<dd>
The statistical model in which the observations <span class="math inline">\(Y_{1}, \dots, Y_{n}\)</span> satisfy the following assumptions <span class="citation" data-cites="degroot2012">(<a href="#ref-degroot2012" role="doc-biblioref">DeGroot &amp; Schervish, 2012, p. 738</a>)</span>.
</dd>
</dl></section><section id="assumptions" class="level3"><h3 class="anchored" data-anchor-id="assumptions">Assumptions</h3>
<dl>
<dt>Assumption 1</dt>
<dd>
<strong>Predictor is known</strong>. Either the vectors <span class="math inline">\(z_{1}, \dots , z_{n}\)</span> are known ahead of time, or they are the observed values of random vectors <span class="math inline">\(Z_{1}, \dots , Z_{n}\)</span> on whose values we condition before computing the joint distribution of (<span class="math inline">\(Y_{1}, \dots , Y_{n}\)</span>) <span class="citation" data-cites="degroot2012">(<a href="#ref-degroot2012" role="doc-biblioref">DeGroot &amp; Schervish, 2012, p. 736</a>)</span>.
</dd>
<dt>Assumption 2</dt>
<dd>
<strong>Normality</strong>. For <span class="math inline">\(i = 1, \dots, n\)</span>, the conditional distribution of <span class="math inline">\(Y_{i}\)</span> given the vectors <span class="math inline">\(z_{1}, \dots , z_{n}\)</span> is a normal distribution <span class="citation" data-cites="degroot2012">(<a href="#ref-degroot2012" role="doc-biblioref">DeGroot &amp; Schervish, 2012, p. 737</a>)</span>.
</dd>
</dl>
<p>(Normality of the error term distribution <span class="citation" data-cites="hair2019">(<a href="#ref-hair2019" role="doc-biblioref">Hair, 2019, p. 287</a>)</span>)</p>
<dl>
<dt>Assumption 3</dt>
<dd>
<strong>Linear mean</strong>. There is a vector of parameters <span class="math inline">\(\beta = (\beta_{0}, \dots, \beta_{p - 1})\)</span> such that the conditional mean of <span class="math inline">\(Y_{i}\)</span> given the values <span class="math inline">\(z_{1}, \dots , z_{n}\)</span> has the form
</dd>
</dl>
<p><span class="math display">\[
z_{i0} \beta_{0} + z_{i1} \beta_{1} + \cdots + z_{ip - 1} \beta_{p - 1}
\]</span></p>
<p>for <span class="math inline">\(i = 1, \dots, n\)</span> <span class="citation" data-cites="degroot2012">(<a href="#ref-degroot2012" role="doc-biblioref">DeGroot &amp; Schervish, 2012, p. 737</a>)</span>.</p>
<p>(Linearity of the phenomenon measured <span class="citation" data-cites="hair2019">(<a href="#ref-hair2019" role="doc-biblioref">Hair, 2019, p. 287</a>)</span>)</p>
<div class="callout callout-style-simple callout-warning">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>It is important to clarify that the linear assumption pertains to <strong>linearity in the parameters</strong> or equivalently, linearity in the coefficients. This means that each predictor is multiplied by its corresponding regression coefficient. However, this does not imply that the relationship between the predictors and the response variable is linear. In fact, a linear model can still effectively capture non-linear relationships between predictors and the response variable by utilizing transformations of the predictors <span class="citation" data-cites="cohen2002">(<a href="#ref-cohen2002" role="doc-biblioref">Cohen et al., 2002</a>)</span>.</p>
</div>
</div>
</div>
<dl>
<dt>Assumption 4</dt>
<dd>
<strong>Common variance</strong> (homoscedasticity). There is as parameter <span class="math inline">\(\sigma^{2}\)</span> such the conditional variance of <span class="math inline">\(Y_{i}\)</span> given the values <span class="math inline">\(z_{1}, \dots , z_{n}\)</span> is <span class="math inline">\(\sigma^{2}\)</span> for <span class="math inline">\(i = 1, \dots\, n\)</span>.
</dd>
</dl>
<p>(Constant variance of the error terms <span class="citation" data-cites="hair2019">(<a href="#ref-hair2019" role="doc-biblioref">Hair, 2019, p. 287</a>)</span>)</p>
<dl>
<dt>Assumption 5</dt>
<dd>
<strong>Independence</strong>. The random variables <span class="math inline">\(Y_{1}, \dots , Y_{n}\)</span> are independent given the observed <span class="math inline">\(z_{1}, \dots , z_{n}\)</span> <span class="citation" data-cites="degroot2012">(<a href="#ref-degroot2012" role="doc-biblioref">DeGroot &amp; Schervish, 2012, p. 737</a>)</span>.
</dd>
</dl>
<p>(Independence of the error terms <span class="citation" data-cites="hair2019">(<a href="#ref-hair2019" role="doc-biblioref">Hair, 2019, p. 287</a>)</span>)</p>
</section></section><section id="setting-up-the-environment" class="level2"><h2 class="anchored" data-anchor-id="setting-up-the-environment">Setting up the environment</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://broom.tidymodels.org/">broom</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/">car</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://mllg.github.io/checkmate/">checkmate</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/">cowplot</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/effectsize/">effectsize</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://geobosh.github.io/fBasicsDoc/">fBasics</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://pkg.robjhyndman.com/forecast/">forecast</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://strengejacke.github.io/ggeffects/">ggeffects</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggobi.github.io/ggally/">GGally</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.r4photobiology.info/ggpmisc/">ggpmisc</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/GuangchuangYu/ggplotify">ggplotify</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/aloy/qqplotr">qqplotr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">ggPredict</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://glue.tidyverse.org/">glue</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/insight/">insight</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sfirke/janitor">janitor</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.stefanom.io/latex2exp/">latex2exp</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org">magrittr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.r-project.org">moments</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">nortest</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://olsrr.rsquaredacademy.com/">olsrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://allisonhorst.github.io/palmerpenguins/">palmerpenguins</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/parameters/">parameters</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/parsnip">parsnip</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/performance/">performance</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/cardiomoon/predict3d">predict3d</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">psychometric</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">pwrss</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/recipes">recipes</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/report/">report</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dmurdoch/rgl">rgl</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://danielvartan.github.io/rutils/">rutils</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://sandwich.R-Forge.R-project.org/">sandwich</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">stats</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org">stringr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">tseries</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://sjmgarnier.github.io/viridis/">viridis</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/workflows">workflows</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gg_color_hue</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">hues</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">375</span>, length <span class="op">=</span> <span class="va">n</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/grDevices/hcl.html">hcl</a></span><span class="op">(</span>h <span class="op">=</span> <span class="va">hues</span>, l <span class="op">=</span> <span class="fl">65</span>, c <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">]</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lm_fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">model</span>, <span class="va">fix_all_but</span> <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">data</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkClass.html">assert_class</a></span><span class="op">(</span><span class="va">model</span>, <span class="st">"lm"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkNumber.html">assert_number</a></span><span class="op">(</span></span>
<span>    <span class="va">fix_all_but</span>, </span>
<span>    lower <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>, </span>
<span>    null.ok <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">coef</span> <span class="op">&lt;-</span> <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span>  <span class="va">vars</span> <span class="op">&lt;-</span> <span class="va">letters</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">coef</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="va">fixed_vars</span> <span class="op">&lt;-</span> <span class="va">vars</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">fix_all_but</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkDataFrame.html">assert_data_frame</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span>    <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkSubset.html">assert_subset</a></span><span class="op">(</span><span class="va">coef</span><span class="op">$</span><span class="va">term</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">fixed_vars</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="va">fix_all_but</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">fixed_vars</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">data</span><span class="op">[[</span><span class="va">coef</span><span class="op">$</span><span class="va">term</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="va">vars</span> <span class="op">&lt;-</span> <span class="va">vars</span><span class="op">[</span><span class="va">fix_all_but</span><span class="op">]</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="va">fun_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/parse.html">str2expression</a></span><span class="op">(</span></span>
<span>      <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span></span>
<span>        <span class="st">"function({paste0(vars, collapse = ', ')}) {{"</span>, <span class="st">"\n"</span>,</span>
<span>        <span class="st">"  {paste0('checkmate::assert_numeric(', vars, ')', collapse = '\n')}"</span>,</span>
<span>        <span class="st">"\n\n"</span>,</span>
<span>        <span class="st">"  {coef$estimate[1]} +"</span>,</span>
<span>        <span class="st">"{paste0(coef$estimate[-1], ' * ', fixed_vars, collapse = ' + ')}"</span>,</span>
<span>        <span class="st">"\n"</span>,</span>
<span>        <span class="st">"}}"</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/eval.html">eval</a></span><span class="op">(</span><span class="va">fun_exp</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">out</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lm_str_fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span></span>
<span>    <span class="va">model</span>, </span>
<span>    <span class="va">digits</span> <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    <span class="va">latex2exp</span> <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    <span class="va">fix_all_but</span> <span class="op">=</span> <span class="cn">NULL</span>, <span class="co"># Ignore the intercept coefficient.</span></span>
<span>    <span class="va">fix_fun</span> <span class="op">=</span> <span class="st">"Mean"</span>,</span>
<span>    <span class="va">coef_names</span> <span class="op">=</span> <span class="cn">NULL</span> <span class="co"># Ignore the intercept coefficient.</span></span>
<span>  <span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkClass.html">assert_class</a></span><span class="op">(</span><span class="va">model</span>, <span class="st">"lm"</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkNumber.html">assert_number</a></span><span class="op">(</span><span class="va">digits</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkFlag.html">assert_flag</a></span><span class="op">(</span><span class="va">latex2exp</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkNumber.html">assert_number</a></span><span class="op">(</span></span>
<span>    <span class="va">fix_all_but</span>, </span>
<span>    lower <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>, </span>
<span>    null.ok <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkString.html">assert_string</a></span><span class="op">(</span><span class="va">fix_fun</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkCharacter.html">assert_character</a></span><span class="op">(</span></span>
<span>    <span class="va">coef_names</span>, </span>
<span>    any.missing <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>    len <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>,</span>
<span>    null.ok <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">coef_names</span><span class="op">)</span><span class="op">)</span> <span class="va">coef_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="va">coef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">coef_names</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">coef</span><span class="op">[[</span><span class="va">coef_names</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> </span>
<span>      <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html">extract</a></span><span class="op">(</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">rutils</span><span class="fu">:::</span><span class="fu">clear_names</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">digits</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="va">coef_names</span> <span class="op">&lt;-</span></span>
<span>    <span class="va">coef_names</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace_all</a></span><span class="op">(</span><span class="st">"\\_|\\."</span>, <span class="st">" "</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/case.html">str_to_title</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace</a></span><span class="op">(</span><span class="st">" "</span>, <span class="st">""</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">fix_all_but</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">coef_names</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="va">fix_all_but</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">coef_names</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">fix_fun</span>, <span class="st">"("</span>, <span class="va">coef_names</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="st">")"</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span></span>
<span>    <span class="st">"$"</span>, <span class="st">"y ="</span>, <span class="st">" "</span>, </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">digits</span><span class="op">)</span>, <span class="st">" + "</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">coef</span>, <span class="st">" \\times "</span>, <span class="va">coef_names</span>, collapse <span class="op">=</span> <span class="st">" + "</span><span class="op">)</span>,</span>
<span>    <span class="st">"$"</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="va">out</span> <span class="op">|&gt;</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace</a></span><span class="op">(</span><span class="st">"\\+ \\-"</span>, <span class="st">"\\- "</span><span class="op">)</span> </span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Logic.html">isTRUE</a></span><span class="op">(</span><span class="va">latex2exp</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">out</span> <span class="op">|&gt;</span><span class="fu">latex2exp</span><span class="fu">::</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">out</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">test_outlier</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span></span>
<span>    <span class="va">x</span>, </span>
<span>    <span class="va">method</span> <span class="op">=</span> <span class="st">"iqr"</span>, </span>
<span>    <span class="va">iqr_mult</span> <span class="op">=</span> <span class="fl">1.5</span>, </span>
<span>    <span class="va">sd_mult</span> <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkNumeric.html">assert_numeric</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkChoice.html">assert_choice</a></span><span class="op">(</span><span class="va">method</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"iqr"</span>, <span class="st">"sd"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkNumber.html">assert_number</a></span><span class="op">(</span><span class="va">iqr_mult</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkNumber.html">assert_number</a></span><span class="op">(</span><span class="va">sd_mult</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">method</span> <span class="op">==</span> <span class="st">"iqr"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">iqr</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/IQR.html">IQR</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="va">min</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">0.25</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">-</span> <span class="op">(</span><span class="va">iqr_mult</span> <span class="op">*</span> <span class="va">iqr</span><span class="op">)</span></span>
<span>    <span class="va">max</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">0.75</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">iqr_mult</span> <span class="op">*</span> <span class="va">iqr</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">method</span> <span class="op">==</span> <span class="st">"sd"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">min</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">-</span> <span class="op">(</span><span class="va">sd_mult</span> <span class="op">*</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">max</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">sd_mult</span> <span class="op">*</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span><span class="va">x</span> <span class="op">&gt;=</span> <span class="va">min</span> <span class="op">&amp;</span> <span class="va">x</span> <span class="op">&lt;=</span> <span class="va">max</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, missing <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">remove_outliers</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span></span>
<span>    <span class="va">x</span>, </span>
<span>    <span class="va">method</span> <span class="op">=</span> <span class="st">"iqr"</span>, </span>
<span>    <span class="va">iqr_mult</span> <span class="op">=</span> <span class="fl">1.5</span>, </span>
<span>    <span class="va">sd_mult</span> <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkNumeric.html">assert_numeric</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkChoice.html">assert_choice</a></span><span class="op">(</span><span class="va">method</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"iqr"</span>, <span class="st">"sd"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkNumber.html">assert_number</a></span><span class="op">(</span><span class="va">iqr_mult</span>, lower <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkNumber.html">assert_number</a></span><span class="op">(</span><span class="va">sd_mult</span>, lower <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">x</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">test_outlier</span><span class="op">(</span></span>
<span>      method <span class="op">=</span> <span class="va">method</span>, </span>
<span>      iqr_mult <span class="op">=</span> <span class="va">iqr_mult</span>, </span>
<span>      sd_mult <span class="op">=</span> <span class="va">sd_mult</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">`!`</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html">extract</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">.</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">list_as_tibble</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">list</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkList.html">assert_list</a></span><span class="op">(</span><span class="va">list</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">list</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>      <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span></span>
<span>        .cols <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        .fns <span class="op">=</span> <span class="va">as.character</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">stats_sum</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span></span>
<span>    <span class="va">x</span>,</span>
<span>    <span class="va">name</span> <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    <span class="va">na_rm</span> <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    <span class="va">remove_outliers</span> <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    <span class="va">iqr_mult</span> <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>    <span class="va">as_list</span> <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkNumeric.html">assert_numeric</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkString.html">assert_string</a></span><span class="op">(</span><span class="va">name</span>, null.ok <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkFlag.html">assert_flag</a></span><span class="op">(</span><span class="va">na_rm</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkFlag.html">assert_flag</a></span><span class="op">(</span><span class="va">remove_outliers</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkNumber.html">assert_number</a></span><span class="op">(</span><span class="va">iqr_mult</span>, lower <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkFlag.html">assert_flag</a></span><span class="op">(</span><span class="va">as_list</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Logic.html">isTRUE</a></span><span class="op">(</span><span class="va">remove_outliers</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">|&gt;</span> <span class="fu">remove_outliers</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"iqr"</span>, iqr_mult <span class="op">=</span> <span class="va">iqr_mult</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>    n_rm_na <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    n_na <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="va">na_rm</span><span class="op">)</span>,</span>
<span>    var <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="va">na_rm</span><span class="op">)</span>,</span>
<span>    sd <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="va">na_rm</span><span class="op">)</span>,</span>
<span>    min <span class="op">=</span> <span class="fu">rutils</span><span class="fu">:::</span><span class="fu">clear_names</span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">0</span>, na.rm <span class="op">=</span> <span class="va">na_rm</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    q_1 <span class="op">=</span> <span class="fu">rutils</span><span class="fu">:::</span><span class="fu">clear_names</span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">0.25</span>, na.rm <span class="op">=</span> <span class="va">na_rm</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    median <span class="op">=</span> <span class="fu">rutils</span><span class="fu">:::</span><span class="fu">clear_names</span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">0.5</span>, na.rm <span class="op">=</span> <span class="va">na_rm</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    q_3 <span class="op">=</span> <span class="fu">rutils</span><span class="fu">:::</span><span class="fu">clear_names</span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">0.75</span>, na.rm <span class="op">=</span> <span class="va">na_rm</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    max <span class="op">=</span> <span class="fu">rutils</span><span class="fu">:::</span><span class="fu">clear_names</span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">1</span>, na.rm <span class="op">=</span> <span class="va">na_rm</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    iqr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/IQR.html">IQR</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="va">na_rm</span><span class="op">)</span>,</span>
<span>    skewness <span class="op">=</span> <span class="fu">moments</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/moments/man/skewness.html">skewness</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="va">na_rm</span><span class="op">)</span>,</span>
<span>    kurtosis <span class="op">=</span> <span class="fu">moments</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/moments/man/kurtosis.html">kurtosis</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="va">na_rm</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html">append</a></span><span class="op">(</span><span class="va">out</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>name <span class="op">=</span> <span class="va">name</span><span class="op">)</span>, after <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Logic.html">isTRUE</a></span><span class="op">(</span><span class="va">as_list</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">out</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">out</span> <span class="op">|&gt;</span> <span class="fu">list_as_tibble</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot_qq</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span></span>
<span>    <span class="va">x</span>,</span>
<span>    <span class="va">text_size</span> <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    <span class="va">na_rm</span> <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    <span class="va">print</span> <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkNumeric.html">assert_numeric</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkNumber.html">assert_number</a></span><span class="op">(</span><span class="va">text_size</span>, null.ok <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkFlag.html">assert_flag</a></span><span class="op">(</span><span class="va">na_rm</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkFlag.html">assert_flag</a></span><span class="op">(</span><span class="va">print</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Logic.html">isTRUE</a></span><span class="op">(</span><span class="va">na_rm</span><span class="op">)</span><span class="op">)</span> <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">|&gt;</span> <span class="fu">rutils</span><span class="fu">:::</span><span class="fu">drop_na</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">plot</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">x</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html">stat_qq</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html">stat_qq_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="st">"Theoretical quantiles (Std. normal)"</span>,</span>
<span>      y <span class="op">=</span> <span class="st">"Sample quantiles"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>text <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="va">text_size</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Logic.html">isTRUE</a></span><span class="op">(</span><span class="va">print</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">plot</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span><span class="op">(</span><span class="va">plot</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot_hist</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span></span>
<span>    <span class="va">x</span>,</span>
<span>    <span class="va">name</span> <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>    <span class="va">bins</span> <span class="op">=</span> <span class="fl">30</span>,</span>
<span>    <span class="va">stat</span> <span class="op">=</span> <span class="st">"density"</span>,</span>
<span>    <span class="va">text_size</span> <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    <span class="va">density_line</span> <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    <span class="va">na_rm</span> <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    <span class="va">print</span> <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkNumeric.html">assert_numeric</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkString.html">assert_string</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkNumber.html">assert_number</a></span><span class="op">(</span><span class="va">bins</span>, lower <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkChoice.html">assert_choice</a></span><span class="op">(</span><span class="va">stat</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"count"</span>, <span class="st">"density"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkNumber.html">assert_number</a></span><span class="op">(</span><span class="va">text_size</span>, null.ok <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkFlag.html">assert_flag</a></span><span class="op">(</span><span class="va">density_line</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkFlag.html">assert_flag</a></span><span class="op">(</span><span class="va">na_rm</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkFlag.html">assert_flag</a></span><span class="op">(</span><span class="va">print</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Logic.html">isTRUE</a></span><span class="op">(</span><span class="va">na_rm</span><span class="op">)</span><span class="op">)</span> <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">|&gt;</span> <span class="fu">rutils</span><span class="fu">:::</span><span class="fu">drop_na</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">y_lab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">stat</span> <span class="op">==</span> <span class="st">"count"</span>, <span class="st">"Frequency"</span>, <span class="st">"Density"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">plot</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">x</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span></span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">after_stat</a></span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/name.html">as.symbol</a></span><span class="op">(</span><span class="va">stat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      bins <span class="op">=</span> <span class="fl">30</span>, </span>
<span>      color <span class="op">=</span> <span class="st">"white"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">name</span>, y <span class="op">=</span> <span class="va">y_lab</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>text <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="va">text_size</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">stat</span> <span class="op">==</span> <span class="st">"density"</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/Logic.html">isTRUE</a></span><span class="op">(</span><span class="va">density_line</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">plot</span> <span class="op">&lt;-</span> <span class="va">plot</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Logic.html">isTRUE</a></span><span class="op">(</span><span class="va">print</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">plot</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span><span class="op">(</span><span class="va">plot</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot_ggally</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span></span>
<span>    <span class="va">data</span>,</span>
<span>    <span class="va">cols</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>,</span>
<span>    <span class="va">mapping</span> <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    <span class="va">axis_labels</span> <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>    <span class="va">na_rm</span> <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    <span class="va">text_size</span> <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkTibble.html">assert_tibble</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkCharacter.html">assert_character</a></span><span class="op">(</span><span class="va">cols</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkSubset.html">assert_subset</a></span><span class="op">(</span><span class="va">cols</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkClass.html">assert_class</a></span><span class="op">(</span><span class="va">mapping</span>, <span class="st">"uneval"</span>, null.ok <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkChoice.html">assert_choice</a></span><span class="op">(</span><span class="va">axis_labels</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"show"</span>, <span class="st">"internal"</span>, <span class="st">"none"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkFlag.html">assert_flag</a></span><span class="op">(</span><span class="va">na_rm</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkNumber.html">assert_number</a></span><span class="op">(</span><span class="va">text_size</span>, null.ok <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span></span>
<span>    <span class="va">data</span><span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html">all_of</a></span><span class="op">(</span><span class="va">cols</span><span class="op">)</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>      <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span></span>
<span>      .cols <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html">where</a></span><span class="op">(</span><span class="fu">hms</span><span class="fu">::</span><span class="va"><a href="https://hms.tidyverse.org/reference/hms.html">is_hms</a></span><span class="op">)</span>,</span>
<span>      .fns <span class="op">=</span> <span class="op">~</span> <span class="fu">midday_trigger</span><span class="op">(</span><span class="va">.x</span><span class="op">)</span></span>
<span>      <span class="op">)</span>,</span>
<span>      <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span></span>
<span>        .cols <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html">where</a></span><span class="op">(</span></span>
<span>          <span class="op">~</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">is.character</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">is.factor</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">is.numeric</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span></span>
<span>        <span class="op">)</span>,</span>
<span>        .fns <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Logic.html">isTRUE</a></span><span class="op">(</span><span class="va">na_rm</span><span class="op">)</span><span class="op">)</span> <span class="va">out</span> <span class="op">&lt;-</span> <span class="va">out</span><span class="op">|&gt;</span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html">all_of</a></span><span class="op">(</span><span class="va">cols</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">mapping</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">plot</span> <span class="op">&lt;-</span></span>
<span>      <span class="va">out</span><span class="op">|&gt;</span></span>
<span>      <span class="fu">GGally</span><span class="fu">::</span><span class="fu"><a href="https://ggobi.github.io/ggally/reference/ggpairs.html">ggpairs</a></span><span class="op">(</span></span>
<span>        lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>continuous <span class="op">=</span> <span class="st">"smooth"</span><span class="op">)</span>,</span>
<span>        axisLabels <span class="op">=</span> <span class="va">axis_labels</span></span>
<span>      <span class="op">)</span> </span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">plot</span> <span class="op">&lt;-</span></span>
<span>      <span class="va">out</span><span class="op">|&gt;</span></span>
<span>      <span class="fu">GGally</span><span class="fu">::</span><span class="fu"><a href="https://ggobi.github.io/ggally/reference/ggpairs.html">ggpairs</a></span><span class="op">(</span></span>
<span>        mapping <span class="op">=</span> <span class="va">mapping</span>,</span>
<span>        axisLabels <span class="op">=</span> <span class="va">axis_labels</span></span>
<span>      <span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu">viridis</span><span class="fu">::</span><span class="fu"><a href="https://sjmgarnier.github.io/viridis/reference/scale_viridis.html">scale_color_viridis</a></span><span class="op">(</span></span>
<span>        begin <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>        end <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>        discrete <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        option <span class="op">=</span> <span class="st">"viridis"</span></span>
<span>      <span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu">viridis</span><span class="fu">::</span><span class="fu"><a href="https://sjmgarnier.github.io/viridis/reference/scale_viridis.html">scale_fill_viridis</a></span><span class="op">(</span></span>
<span>        begin <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>        end <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>        discrete <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        option <span class="op">=</span> <span class="st">"viridis"</span></span>
<span>      <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">plot</span> <span class="op">&lt;-</span> </span>
<span>    <span class="va">plot</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>text <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="va">text_size</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">plot</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span><span class="op">(</span><span class="va">plot</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">test_normality</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,</span>
<span>                           <span class="va">name</span> <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>                           <span class="va">remove_outliers</span> <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                           <span class="va">iqr_mult</span> <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>                           <span class="va">log_transform</span> <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                           <span class="va">density_line</span> <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                           <span class="va">text_size</span> <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                           <span class="va">print</span> <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkNumeric.html">assert_numeric</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkString.html">assert_string</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkFlag.html">assert_flag</a></span><span class="op">(</span><span class="va">remove_outliers</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkNumber.html">assert_number</a></span><span class="op">(</span><span class="va">iqr_mult</span>, lower <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkFlag.html">assert_flag</a></span><span class="op">(</span><span class="va">log_transform</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkFlag.html">assert_flag</a></span><span class="op">(</span><span class="va">density_line</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkNumber.html">assert_number</a></span><span class="op">(</span><span class="va">text_size</span>, null.ok <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkFlag.html">assert_flag</a></span><span class="op">(</span><span class="va">print</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">n_rm_na</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">|&gt;</span> <span class="fu">rutils</span><span class="fu">:::</span><span class="fu">drop_na</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Logic.html">isTRUE</a></span><span class="op">(</span><span class="va">remove_outliers</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">|&gt;</span> <span class="fu">remove_outliers</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"iqr"</span>, iqr_mult <span class="op">=</span> <span class="va">iqr_mult</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Logic.html">isTRUE</a></span><span class="op">(</span><span class="va">log_transform</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">x</span> <span class="op">&lt;-</span></span>
<span>      <span class="va">x</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">drop_inf</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">n_rm_na</span> <span class="op">&gt;=</span> <span class="fl">7</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">ad</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">|&gt;</span> <span class="fu">nortest</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nortest/man/ad.test.html">ad.test</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">cvm</span> <span class="op">&lt;-</span></span>
<span>      <span class="va">x</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">nortest</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nortest/man/cvm.test.html">cvm.test</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">rutils</span><span class="fu">:::</span><span class="fu">shush</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">ad</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>    <span class="va">cmv</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">bonett</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">|&gt;</span> <span class="fu">moments</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/moments/man/bonett.test.html">bonett.test</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># See also `Rita::DPTest()` (just for Omnibus (K) tests).</span></span>
<span>  <span class="va">dagostino</span> <span class="op">&lt;-</span></span>
<span>    <span class="va">x</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">fBasics</span><span class="fu">::</span><span class="fu"><a href="https://geobosh.github.io/fBasicsDoc/reference/test-normalityTests.html">dagoTest</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">rutils</span><span class="fu">:::</span><span class="fu">shush</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">jarque_bera</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu">rutils</span><span class="fu">:::</span><span class="fu">drop_na</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">tseries</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tseries/man/jarque.bera.test.html">jarque.bera.test</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">n_rm_na</span> <span class="op">&gt;=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">lillie_ks</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">|&gt;</span> <span class="fu">nortest</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nortest/man/lillie.test.html">lillie.test</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">lillie_ks</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">pearson</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">|&gt;</span> <span class="fu">nortest</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nortest/man/pearson.test.html">pearson.test</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">n_rm_na</span> <span class="op">&gt;=</span> <span class="fl">5</span> <span class="op">&amp;&amp;</span> <span class="va">n_rm_na</span> <span class="op">&lt;=</span> <span class="fl">5000</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">sf</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">|&gt;</span> <span class="fu">nortest</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nortest/man/sf.test.html">sf.test</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">sf</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">n_rm_na</span> <span class="op">&gt;=</span> <span class="fl">3</span> <span class="op">&amp;&amp;</span> <span class="va">n_rm_na</span> <span class="op">&lt;=</span> <span class="fl">3000</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">shapiro</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">|&gt;</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">shapiro</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">qq_plot</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">|&gt;</span> <span class="fu">plot_qq</span><span class="op">(</span>text_size <span class="op">=</span> <span class="va">text_size</span>, print <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">hist_plot</span> <span class="op">&lt;-</span></span>
<span>    <span class="va">x</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">plot_hist</span><span class="op">(</span></span>
<span>      name <span class="op">=</span> <span class="va">name</span>,</span>
<span>      text_size <span class="op">=</span> <span class="va">text_size</span>,</span>
<span>      density_line <span class="op">=</span> <span class="va">density_line</span>,</span>
<span>      print <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>      <span class="op">)</span></span>
<span></span>
<span>  <span class="va">grid_plot</span> <span class="op">&lt;-</span> <span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span><span class="va">hist_plot</span>, <span class="va">qq_plot</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    stats <span class="op">=</span> <span class="fu">stats_sum</span><span class="op">(</span></span>
<span>      <span class="va">x</span>,</span>
<span>      name <span class="op">=</span> <span class="va">name</span>,</span>
<span>      na_rm <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>      remove_outliers <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>      as_list <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span>,</span>
<span>    params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>      name <span class="op">=</span> <span class="va">name</span>,</span>
<span>      remove_outliers <span class="op">=</span> <span class="va">remove_outliers</span>,</span>
<span>      log_transform <span class="op">=</span> <span class="va">log_transform</span>,</span>
<span>      density_line <span class="op">=</span> <span class="va">density_line</span></span>
<span>    <span class="op">)</span>,</span>
<span></span>
<span>    ad <span class="op">=</span> <span class="va">ad</span>,</span>
<span>    bonett <span class="op">=</span> <span class="va">bonett</span>,</span>
<span>    cvm <span class="op">=</span> <span class="va">cvm</span>,</span>
<span>    dagostino <span class="op">=</span> <span class="va">dagostino</span>,</span>
<span>    jarque_bera <span class="op">=</span> <span class="va">jarque_bera</span>,</span>
<span>    lillie_ks <span class="op">=</span> <span class="va">lillie_ks</span>,</span>
<span>    pearson <span class="op">=</span> <span class="va">pearson</span>,</span>
<span>    sf <span class="op">=</span> <span class="va">sf</span>,</span>
<span>    shapiro <span class="op">=</span> <span class="va">shapiro</span>,</span>
<span></span>
<span>    hist_plot <span class="op">=</span> <span class="va">hist_plot</span>,</span>
<span>    qq_plot <span class="op">=</span> <span class="va">qq_plot</span>,</span>
<span>    grid_plot <span class="op">=</span> <span class="va">grid_plot</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Logic.html">isTRUE</a></span><span class="op">(</span><span class="va">print</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">grid_plot</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">normality_sum</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span></span>
<span>    <span class="va">x</span>, </span>
<span>    <span class="va">round</span> <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>    <span class="va">digits</span> <span class="op">=</span> <span class="fl">5</span>, </span>
<span>    <span class="va">only_p_value</span> <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>    <span class="va">...</span></span>
<span>  <span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkNumeric.html">assert_numeric</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkFlag.html">assert_flag</a></span><span class="op">(</span><span class="va">round</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkNumber.html">assert_number</a></span><span class="op">(</span><span class="va">digits</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkFlag.html">assert_flag</a></span><span class="op">(</span><span class="va">only_p_value</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">stats</span> <span class="op">&lt;-</span> <span class="fu">test_normality</span><span class="op">(</span><span class="va">x</span>, print <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>    test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"Anderson-Darling"</span>,</span>
<span>      <span class="st">"Bonett-Seier"</span>,</span>
<span>      <span class="st">"Cramér-von Mises"</span>,</span>
<span>      <span class="st">"D'Agostino Omnibus Test"</span>,</span>
<span>      <span class="st">"D'Agostino Skewness Test"</span>,</span>
<span>      <span class="st">"D'Agostino Kurtosis Test"</span>,</span>
<span>      <span class="st">"Jarque–Bera"</span>,</span>
<span>      <span class="st">"Lilliefors (K-S)"</span>,</span>
<span>      <span class="st">"Pearson chi-square"</span>,</span>
<span>      <span class="st">"Shapiro-Francia"</span>,</span>
<span>      <span class="st">"Shapiro-Wilk"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    statistic_1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="va">stats</span><span class="op">$</span><span class="va">ad</span><span class="op">$</span><span class="va">statistic</span>,</span>
<span>      <span class="va">stats</span><span class="op">$</span><span class="va">bonett</span><span class="op">$</span><span class="va">statistic</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>      <span class="va">stats</span><span class="op">$</span><span class="va">cvm</span><span class="op">$</span><span class="va">statistic</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">stats</span><span class="op">$</span><span class="va">dagostino</span>, <span class="st">"test"</span><span class="op">)</span><span class="op">$</span><span class="va">statistic</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">stats</span><span class="op">$</span><span class="va">dagostino</span>, <span class="st">"test"</span><span class="op">)</span><span class="op">$</span><span class="va">statistic</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">stats</span><span class="op">$</span><span class="va">dagostino</span>, <span class="st">"test"</span><span class="op">)</span><span class="op">$</span><span class="va">statistic</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>      <span class="va">stats</span><span class="op">$</span><span class="va">jarque_bera</span><span class="op">$</span><span class="va">statistic</span>,</span>
<span>      <span class="va">stats</span><span class="op">$</span><span class="va">lillie_ks</span><span class="op">$</span><span class="va">statistic</span>,</span>
<span>      <span class="va">stats</span><span class="op">$</span><span class="va">pearson</span><span class="op">$</span><span class="va">statistic</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">stats</span><span class="op">$</span><span class="va">shapiro</span><span class="op">)</span>, <span class="cn">NA</span>, <span class="va">stats</span><span class="op">$</span><span class="va">shapiro</span><span class="op">$</span><span class="va">statistic</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">stats</span><span class="op">$</span><span class="va">sf</span><span class="op">)</span>, <span class="cn">NA</span>, <span class="va">stats</span><span class="op">$</span><span class="va">sf</span><span class="op">$</span><span class="va">statistic</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    statistic_2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span>,</span>
<span>      <span class="va">stats</span><span class="op">$</span><span class="va">bonett</span><span class="op">$</span><span class="va">statistic</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span>,</span>
<span>      <span class="va">stats</span><span class="op">$</span><span class="va">jarque_bera</span><span class="op">$</span><span class="va">parameter</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    p_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="va">stats</span><span class="op">$</span><span class="va">ad</span><span class="op">$</span><span class="va">p.value</span>,</span>
<span>      <span class="va">stats</span><span class="op">$</span><span class="va">bonett</span><span class="op">$</span><span class="va">p.value</span>,</span>
<span>      <span class="va">stats</span><span class="op">$</span><span class="va">cvm</span><span class="op">$</span><span class="va">p.value</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">stats</span><span class="op">$</span><span class="va">dagostino</span>, <span class="st">"test"</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">stats</span><span class="op">$</span><span class="va">dagostino</span>, <span class="st">"test"</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">stats</span><span class="op">$</span><span class="va">dagostino</span>, <span class="st">"test"</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>      <span class="va">stats</span><span class="op">$</span><span class="va">jarque_bera</span><span class="op">$</span><span class="va">p.value</span>,</span>
<span>      <span class="va">stats</span><span class="op">$</span><span class="va">lillie_ks</span><span class="op">$</span><span class="va">p.value</span>,</span>
<span>      <span class="va">stats</span><span class="op">$</span><span class="va">pearson</span><span class="op">$</span><span class="va">p.value</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">stats</span><span class="op">$</span><span class="va">shapiro</span><span class="op">)</span>, <span class="cn">NA</span>, <span class="va">stats</span><span class="op">$</span><span class="va">shapiro</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">stats</span><span class="op">$</span><span class="va">sf</span><span class="op">)</span>, <span class="cn">NA</span>, <span class="va">stats</span><span class="op">$</span><span class="va">sf</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Logic.html">isTRUE</a></span><span class="op">(</span><span class="va">only_p_value</span><span class="op">)</span><span class="op">)</span> <span class="va">out</span> <span class="op">&lt;-</span> <span class="va">out</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">test</span>, <span class="va">p_value</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Logic.html">isTRUE</a></span><span class="op">(</span><span class="va">round</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">out</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span></span>
<span>          .cols <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html">where</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>,</span>
<span>          .fns <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">.x</span>, <span class="va">digits</span><span class="op">)</span></span>
<span>        <span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">out</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="preparing-the-data" class="level2"><h2 class="anchored" data-anchor-id="preparing-the-data">Preparing the data</h2>
<p><strong>Assumption 1</strong> is satisfied, as the predictors are known.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">palmerpenguins</span><span class="fu">::</span><span class="va"><a href="https://allisonhorst.github.io/palmerpenguins/reference/penguins.html">penguins</a></span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">species</span> <span class="op">==</span> <span class="st">"Adelie"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">bill_length_mm</span>, <span class="va">bill_depth_mm</span>, <span class="va">flipper_length_mm</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-data-prep-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-data-prep-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Data frame with morphological measurements of penguin species from the <a href="https://en.wikipedia.org/wiki/Palmer_Archipelago">Palmer Archipelago</a>.
</figcaption><div aria-describedby="tbl-data-prep-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["bill_length_mm"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["bill_depth_mm"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["flipper_length_mm"],"name":[3],"type":["int"],"align":["right"]}],"data":[{"1":"39.1","2":"18.7","3":"181"},{"1":"39.5","2":"17.4","3":"186"},{"1":"40.3","2":"18.0","3":"195"},{"1":"36.7","2":"19.3","3":"193"},{"1":"39.3","2":"20.6","3":"190"},{"1":"38.9","2":"17.8","3":"181"},{"1":"39.2","2":"19.6","3":"195"},{"1":"34.1","2":"18.1","3":"193"},{"1":"42.0","2":"20.2","3":"190"},{"1":"37.8","2":"17.1","3":"186"},{"1":"37.8","2":"17.3","3":"180"},{"1":"41.1","2":"17.6","3":"182"},{"1":"38.6","2":"21.2","3":"191"},{"1":"34.6","2":"21.1","3":"198"},{"1":"36.6","2":"17.8","3":"185"},{"1":"38.7","2":"19.0","3":"195"},{"1":"42.5","2":"20.7","3":"197"},{"1":"34.4","2":"18.4","3":"184"},{"1":"46.0","2":"21.5","3":"194"},{"1":"37.8","2":"18.3","3":"174"},{"1":"37.7","2":"18.7","3":"180"},{"1":"35.9","2":"19.2","3":"189"},{"1":"38.2","2":"18.1","3":"185"},{"1":"38.8","2":"17.2","3":"180"},{"1":"35.3","2":"18.9","3":"187"},{"1":"40.6","2":"18.6","3":"183"},{"1":"40.5","2":"17.9","3":"187"},{"1":"37.9","2":"18.6","3":"172"},{"1":"40.5","2":"18.9","3":"180"},{"1":"39.5","2":"16.7","3":"178"},{"1":"37.2","2":"18.1","3":"178"},{"1":"39.5","2":"17.8","3":"188"},{"1":"40.9","2":"18.9","3":"184"},{"1":"36.4","2":"17.0","3":"195"},{"1":"39.2","2":"21.1","3":"196"},{"1":"38.8","2":"20.0","3":"190"},{"1":"42.2","2":"18.5","3":"180"},{"1":"37.6","2":"19.3","3":"181"},{"1":"39.8","2":"19.1","3":"184"},{"1":"36.5","2":"18.0","3":"182"},{"1":"40.8","2":"18.4","3":"195"},{"1":"36.0","2":"18.5","3":"186"},{"1":"44.1","2":"19.7","3":"196"},{"1":"37.0","2":"16.9","3":"185"},{"1":"39.6","2":"18.8","3":"190"},{"1":"41.1","2":"19.0","3":"182"},{"1":"37.5","2":"18.9","3":"179"},{"1":"36.0","2":"17.9","3":"190"},{"1":"42.3","2":"21.2","3":"191"},{"1":"39.6","2":"17.7","3":"186"},{"1":"40.1","2":"18.9","3":"188"},{"1":"35.0","2":"17.9","3":"190"},{"1":"42.0","2":"19.5","3":"200"},{"1":"34.5","2":"18.1","3":"187"},{"1":"41.4","2":"18.6","3":"191"},{"1":"39.0","2":"17.5","3":"186"},{"1":"40.6","2":"18.8","3":"193"},{"1":"36.5","2":"16.6","3":"181"},{"1":"37.6","2":"19.1","3":"194"},{"1":"35.7","2":"16.9","3":"185"},{"1":"41.3","2":"21.1","3":"195"},{"1":"37.6","2":"17.0","3":"185"},{"1":"41.1","2":"18.2","3":"192"},{"1":"36.4","2":"17.1","3":"184"},{"1":"41.6","2":"18.0","3":"192"},{"1":"35.5","2":"16.2","3":"195"},{"1":"41.1","2":"19.1","3":"188"},{"1":"35.9","2":"16.6","3":"190"},{"1":"41.8","2":"19.4","3":"198"},{"1":"33.5","2":"19.0","3":"190"},{"1":"39.7","2":"18.4","3":"190"},{"1":"39.6","2":"17.2","3":"196"},{"1":"45.8","2":"18.9","3":"197"},{"1":"35.5","2":"17.5","3":"190"},{"1":"42.8","2":"18.5","3":"195"},{"1":"40.9","2":"16.8","3":"191"},{"1":"37.2","2":"19.4","3":"184"},{"1":"36.2","2":"16.1","3":"187"},{"1":"42.1","2":"19.1","3":"195"},{"1":"34.6","2":"17.2","3":"189"},{"1":"42.9","2":"17.6","3":"196"},{"1":"36.7","2":"18.8","3":"187"},{"1":"35.1","2":"19.4","3":"193"},{"1":"37.3","2":"17.8","3":"191"},{"1":"41.3","2":"20.3","3":"194"},{"1":"36.3","2":"19.5","3":"190"},{"1":"36.9","2":"18.6","3":"189"},{"1":"38.3","2":"19.2","3":"189"},{"1":"38.9","2":"18.8","3":"190"},{"1":"35.7","2":"18.0","3":"202"},{"1":"41.1","2":"18.1","3":"205"},{"1":"34.0","2":"17.1","3":"185"},{"1":"39.6","2":"18.1","3":"186"},{"1":"36.2","2":"17.3","3":"187"},{"1":"40.8","2":"18.9","3":"208"},{"1":"38.1","2":"18.6","3":"190"},{"1":"40.3","2":"18.5","3":"196"},{"1":"33.1","2":"16.1","3":"178"},{"1":"43.2","2":"18.5","3":"192"},{"1":"35.0","2":"17.9","3":"192"},{"1":"41.0","2":"20.0","3":"203"},{"1":"37.7","2":"16.0","3":"183"},{"1":"37.8","2":"20.0","3":"190"},{"1":"37.9","2":"18.6","3":"193"},{"1":"39.7","2":"18.9","3":"184"},{"1":"38.6","2":"17.2","3":"199"},{"1":"38.2","2":"20.0","3":"190"},{"1":"38.1","2":"17.0","3":"181"},{"1":"43.2","2":"19.0","3":"197"},{"1":"38.1","2":"16.5","3":"198"},{"1":"45.6","2":"20.3","3":"191"},{"1":"39.7","2":"17.7","3":"193"},{"1":"42.2","2":"19.5","3":"197"},{"1":"39.6","2":"20.7","3":"191"},{"1":"42.7","2":"18.3","3":"196"},{"1":"38.6","2":"17.0","3":"188"},{"1":"37.3","2":"20.5","3":"199"},{"1":"35.7","2":"17.0","3":"189"},{"1":"41.1","2":"18.6","3":"189"},{"1":"36.2","2":"17.2","3":"187"},{"1":"37.7","2":"19.8","3":"198"},{"1":"40.2","2":"17.0","3":"176"},{"1":"41.4","2":"18.5","3":"202"},{"1":"35.2","2":"15.9","3":"186"},{"1":"40.6","2":"19.0","3":"199"},{"1":"38.8","2":"17.6","3":"191"},{"1":"41.5","2":"18.3","3":"195"},{"1":"39.0","2":"17.1","3":"191"},{"1":"44.1","2":"18.0","3":"210"},{"1":"38.5","2":"17.9","3":"190"},{"1":"43.1","2":"19.2","3":"197"},{"1":"36.8","2":"18.5","3":"193"},{"1":"37.5","2":"18.5","3":"199"},{"1":"38.1","2":"17.6","3":"187"},{"1":"41.1","2":"17.5","3":"190"},{"1":"35.6","2":"17.5","3":"191"},{"1":"40.2","2":"20.1","3":"200"},{"1":"37.0","2":"16.5","3":"185"},{"1":"39.7","2":"17.9","3":"193"},{"1":"40.2","2":"17.1","3":"193"},{"1":"40.6","2":"17.2","3":"187"},{"1":"32.1","2":"15.5","3":"188"},{"1":"40.7","2":"17.0","3":"190"},{"1":"37.3","2":"16.8","3":"192"},{"1":"39.0","2":"18.7","3":"185"},{"1":"39.2","2":"18.6","3":"190"},{"1":"36.6","2":"18.4","3":"184"},{"1":"36.0","2":"17.8","3":"195"},{"1":"37.8","2":"18.1","3":"193"},{"1":"36.0","2":"17.1","3":"187"},{"1":"41.5","2":"18.5","3":"201"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</figure>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">report</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/report/reference/report.html">report</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; The data contains 151 observations of the following 3 variables:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   - bill_length_mm: n = 151, Mean = 38.79, SD = 2.66, Median = 38.80, MAD =</span></span>
<span><span class="co">#&gt; 2.97, range: [32.10, 46], Skewness = 0.16, Kurtosis = -0.16, 0% missing</span></span>
<span><span class="co">#&gt;   - bill_depth_mm: n = 151, Mean = 18.35, SD = 1.22, Median = 18.40, MAD =</span></span>
<span><span class="co">#&gt; 1.19, range: [15.50, 21.50], Skewness = 0.32, Kurtosis = -0.06, 0% missing</span></span>
<span><span class="co">#&gt;   - flipper_length_mm: n = 151, Mean = 189.95, SD = 6.54, Median = 190.00, MAD</span></span>
<span><span class="co">#&gt; = 7.41, range: [172, 210], Skewness = 0.09, Kurtosis = 0.33, 0% missing</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="performing-the-power-analysis" class="level2"><h2 class="anchored" data-anchor-id="performing-the-power-analysis">Performing the power analysis</h2>
<p>First we will perform a <em>a posteriori</em> power analysis to determine the sample size needed to achieve a power (<span class="math inline">\(1 - \beta\)</span>) of 0.8, given an <span class="math inline">\(R^2\)</span> of 0.5, a significance level (<span class="math inline">\(\alpha\)</span>) of 0.05, and 2 predictors. It’s a <em>a posterior</em> analysis because we already have the data in hand. It’s a good practice to perform a power analysis before running the model to ensure that the sample size is adequate.</p>
<p>The results show that we need at least 14 observations to achieve the desired power. We have 151 observations, which is more than enough.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pre_pwr</span> <span class="op">&lt;-</span> <span class="fu">pwrss</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pwrss/man/4-Linear-Regression-Rsquared.html">pwrss.f.reg</a></span><span class="op">(</span></span>
<span>  r2 <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>  k <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  power <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;  Linear Regression (F test) </span></span>
<span><span class="co">#&gt;  R-squared Deviation from 0 (zero) </span></span>
<span><span class="co">#&gt;  H0: r2 = 0 </span></span>
<span><span class="co">#&gt;  HA: r2 &gt; 0 </span></span>
<span><span class="co">#&gt;  ------------------------------ </span></span>
<span><span class="co">#&gt;   Statistical power = 0.8 </span></span>
<span><span class="co">#&gt;   n = 14 </span></span>
<span><span class="co">#&gt;  ------------------------------ </span></span>
<span><span class="co">#&gt;  Numerator degrees of freedom = 2 </span></span>
<span><span class="co">#&gt;  Denominator degrees of freedom = 10.144 </span></span>
<span><span class="co">#&gt;  Non-centrality parameter = 13.144 </span></span>
<span><span class="co">#&gt;  Type I error rate = 0.05 </span></span>
<span><span class="co">#&gt;  Type II error rate = 0.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">pwrss</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pwrss/man/0-Generic-F-Test.html">power.f.test</a></span><span class="op">(</span></span>
<span>  ncp <span class="op">=</span> <span class="va">pre_pwr</span><span class="op">$</span><span class="va">ncp</span>,</span>
<span>  df1 <span class="op">=</span> <span class="va">pre_pwr</span><span class="op">$</span><span class="va">df1</span>,</span>
<span>  df2 <span class="op">=</span> <span class="va">pre_pwr</span><span class="op">$</span><span class="va">df2</span>,</span>
<span>  alpha <span class="op">=</span> <span class="va">pre_pwr</span><span class="op">$</span><span class="va">parms</span><span class="op">$</span><span class="va">alpha</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt;  power ncp.alt ncp.null alpha df1      df2   f.crit
#&gt;    0.8  13.144        0  0.05   2 10.14432 4.083657</code></pre>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="va">pre_pwr</span><span class="op">$</span><span class="va">n</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="checking-distributions" class="level2"><h2 class="anchored" data-anchor-id="checking-distributions">Checking distributions</h2>
<p>The data show fairly normal distributions. It seems that the <code>bill_length_mm</code> and <code>bill_depth_mm</code> variables appear slightly skewed, while the <code>flipper_length_mm</code> variable is more symmetric.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Bill length (mm)</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Bill depth (mm)</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Flipper length (mm)</a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">bill_length_mm</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">stats_sum</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Bill length (mm)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-var-dist-stats-sum-bill_length_mm" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-var-dist-stats-sum-bill_length_mm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Statistics for the <code>bill_length_mm</code> variable.
</figcaption><div aria-describedby="tbl-var-dist-stats-sum-bill_length_mm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["value"],"name":[2],"type":["chr"],"align":["left"]}],"data":[{"1":"name","2":"Bill length (mm)"},{"1":"n","2":"151"},{"1":"n_rm_na","2":"151"},{"1":"n_na","2":"0"},{"1":"mean","2":"38.7913907284768"},{"1":"var","2":"7.09372538631347"},{"1":"sd","2":"2.66340484836862"},{"1":"min","2":"32.1"},{"1":"q_1","2":"36.75"},{"1":"median","2":"38.8"},{"1":"q_3","2":"40.75"},{"1":"max","2":"46"},{"1":"iqr","2":"4"},{"1":"skewness","2":"0.160063820705113"},{"1":"kurtosis","2":"2.80848010899949"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</figure>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">bill_length_mm</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">test_normality</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Bill length (mm)"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Registered S3 method overwritten by 'quantmod':</span></span>
<span><span class="co">#&gt;   method            from</span></span>
<span><span class="co">#&gt;   as.zoo.data.frame zoo</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-var-dist-hist-bill_length_mm" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-var-dist-hist-bill_length_mm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-var-dist-hist-bill_length_mm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Histogram of the <code>bill_length_mm</code> variable with a kernel density estimate, along with a quantile-quantile (Q-Q) plot between the variable and the theoretical quantiles of the normal distribution.
</figcaption></figure>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">bill_depth_mm</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">stats_sum</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Bill depth (mm)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-var-dist-stats-sum-bill_depth_mm" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-var-dist-stats-sum-bill_depth_mm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3: Summary statistics for the <code>bill_depth_mm</code> variable.
</figcaption><div aria-describedby="tbl-var-dist-stats-sum-bill_depth_mm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["value"],"name":[2],"type":["chr"],"align":["left"]}],"data":[{"1":"name","2":"Bill depth (mm)"},{"1":"n","2":"151"},{"1":"n_rm_na","2":"151"},{"1":"n_na","2":"0"},{"1":"mean","2":"18.346357615894"},{"1":"var","2":"1.48023664459161"},{"1":"sd","2":"1.21664976250013"},{"1":"min","2":"15.5"},{"1":"q_1","2":"17.5"},{"1":"median","2":"18.4"},{"1":"q_3","2":"19"},{"1":"max","2":"21.5"},{"1":"iqr","2":"1.5"},{"1":"skewness","2":"0.31803874503567"},{"1":"kurtosis","2":"2.90219713516155"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</figure>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">bill_depth_mm</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">test_normality</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Bill depth (mm)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-var-dist-hist-bill_depth_mm" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-var-dist-hist-bill_depth_mm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-var-dist-hist-bill_depth_mm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Histogram of the <code>bill_depth_mm</code> variable with a kernel density estimate, along with a quantile-quantile (Q-Q) plot between the variable and the theoretical quantiles of the normal distribution.
</figcaption></figure>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">flipper_length_mm</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">stats_sum</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Flipper length (mm)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-var-dist-stats-sum-flipper_length_mm" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-var-dist-stats-sum-flipper_length_mm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4: Summary statistics for the <code>flipper_length_mm</code> variable.
</figcaption><div aria-describedby="tbl-var-dist-stats-sum-flipper_length_mm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["value"],"name":[2],"type":["chr"],"align":["left"]}],"data":[{"1":"name","2":"Flipper length (mm)"},{"1":"n","2":"151"},{"1":"n_rm_na","2":"151"},{"1":"n_na","2":"0"},{"1":"mean","2":"189.953642384106"},{"1":"var","2":"42.7645033112583"},{"1":"sd","2":"6.5394574171913"},{"1":"min","2":"172"},{"1":"q_1","2":"186"},{"1":"median","2":"190"},{"1":"q_3","2":"195"},{"1":"max","2":"210"},{"1":"iqr","2":"9"},{"1":"skewness","2":"0.0864668071293883"},{"1":"kurtosis","2":"3.28159425126099"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</figure>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">flipper_length_mm</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">test_normality</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Flipper length (mm)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-var-dist-hist-flipper_length_mm" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-var-dist-hist-flipper_length_mm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-var-dist-hist-flipper_length_mm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Histogram of the <code>flipper_length_mm</code> variable with a kernel density estimate, along with a quantile-quantile (Q-Q) plot between the variable and the theoretical quantiles of the normal distribution.
</figcaption></figure>
</div>
</div>
</div>
</div>
</section><section id="checking-correlations" class="level2"><h2 class="anchored" data-anchor-id="checking-correlations">Checking correlations</h2>
<p>Both <code>bill_length_mm</code> and <code>bill_depth_mm</code> are positively correlated with <code>flipper_length_mm</code> in a significant manner. No non-linear relationships are observed.</p>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span> <span class="fu">plot_ggally</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">rutils</span><span class="fu">:::</span><span class="fu">shush</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-correlations-correlation-matrix" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-correlations-correlation-matrix-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-correlations-correlation-matrix-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Correlation matrix of <code>bill_length_mm</code>, <code>bill_depth_mm</code>, and <code>flipper_length_mm</code> variables.
</figcaption></figure>
</div>
</section><section id="checking-for-outliers" class="level2"><h2 class="anchored" data-anchor-id="checking-for-outliers">Checking for outliers</h2>
<p>A few minor outliers are present in the <code>bill_length_mm</code> and <code>flipper_length_mm</code> variables. We could remove these outliers, but they are not extreme and do not appear to be errors.</p>
<p>A few observations were flagged with Cook’s D values greater than the threshold. One of them (129th) was particularly influential, so it was removed from the dataset.</p>
<section id="boxplots" class="level3"><h3 class="anchored" data-anchor-id="boxplots">Boxplots</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/predict3d/man/gg_color_hue.html">gg_color_hue</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="op">-</span><span class="va">flipper_length_mm</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">name</span>, y <span class="op">=</span> <span class="va">value</span>, fill <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span></span>
<span>    outlier.colour <span class="op">=</span> <span class="st">"red"</span>, </span>
<span>    outlier.shape <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    width <span class="op">=</span> <span class="fl">0.75</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.3</span>, alpha <span class="op">=</span> <span class="fl">0.1</span>, color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Variable"</span>, y <span class="op">=</span> <span class="st">"Value"</span>, fill <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span></span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Bill length (mm)"</span>, <span class="st">"Bill depth (mm)"</span><span class="op">)</span>,</span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"bill_length_mm"</span>, <span class="st">"bill_depth_mm"</span><span class="op">)</span>,</span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/predict3d/man/gg_color_hue.html">gg_color_hue</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    axis.title.y <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.text.y <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.ticks.y <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-outliers-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-outliers-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-outliers-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Boxplots of the <code>bill_length_mm</code> and <code>bill_depth_mm</code> variables, with outliers highlighted in red and other data indicated by jittered points.
</figcaption></figure>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="va">flipper_length_mm</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">name</span>, y <span class="op">=</span> <span class="va">value</span>, fill <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span></span>
<span>    outlier.colour <span class="op">=</span> <span class="st">"red"</span>, </span>
<span>    outlier.shape <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    width <span class="op">=</span> <span class="fl">0.5</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.2</span>, alpha <span class="op">=</span> <span class="fl">0.1</span>, color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span></span>
<span>    labels <span class="op">=</span> <span class="st">"Flipper length (mm)"</span>,</span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/predict3d/man/gg_color_hue.html">gg_color_hue</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/nth.html">last</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Variable"</span>, y <span class="op">=</span> <span class="st">"Value"</span>, fill <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    axis.title.y <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.text.y <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.ticks.y <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-outliers-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-outliers-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-outliers-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: Boxplot of the <code>flipper_length_mm</code> variable, with outliers highlighted in red and other data indicated by jittered points.
</figcaption></figure>
</div>
</section><section id="cooks-distance" class="level3"><h3 class="anchored" data-anchor-id="cooks-distance">Cook’s distance</h3>
<p>The <a href="https://en.wikipedia.org/wiki/Cook%27s_distance">Cook’s distance</a> measures each observation’s influence on the model’s fitted values. It is considered one of the most representative metrics for assessing overall influence <span class="citation" data-cites="hair2019">(<a href="#ref-hair2019" role="doc-biblioref">Hair, 2019</a>)</span>.</p>
<p>A common practice is to flag observations with a Cook’s distance of 1.0 or greater. However, a more conservative threshold of <span class="math inline">\(4 / (n - k - 1)\)</span>, where <span class="math inline">\(n\)</span> is the sample size and <span class="math inline">\(k\)</span> is the number of independent variables, is suggested as a more conservative measure in small samples or for use with larger datasets <span class="citation" data-cites="hair2019">(<a href="#ref-hair2019" role="doc-biblioref">Hair, 2019</a>)</span>.</p>
<p>Learn more about Cook’s D in: <span class="citation" data-cites="cook1977">Cook (<a href="#ref-cook1977" role="doc-biblioref">1977</a>)</span>; <span class="citation" data-cites="cook1979">Cook (<a href="#ref-cook1979" role="doc-biblioref">1979</a>)</span>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cooks_d_cut_off</span> <span class="op">&lt;-</span> <span class="fl">4</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cooks_d_cut_off</span></span>
<span><span class="co">#&gt; [1] 0.02702703</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">form</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html">formula</a></span><span class="op">(</span><span class="va">flipper_length_mm</span> <span class="op">~</span> <span class="va">bill_length_mm</span> <span class="op">+</span> <span class="va">bill_depth_mm</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">form</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cooks_obs</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">fit</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">cooks.distance</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html">is_greater_than</a></span><span class="op">(</span><span class="va">cooks_d_cut_off</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">`names&lt;-`</span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">cooks.distance</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html">extract</a></span><span class="op">(</span><span class="va">cooks_obs</span><span class="op">)</span></span>
<span><span class="co">#&gt;         14         90        122        129 </span></span>
<span><span class="co">#&gt; 0.05229124 0.02997213 0.03644541 0.12296893</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot</span> <span class="op">&lt;-</span> <span class="va">fit</span> <span class="op">|&gt;</span> <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_plot_cooksd_bar.html">ols_plot_cooksd_bar</a></span><span class="op">(</span>print_plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">q</span> <span class="op">&lt;-</span> <span class="va">plot</span><span class="op">$</span><span class="va">plot</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">q</span> <span class="op">&lt;-</span> <span class="va">q</span> <span class="op">|&gt;</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot_build.html">ggplot_build</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">q</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">label</span> <span class="op">&lt;-</span> <span class="st">""</span></span>
<span></span>
<span><span class="va">q</span> <span class="op">|&gt;</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot_gtable.html">ggplot_gtable</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">ggplotify</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggplotify/man/as.ggplot.html">as.ggplot</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="outlier-removal" class="level3"><h3 class="anchored" data-anchor-id="outlier-removal">Outlier removal</h3>
<p>Outlier detection methods indicate which observations are unusual or influential, and it’s our job to determine why certain observations stand out <span class="citation" data-cites="struck2024">(<a href="#ref-struck2024" role="doc-biblioref">Struck, 2024</a>)</span>. In this scenario, a <a href="https://en.wikipedia.org/wiki/Observational_error">observational error</a> or a unique characteristic of the penguin species might be causing some distortions.</p>
<p>For practical reasons, we will remove the 129th observation for now. However, it’s crucial to review the model assumptions before making this decision. Violating an assumption might cause many observations to be incorrectly labeled as outliers.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="op">-</span><span class="fl">129</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="fitting-the-model" class="level2"><h2 class="anchored" data-anchor-id="fitting-the-model">Fitting the model</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">recipe</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">recipes</span><span class="fu">::</span><span class="fu"><a href="https://recipes.tidymodels.org/reference/recipe.html">recipe</a></span><span class="op">(</span><span class="va">form</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">rutils</span><span class="fu">:::</span><span class="fu">shush</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">parsnip</span><span class="fu">::</span><span class="fu"><a href="https://parsnip.tidymodels.org/reference/linear_reg.html">linear_reg</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">parsnip</span><span class="fu">::</span><span class="fu"><a href="https://parsnip.tidymodels.org/reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"lm"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">parsnip</span><span class="fu">::</span><span class="fu"><a href="https://parsnip.tidymodels.org/reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"regression"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">workflow</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">workflows</span><span class="fu">::</span><span class="fu"><a href="https://workflows.tidymodels.org/reference/workflow.html">workflow</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">workflows</span><span class="fu">::</span><span class="fu"><a href="https://workflows.tidymodels.org/reference/add_recipe.html">add_recipe</a></span><span class="op">(</span><span class="va">recipe</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">workflows</span><span class="fu">::</span><span class="fu"><a href="https://workflows.tidymodels.org/reference/add_model.html">add_model</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="va">workflow</span> <span class="op">|&gt;</span> <span class="fu">parsnip</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/fit.html">fit</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/adorn_rounding.html">adorn_rounding</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-model-fit-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-model-fit-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5: Output from the model fitting process showing the estimated coefficients, standard errors, test statistics, and p-values for the terms in the linear regression model.
</figcaption><div aria-describedby="tbl-model-fit-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"(Intercept)","2":"147.83577","3":"8.65123","4":"17.08841","5":"0.00000"},{"1":"bill_length_mm","2":"0.48324","3":"0.20126","4":"2.40102","5":"0.01760"},{"1":"bill_depth_mm","2":"1.26744","3":"0.43480","4":"2.91502","5":"0.00411"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</figure>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/augment.html">augment</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/adorn_rounding.html">adorn_rounding</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-model-fit-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-model-fit-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;6: Model summary table displaying predictions and residuals, along with the variables used in the model.
</figcaption><div aria-describedby="tbl-model-fit-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[".pred"],"name":[1],"type":["dbl"],"align":["right"]},{"label":[".resid"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["bill_length_mm"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["bill_depth_mm"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["flipper_length_mm"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"190.4315","2":"-9.43153","3":"39.1","4":"18.7","5":"181"},{"1":"188.9771","2":"-2.97715","3":"39.5","4":"17.4","5":"186"},{"1":"190.1242","2":"4.87580","3":"40.3","4":"18.0","5":"195"},{"1":"190.0322","2":"2.96778","3":"36.7","4":"19.3","5":"193"},{"1":"192.9363","2":"-2.93632","3":"39.3","4":"20.6","5":"190"},{"1":"189.1942","2":"-8.19418","3":"38.9","4":"17.8","5":"181"},{"1":"191.6206","2":"3.37945","3":"39.2","4":"19.6","5":"195"},{"1":"187.2549","2":"5.74512","3":"34.1","4":"18.1","5":"193"},{"1":"193.7341","2":"-3.73408","3":"42.0","4":"20.2","5":"190"},{"1":"187.7754","2":"-1.77541","3":"37.8","4":"17.1","5":"186"},{"1":"188.0289","2":"-8.02890","3":"37.8","4":"17.3","5":"180"},{"1":"190.0038","2":"-8.00382","3":"41.1","4":"17.6","5":"182"},{"1":"193.3585","2":"-2.35852","3":"38.6","4":"21.2","5":"191"},{"1":"191.2988","2":"6.70118","3":"34.6","4":"21.1","5":"198"},{"1":"188.0827","2":"-3.08274","3":"36.6","4":"17.8","5":"185"},{"1":"190.6185","2":"4.38153","3":"38.7","4":"19.0","5":"195"},{"1":"194.6094","2":"2.39058","3":"42.5","4":"20.7","5":"197"},{"1":"187.7801","2":"-3.78008","3":"34.4","4":"18.4","5":"184"},{"1":"197.3147","2":"-3.31471","3":"46.0","4":"21.5","5":"194"},{"1":"189.2963","2":"-15.29634","3":"37.8","4":"18.3","5":"174"},{"1":"189.7550","2":"-9.75500","3":"37.7","4":"18.7","5":"180"},{"1":"189.5189","2":"-0.51889","3":"35.9","4":"19.2","5":"189"},{"1":"189.2361","2":"-4.23615","3":"38.2","4":"18.1","5":"185"},{"1":"188.3854","2":"-8.38539","3":"38.8","4":"17.2","5":"180"},{"1":"188.8487","2":"-1.84871","3":"35.3","4":"18.9","5":"187"},{"1":"191.0296","2":"-8.02964","3":"40.6","4":"18.6","5":"183"},{"1":"190.0941","2":"-3.09411","3":"40.5","4":"17.9","5":"187"},{"1":"189.7249","2":"-17.72490","3":"37.9","4":"18.6","5":"172"},{"1":"191.3615","2":"-11.36155","3":"40.5","4":"18.9","5":"180"},{"1":"188.0899","2":"-10.08994","3":"39.5","4":"16.7","5":"178"},{"1":"188.7529","2":"-10.75291","3":"37.2","4":"18.1","5":"178"},{"1":"189.4841","2":"-1.48413","3":"39.5","4":"17.8","5":"188"},{"1":"191.5548","2":"-7.55484","3":"40.9","4":"18.9","5":"184"},{"1":"186.9721","2":"8.02787","3":"36.4","4":"17.0","5":"195"},{"1":"193.5217","2":"2.47829","3":"39.2","4":"21.1","5":"196"},{"1":"191.9342","2":"-1.93423","3":"38.8","4":"20.0","5":"190"},{"1":"191.6761","2":"-11.67608","3":"42.2","4":"18.5","5":"180"},{"1":"190.4671","2":"-9.46714","3":"37.6","4":"19.3","5":"181"},{"1":"191.2768","2":"-7.27677","3":"39.8","4":"19.1","5":"184"},{"1":"188.2879","2":"-6.28790","3":"36.5","4":"18.0","5":"182"},{"1":"190.8728","2":"4.12720","3":"40.8","4":"18.4","5":"195"},{"1":"188.6800","2":"-2.68000","3":"36.0","4":"18.5","5":"186"},{"1":"194.1152","2":"1.88484","3":"44.1","4":"19.7","5":"196"},{"1":"187.1353","2":"-2.13533","3":"37.0","4":"16.9","5":"185"},{"1":"190.7999","2":"-0.79989","3":"39.6","4":"18.8","5":"190"},{"1":"191.7782","2":"-9.77824","3":"41.1","4":"19.0","5":"182"},{"1":"189.9118","2":"-10.91184","3":"37.5","4":"18.9","5":"179"},{"1":"187.9195","2":"2.08046","3":"36.0","4":"17.9","5":"190"},{"1":"195.1465","2":"-4.14649","3":"42.3","4":"21.2","5":"191"},{"1":"189.4057","2":"-3.40570","3":"39.6","4":"17.7","5":"186"},{"1":"191.1683","2":"-3.16825","3":"40.1","4":"18.9","5":"188"},{"1":"187.4363","2":"2.56370","3":"35.0","4":"17.9","5":"190"},{"1":"192.8469","2":"7.15313","3":"42.0","4":"19.5","5":"200"},{"1":"187.4482","2":"-0.44817","3":"34.5","4":"18.1","5":"187"},{"1":"191.4162","2":"-0.41623","3":"41.4","4":"18.6","5":"191"},{"1":"188.8623","2":"-2.86227","3":"39.0","4":"17.5","5":"186"},{"1":"191.2831","2":"1.71687","3":"40.6","4":"18.8","5":"193"},{"1":"186.5135","2":"-5.51348","3":"36.5","4":"16.6","5":"181"},{"1":"190.2136","2":"3.78635","3":"37.6","4":"19.1","5":"194"},{"1":"186.5071","2":"-1.50712","3":"35.7","4":"16.9","5":"185"},{"1":"194.5365","2":"0.46349","3":"41.3","4":"21.1","5":"195"},{"1":"187.5520","2":"-2.55202","3":"37.6","4":"17.0","5":"185"},{"1":"190.7643","2":"1.23572","3":"41.1","4":"18.2","5":"192"},{"1":"187.0989","2":"-3.09888","3":"36.4","4":"17.1","5":"184"},{"1":"190.7524","2":"1.24759","3":"41.6","4":"18.0","5":"192"},{"1":"185.5233","2":"9.47673","3":"35.5","4":"16.2","5":"195"},{"1":"191.9050","2":"-3.90498","3":"41.1","4":"19.1","5":"188"},{"1":"186.2235","2":"3.77646","3":"35.9","4":"16.6","5":"190"},{"1":"192.6235","2":"5.37652","3":"41.8","4":"19.4","5":"198"},{"1":"188.1056","2":"1.89437","3":"33.5","4":"19.0","5":"190"},{"1":"190.3412","2":"-0.34124","3":"39.7","4":"18.4","5":"190"},{"1":"188.7720","2":"7.22802","3":"39.6","4":"17.2","5":"196"},{"1":"193.9227","2":"3.07729","3":"45.8","4":"18.9","5":"197"},{"1":"187.1709","2":"2.82906","3":"35.5","4":"17.5","5":"190"},{"1":"191.9660","2":"3.03398","3":"42.8","4":"18.5","5":"195"},{"1":"188.8932","2":"2.10678","3":"40.9","4":"16.8","5":"191"},{"1":"190.4006","2":"-6.40059","3":"37.2","4":"19.4","5":"184"},{"1":"185.7348","2":"1.26521","3":"36.2","4":"16.1","5":"187"},{"1":"192.3882","2":"2.61178","3":"42.1","4":"19.1","5":"195"},{"1":"186.3558","2":"2.64420","3":"34.6","4":"17.2","5":"189"},{"1":"190.8736","2":"5.12636","3":"42.9","4":"17.6","5":"196"},{"1":"189.3985","2":"-2.39850","3":"36.7","4":"18.8","5":"187"},{"1":"189.3858","2":"3.61421","3":"35.1","4":"19.4","5":"193"},{"1":"188.4210","2":"2.57900","3":"37.3","4":"17.8","5":"191"},{"1":"193.5226","2":"0.47744","3":"41.3","4":"20.3","5":"194"},{"1":"190.0924","2":"-0.09242","3":"36.3","4":"19.5","5":"190"},{"1":"189.2417","2":"-0.24166","3":"36.9","4":"18.6","5":"189"},{"1":"190.6787","2":"-1.67866","3":"38.3","4":"19.2","5":"189"},{"1":"190.4616","2":"-0.46163","3":"38.9","4":"18.8","5":"190"},{"1":"187.9013","2":"14.09869","3":"35.7","4":"18.0","5":"202"},{"1":"190.6375","2":"14.36246","3":"41.1","4":"18.1","5":"205"},{"1":"185.9391","2":"-0.93911","3":"34.0","4":"17.1","5":"185"},{"1":"189.9127","2":"-3.91268","3":"39.6","4":"18.1","5":"186"},{"1":"187.2557","2":"-0.25572","3":"36.2","4":"17.3","5":"187"},{"1":"191.5065","2":"16.49348","3":"40.8","4":"18.9","5":"208"},{"1":"189.8215","2":"0.17845","3":"38.1","4":"18.6","5":"190"},{"1":"190.7579","2":"5.24207","3":"40.3","4":"18.5","5":"196"},{"1":"184.2368","2":"-6.23675","3":"33.1","4":"16.1","5":"178"},{"1":"192.1593","2":"-0.15931","3":"43.2","4":"18.5","5":"192"},{"1":"187.4363","2":"4.56370","3":"35.0","4":"17.9","5":"192"},{"1":"192.9974","2":"10.00264","3":"41.0","4":"20.0","5":"203"},{"1":"186.3329","2":"-3.33290","3":"37.7","4":"16.0","5":"183"},{"1":"191.4510","2":"-1.45099","3":"37.8","4":"20.0","5":"190"},{"1":"189.7249","2":"3.27510","3":"37.9","4":"18.6","5":"193"},{"1":"190.9750","2":"-6.97496","3":"39.7","4":"18.9","5":"184"},{"1":"188.2887","2":"10.71125","3":"38.6","4":"17.2","5":"199"},{"1":"191.6443","2":"-1.64429","3":"38.2","4":"20.0","5":"190"},{"1":"187.7936","2":"-6.79364","3":"38.1","4":"17.0","5":"181"},{"1":"192.7930","2":"4.20696","3":"43.2","4":"19.0","5":"197"},{"1":"187.1599","2":"10.84008","3":"38.1","4":"16.5","5":"198"},{"1":"195.6005","2":"-4.60048","3":"45.6","4":"20.3","5":"191"},{"1":"189.4540","2":"3.54597","3":"39.7","4":"17.7","5":"193"},{"1":"192.9435","2":"4.05648","3":"42.2","4":"19.5","5":"197"},{"1":"193.2080","2":"-2.20803","3":"39.6","4":"20.7","5":"191"},{"1":"191.6642","2":"4.33579","3":"42.7","4":"18.3","5":"196"},{"1":"188.0353","2":"-0.03526","3":"38.6","4":"17.0","5":"188"},{"1":"191.8431","2":"7.15690","3":"37.3","4":"20.5","5":"199"},{"1":"186.6339","2":"2.36613","3":"35.7","4":"17.0","5":"189"},{"1":"191.2713","2":"-2.27126","3":"41.1","4":"18.6","5":"189"},{"1":"187.1290","2":"-0.12898","3":"36.2","4":"17.2","5":"187"},{"1":"191.1492","2":"6.85082","3":"37.7","4":"19.8","5":"198"},{"1":"188.8084","2":"-12.80844","3":"40.2","4":"17.0","5":"176"},{"1":"191.2895","2":"10.71051","3":"41.4","4":"18.5","5":"202"},{"1":"184.9981","2":"1.00194","3":"35.2","4":"15.9","5":"186"},{"1":"191.5366","2":"7.46338","3":"40.6","4":"19.0","5":"199"},{"1":"188.8924","2":"2.10763","3":"38.8","4":"17.6","5":"191"},{"1":"191.0843","2":"3.91568","3":"41.5","4":"18.3","5":"195"},{"1":"188.3553","2":"2.64470","3":"39.0","4":"17.1","5":"191"},{"1":"189.1276","2":"0.87237","3":"38.5","4":"17.9","5":"190"},{"1":"192.9982","2":"4.00180","3":"43.1","4":"19.2","5":"197"},{"1":"189.0666","2":"3.93341","3":"36.8","4":"18.5","5":"193"},{"1":"189.4049","2":"9.59514","3":"37.5","4":"18.5","5":"199"},{"1":"188.5541","2":"-1.55410","3":"38.1","4":"17.6","5":"187"},{"1":"189.8771","2":"0.12293","3":"41.1","4":"17.5","5":"190"},{"1":"187.2193","2":"3.78073","3":"35.6","4":"17.5","5":"191"},{"1":"192.7375","2":"7.26249","3":"40.2","4":"20.1","5":"200"},{"1":"186.6284","2":"-1.62836","3":"37.0","4":"16.5","5":"185"},{"1":"189.7075","2":"3.29248","3":"39.7","4":"17.9","5":"193"},{"1":"188.9352","2":"4.06482","3":"40.2","4":"17.1","5":"193"},{"1":"189.2552","2":"-2.25522","3":"40.6","4":"17.2","5":"187"},{"1":"182.9930","2":"5.00695","3":"32.1","4":"15.5","5":"188"},{"1":"189.0501","2":"0.94994","3":"40.7","4":"17.0","5":"190"},{"1":"187.1536","2":"4.84644","3":"37.3","4":"16.8","5":"192"},{"1":"190.3832","2":"-5.38320","3":"39.0","4":"18.7","5":"185"},{"1":"190.3531","2":"-0.35311","3":"39.2","4":"18.6","5":"190"},{"1":"188.8432","2":"-4.84320","3":"36.6","4":"18.4","5":"184"},{"1":"187.7928","2":"7.20721","3":"36.0","4":"17.8","5":"195"},{"1":"189.0429","2":"3.95715","3":"37.8","4":"18.1","5":"193"},{"1":"186.9056","2":"0.09442","3":"36.0","4":"17.1","5":"187"},{"1":"191.3378","2":"9.66219","3":"41.5","4":"18.5","5":"201"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</figure>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html">glance</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/adorn_rounding.html">adorn_rounding</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-model-fit-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-model-fit-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7: Summary of model fit statistics showing key metrics including R-squared, adjusted R-squared, sigma, statistic, p-value, degrees of freedom, log-likelihood, AIC, BIC, and deviance.
</figcaption><div aria-describedby="tbl-model-fit-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["value"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"r.squared","2":"0.1387159862"},{"1":"adj.r.squared","2":"0.1269978363"},{"1":"sigma","2":"5.9341267735"},{"1":"statistic","2":"11.8377037290"},{"1":"p.value","2":"0.0000171104"},{"1":"df","2":"2.0000000000"},{"1":"logLik","2":"-478.4335597668"},{"1":"AIC","2":"964.8671195337"},{"1":"BIC","2":"976.9096607101"},{"1":"deviance","2":"5176.4375029678"},{"1":"df.residual","2":"147.0000000000"},{"1":"nobs","2":"150.0000000000"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</figure>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">&lt;-</span> <span class="va">fit</span> <span class="op">|&gt;</span> <span class="fu">parsnip</span><span class="fu">::</span><span class="fu"><a href="https://hardhat.tidymodels.org/reference/hardhat-extract.html">extract_fit_engine</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; stats::lm(formula = ..y ~ ., data = data)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -17.7249  -3.1509  -0.0638   3.7849  16.4935 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                Estimate Std. Error t value             Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)    147.8358     8.6512  17.088 &lt; 0.0000000000000002 ***</span></span>
<span><span class="co">#&gt; bill_length_mm   0.4832     0.2013   2.401              0.01760 *  </span></span>
<span><span class="co">#&gt; bill_depth_mm    1.2674     0.4348   2.915              0.00411 ** </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 5.934 on 147 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.1387, Adjusted R-squared:  0.127 </span></span>
<span><span class="co">#&gt; F-statistic: 11.84 on 2 and 147 DF,  p-value: 0.00001711</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">parameters</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/parameters/reference/standardize_parameters.html">standardize_parameters</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Parameter"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Std_Coefficient"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["CI"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["CI_low"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["CI_high"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"(Intercept)","2":"0.0000000000000009988327","3":"0.95","4":"-0.15076490","5":"0.1507649","_rn_":"1"},{"1":"bill_length_mm","2":"0.2006010328871788706007","3":"0.95","4":"0.03549008","5":"0.3657120","_rn_":"2"},{"1":"bill_depth_mm","2":"0.2435448981563605175271","3":"0.95","4":"0.07843395","5":"0.4086559","_rn_":"3"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># A jerry-rigged solution to fix issues related to modeling using the pipe.</span></span>
<span></span>
<span><span class="co"># fit_2 &lt;- fit</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># fit_2$fit$fit$fit$call &lt;- call(</span></span>
<span><span class="co">#   "lm", </span></span>
<span><span class="co">#   flipper_length_mm ~ bill_length_mm + bill_depth_mm, </span></span>
<span><span class="co">#   data = quote("data")</span></span>
<span><span class="co"># )</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># fit_engine_2 &lt;- fit_2 |&gt; parsnip::extract_fit_engine()</span></span>
<span></span>
<span><span class="va">fit_engine_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">form</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">report</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/report/reference/report.html">report</a></span><span class="op">(</span><span class="va">fit_engine_2</span><span class="op">)</span></span>
<span><span class="co">#&gt; We fitted a linear model (estimated using OLS) to predict flipper_length_mm</span></span>
<span><span class="co">#&gt; with bill_length_mm and bill_depth_mm (formula: flipper_length_mm ~</span></span>
<span><span class="co">#&gt; bill_length_mm + bill_depth_mm). The model explains a statistically</span></span>
<span><span class="co">#&gt; significant and moderate proportion of variance (R2 = 0.14, F(2, 147) =</span></span>
<span><span class="co">#&gt; 11.84, p &lt; .001, adj. R2 = 0.13). The model's intercept, corresponding to</span></span>
<span><span class="co">#&gt; bill_length_mm = 0 and bill_depth_mm = 0, is at 147.84 (95% CI [130.74,</span></span>
<span><span class="co">#&gt; 164.93], t(147) = 17.09, p &lt; .001). Within this model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   - The effect of bill length mm is statistically significant and positive</span></span>
<span><span class="co">#&gt; (beta = 0.48, 95% CI [0.09, 0.88], t(147) = 2.40, p = 0.018; Std. beta =</span></span>
<span><span class="co">#&gt; 0.20, 95% CI [0.04, 0.37])</span></span>
<span><span class="co">#&gt;   - The effect of bill depth mm is statistically significant and positive</span></span>
<span><span class="co">#&gt; (beta = 1.27, 95% CI [0.41, 2.13], t(147) = 2.92, p = 0.004; Std. beta =</span></span>
<span><span class="co">#&gt; 0.24, 95% CI [0.08, 0.41])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Standardized parameters were obtained by fitting the model on a standardized</span></span>
<span><span class="co">#&gt; version of the dataset. 95% Confidence Intervals (CIs) and p-values were</span></span>
<span><span class="co">#&gt; computed using a Wald t-distribution approximation.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="inspecting-the-model-fit" class="level2"><h2 class="anchored" data-anchor-id="inspecting-the-model-fit">Inspecting the model fit</h2>
<section id="general-model" class="level3"><h3 class="anchored" data-anchor-id="general-model">General model</h3>
<p>In a multiple linear regression with two predictors, the model is fit by adjusting a plane to the data points.</p>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">user_matrix</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span><span class="op">(</span></span>
<span>    <span class="op">~</span><span class="va">a</span>,         <span class="op">~</span><span class="va">b</span>,         <span class="op">~</span><span class="va">c</span>,          <span class="op">~</span><span class="va">d</span>,</span>
<span>    <span class="fl">0.6233152</span>,  <span class="op">-</span><span class="fl">0.7817951</span>, <span class="op">-</span><span class="fl">0.01657271</span>, <span class="fl">0</span>,</span>
<span>    <span class="fl">0.1739255</span>,  <span class="fl">0.1179437</span>,  <span class="fl">0.97767037</span>,  <span class="fl">0</span>,</span>
<span>    <span class="op">-</span><span class="fl">0.7623830</span>, <span class="op">-</span><span class="fl">0.6122792</span>, <span class="fl">0.20949011</span>,  <span class="fl">0</span>,</span>
<span>    <span class="fl">0</span>,          <span class="fl">0</span>,          <span class="fl">0</span>,           <span class="fl">1</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">`colnames&lt;-`</span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit_engine</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">predict3d</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/predict3d/man/predict3d.html">predict3d</a></span><span class="op">(</span></span>
<span>    xlab <span class="op">=</span> <span class="st">"Bill length (mm)"</span>,</span>
<span>    ylab <span class="op">=</span> <span class="st">"Bill depth (mm)"</span>,</span>
<span>    zlab <span class="op">=</span> <span class="st">"Flipper length (mm)"</span>,</span>
<span>    radius <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>    type <span class="op">=</span> <span class="st">"s"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>    show.subtitle <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    show.error <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu">rgl</span><span class="fu">::</span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/viewpoint.html">view3d</a></span><span class="op">(</span>userMatrix <span class="op">=</span> <span class="va">user_matrix</span>, zoom <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">rgl</span><span class="fu">::</span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/rglwidget.html">rglwidget</a></span><span class="op">(</span>elementId <span class="op">=</span> <span class="st">"1st"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">rutils</span><span class="fu">:::</span><span class="fu">shush</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-model-fit-comparison-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-model-fit-comparison-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display no-overflow-x">
<div id="1st" style="width:100%;height:464px;" class="rglWebGL html-widget" role="img" aria-labelledby="1st-aria"></div>
<script type="application/json" data-for="1st">{"x":{"material":{"color":"#000000","alpha":1,"lit":true,"ambient":"#000000","specular":"#FFFFFF","emission":"#000000","shininess":50,"smooth":true,"front":"filled","back":"filled","size":3,"lwd":1,"fog":true,"point_antialias":false,"line_antialias":false,"texture":null,"textype":"rgb","texmode":"modulate","texmipmap":false,"texminfilter":"linear","texmagfilter":"linear","texenvmap":false,"depth_mask":true,"depth_test":"less","isTransparent":false,"polygon_offset":[0,0],"margin":"","floating":false,"tag":"","blend":["src_alpha","one_minus_src_alpha"]},"rootSubscene":7,"objects":{"14":{"id":14,"type":"clipplanes","offsets":[[-28.88999938964844],[49.20999908447266],[-13.94999980926514],[23.04999923706055],[-154.8000030517578],[225.1999969482422]],"normals":"0","flags":512},"15":{"id":15,"type":"spheres","material":{},"vertices":"1","colors":"2","radii":[[0.75]],"centers":"3","ignoreExtent":false,"fastTransparency":true,"flags":32771},"16":{"id":16,"type":"lines","material":{"lit":false},"vertices":"4","colors":"5","centers":"6","ignoreExtent":false,"flags":32832},"18":{"id":18,"type":"text","material":{"lit":false,"margin":0,"edge":[0,-1,-1]},"vertices":"7","colors":"8","texts":[[""]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"9","family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":33808},"19":{"id":19,"type":"text","material":{"lit":false,"margin":0,"floating":true,"edge":[0,1,1]},"vertices":"10","colors":"11","texts":[["Bill length (mm)"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"12","family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":33808},"20":{"id":20,"type":"text","material":{"lit":false,"margin":1,"floating":true,"edge":[1,1,1]},"vertices":"13","colors":"14","texts":[["Bill depth (mm)"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"15","family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":33808},"21":{"id":21,"type":"text","material":{"lit":false,"margin":2,"floating":true,"edge":[1,1,1]},"vertices":"16","colors":"17","texts":[["Flipper length (mm)"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"18","family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":33808},"22":{"id":22,"type":"surface","material":{"alpha":0.4980392158031464,"front":"lines","back":"lines","isTransparent":true},"vertices":"19","colors":"21","dim":[[30,20]],"centers":"22","normals":"20","ignoreExtent":false,"flipped":true,"flags":32811},"11":{"id":11,"type":"light","vertices":[[0,0,1]],"colors":[[1,1,1,1],[1,1,1,1],[1,1,1,1]],"viewpoint":true,"finite":false},"10":{"id":10,"type":"background","material":{},"colors":"23","centers":"24","sphere":false,"fogtype":"none","fogscale":1,"flags":32768},"12":{"id":12,"type":"background","material":{"lit":false,"back":"lines"},"colors":"25","centers":"26","sphere":false,"fogtype":"none","fogscale":1,"flags":32768},"17":{"id":17,"type":"bboxdeco","material":{"front":"lines","back":"lines"},"vertices":"27","colors":"28","axes":{"mode":["pretty","pretty","pretty"],"step":[5,2,20],"nticks":[5,5,5],"marklen":[15,15,15],"expand":[1.029999971389771,1.029999971389771,1.029999971389771]},"draw_front":true,"flags":32769},"13":{"id":13,"type":"subscene","par3d":{"antialias":8,"FOV":60,"ignoreExtent":false,"listeners":7,"mouseMode":{"none":"none","left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,93.526611328125],"modelMatrix":[[1.307664036750793,-3.662383079528809,-0.01003536302596331,18.59652709960938],[0.3648813962936401,0.5525168776512146,0.5920140743255615,-136.9528503417969],[-1.599416851997375,-2.868271827697754,0.1268536895513535,-2.108558654785156],[0,0,0,1]],"projMatrix":[[1.924500942230225,0,0,0],[0,1.924500942230225,0,0],[0,0,-2,-140.2899169921875],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[0.6233152,-0.7817951,-0.01657271,0],[0.1739255,0.1179437,0.97767037,0],[-0.762383,-0.6122792,0.20949011,0],[0,0,0,1]],"userProjection":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"scale":[2.097917795181274,4.684581756591797,0.6055354475975037],"viewport":{"x":0,"y":0,"width":1,"height":1},"zoom":0.8999999761581421,"bbox":[31.74250030517578,46.35749816894531,15.33990001678467,21.66009902954102,170.7614288330078,209.2385711669922],"windowRect":[50,50,690,690],"family":"sans","font":1,"cex":1,"useFreeType":false,"fontname":"TT Arial","maxClipPlanes":8,"glVersion":4.6,"activeSubscene":0},"embeddings":{"viewport":"inherit","projection":"inherit","model":"inherit","mouse":"inherit"},"objects":[14,15,11],"parent":7,"subscenes":[],"flags":33539},"7":{"id":7,"type":"subscene","par3d":{"antialias":8,"FOV":60,"ignoreExtent":false,"listeners":7,"mouseMode":{"none":"none","left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,93.526611328125],"modelMatrix":[[1.307664036750793,-3.662383079528809,-0.01003536302596331,18.59652709960938],[0.3648813962936401,0.5525168776512146,0.5920140743255615,-136.9528503417969],[-1.599416851997375,-2.868271827697754,0.1268536895513535,-2.108558654785156],[0,0,0,1]],"projMatrix":[[1.924500942230225,0,0,0],[0,1.924500942230225,0,0],[0,0,-2,-140.2899169921875],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[0.6233152,-0.7817951,-0.01657271,0],[0.1739255,0.1179437,0.97767037,0],[-0.762383,-0.6122792,0.20949011,0],[0,0,0,1]],"userProjection":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"scale":[2.097917795181274,4.684581756591797,0.6055354475975037],"viewport":{"x":0,"y":0,"width":1,"height":1},"zoom":0.8999999761581421,"bbox":[28.88999938964844,49.20999908447266,13.94999980926514,23.04999923706055,154.8000030517578,225.1999969482422],"windowRect":[50,50,690,690],"family":"sans","font":1,"cex":1,"useFreeType":false,"fontname":"TT Arial","maxClipPlanes":8,"glVersion":4.6,"activeSubscene":0},"embeddings":{"viewport":"replace","projection":"replace","model":"replace","mouse":"replace"},"objects":[12,17,16,18,19,20,21,22,11,13],"subscenes":13,"flags":34683}},"crosstalk":{"key":[],"group":[],"id":[],"options":[]},"width":672,"height":480,"buffer":{"accessors":[{"bufferView":0,"componentType":5120,"count":6,"type":"VEC3"},{"bufferView":1,"componentType":5126,"count":150,"type":"VEC3"},{"bufferView":2,"componentType":5121,"count":150,"type":"VEC4","normalized":true},{"bufferView":3,"componentType":5126,"count":150,"type":"VEC3"},{"bufferView":4,"componentType":5126,"count":4,"type":"VEC3"},{"bufferView":5,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":6,"componentType":5126,"count":2,"type":"VEC3"},{"bufferView":7,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":8,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":9,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":10,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":11,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":12,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":13,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":14,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":15,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":16,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":17,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":18,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":19,"componentType":5126,"count":600,"type":"VEC3"},{"bufferView":20,"componentType":5126,"count":600,"type":"VEC3"},{"bufferView":21,"componentType":5126,"count":1,"type":"VEC4"},{"bufferView":22,"componentType":5126,"count":551,"type":"VEC3"},{"bufferView":23,"componentType":5126,"count":1,"type":"VEC4"},{"bufferView":24,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":25,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":26,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":27,"componentType":5126,"count":13,"type":"VEC3"},{"bufferView":28,"componentType":5121,"count":1,"type":"VEC4"}],"bufferViews":[{"buffer":0,"byteLength":18,"byteOffset":0},{"buffer":0,"byteLength":1800,"byteOffset":20},{"buffer":0,"byteLength":600,"byteOffset":1820},{"buffer":0,"byteLength":1800,"byteOffset":2420},{"buffer":0,"byteLength":48,"byteOffset":4220},{"buffer":0,"byteLength":4,"byteOffset":4268},{"buffer":0,"byteLength":24,"byteOffset":4272},{"buffer":0,"byteLength":12,"byteOffset":4296},{"buffer":0,"byteLength":4,"byteOffset":4308},{"buffer":0,"byteLength":12,"byteOffset":4312},{"buffer":0,"byteLength":12,"byteOffset":4324},{"buffer":0,"byteLength":4,"byteOffset":4336},{"buffer":0,"byteLength":12,"byteOffset":4340},{"buffer":0,"byteLength":12,"byteOffset":4352},{"buffer":0,"byteLength":4,"byteOffset":4364},{"buffer":0,"byteLength":12,"byteOffset":4368},{"buffer":0,"byteLength":12,"byteOffset":4380},{"buffer":0,"byteLength":4,"byteOffset":4392},{"buffer":0,"byteLength":12,"byteOffset":4396},{"buffer":0,"byteLength":7200,"byteOffset":4408},{"buffer":0,"byteLength":7200,"byteOffset":11608},{"buffer":0,"byteLength":16,"byteOffset":18808},{"buffer":0,"byteLength":6612,"byteOffset":18824},{"buffer":0,"byteLength":16,"byteOffset":25436},{"buffer":0,"byteLength":3,"byteOffset":25452},{"buffer":0,"byteLength":4,"byteOffset":25455},{"buffer":0,"byteLength":3,"byteOffset":25459},{"buffer":0,"byteLength":156,"byteOffset":25464},{"buffer":0,"byteLength":4,"byteOffset":25620}],"buffers":[{"byteLength":25624,"bytes":"AQAA/wAAAAEAAP8AAAABAAD/AABmZhxCmpmVQQAANUMAAB5CMzOLQQAAOkMzMyFCAACQQQAA\nQ0PNzBJCZmaaQQAAQUMzMx1CzcykQQAAPkOamRtCZmaOQQAANUPNzBxCzcycQQAAQ0NmZghC\nzcyQQQAAQUMAAChCmpmhQQAAPkMzMxdCzcyIQQAAOkMzMxdCZmaKQQAANENmZiRCzcyMQQAA\nNkNmZhpCmpmpQQAAP0NmZgpCzcyoQQAARkNmZhJCZmaOQQAAOUPNzBpCAACYQQAAQ0MAACpC\nmpmlQQAARUOamQlCMzOTQQAAOEMAADhCAACsQQAAQkMzMxdCZmaSQQAALkPNzBZCmpmVQQAA\nNEOamQ9CmpmZQQAAPUPNzBhCzcyQQQAAOUMzMxtCmpmJQQAANEMzMw1CMzOXQQAAO0NmZiJC\nzcyUQQAAN0MAACJCMzOPQQAAO0OamRdCzcyUQQAALEMAACJCMzOXQQAANEMAAB5CmpmFQQAA\nMkPNzBRCzcyQQQAAMkMAAB5CZmaOQQAAPEOamSNCMzOXQQAAOEOamRFCAACIQQAAQ0PNzBxC\nzcyoQQAAREMzMxtCAACgQQAAPkPNzChCAACUQQAANENmZhZCZmaaQQAANUMzMx9CzcyYQQAA\nOEMAABJCAACQQQAANkMzMyNCMzOTQQAAQ0MAABBCAACUQQAAOkNmZjBCmpmdQQAAREMAABRC\nMzOHQQAAOUNmZh5CZmaWQQAAPkNmZiRCAACYQQAANkMAABZCMzOXQQAAM0MAABBCMzOPQQAA\nPkMzMylCmpmpQQAAP0NmZh5CmpmNQQAAOkNmZiBCMzOXQQAAPEMAAAxCMzOPQQAAPkMAAChC\nAACcQQAASEMAAApCzcyQQQAAO0OamSVCzcyUQQAAP0MAABxCAACMQQAAOkNmZiJCZmaWQQAA\nQUMAABJCzcyEQQAANUNmZhZCzcyYQQAAQkPNzA5CMzOHQQAAOUMzMyVCzcyoQQAAQ0NmZhZC\nAACIQQAAOUNmZiRCmpmRQQAAQEOamRFCzcyIQQAAOENmZiZCAACQQQAAQEMAAA5CmpmBQQAA\nQ0NmZiRCzcyYQQAAPEOamQ9CzcyEQQAAPkMzMydCMzObQQAARkMAAAZCAACYQQAAPkPNzB5C\nMzOTQQAAPkNmZh5CmpmJQQAAREMzMzdCMzOXQQAARUMAAA5CAACMQQAAPkMzMytCAACUQQAA\nQ0OamSNCZmaGQQAAP0PNzBRCMzObQQAAOEPNzBBCzcyAQQAAO0NmZihCzcyYQQAAQ0NmZgpC\nmpmJQQAAPUOamStCzcyMQQAAREPNzBJCZmaWQQAAO0NmZgxCMzObQQAAQUMzMxVCZmaOQQAA\nP0MzMyVCZmaiQQAAQkMzMxFCAACcQQAAPkOamRNCzcyUQQAAPUMzMxlCmpmZQQAAPUOamRtC\nZmaWQQAAPkPNzA5CAACQQQAASkNmZiRCzcyQQQAATUMAAAhCzcyIQQAAOUNmZh5CzcyQQQAA\nOkPNzBBCZmaKQQAAO0MzMyNCMzOXQQAAUENmZhhCzcyUQQAAPkMzMyFCAACUQQAARENmZgRC\nzcyAQQAAMkPNzCxCAACUQQAAQEMAAAxCMzOPQQAAQEMAACRCAACgQQAAS0PNzBZCAACAQQAA\nN0MzMxdCAACgQQAAPkOamRdCzcyUQQAAQUPNzB5CMzOXQQAAOENmZhpCmpmJQQAAR0PNzBhC\nAACgQQAAPkNmZhhCAACIQQAANUPNzCxCAACYQQAARUNmZhhCAACEQQAARkNmZjZCZmaiQQAA\nP0PNzB5CmpmNQQAAQUPNzChCAACcQQAARUNmZh5CmpmlQQAAP0PNzCpCZmaSQQAARENmZhpC\nAACIQQAAPEMzMxVCAACkQQAAR0PNzA5CAACIQQAAPUNmZiRCzcyUQQAAPUPNzBBCmpmJQQAA\nO0PNzBZCZmaeQQAARkPNzCBCAACIQQAAMEOamSVCAACUQQAASkPNzAxCZmZ+QQAAOkNmZiJC\nAACYQQAAR0MzMxtCzcyMQQAAP0MAACZCZmaSQQAAQ0MAABxCzcyIQQAAP0MAABpCMzOPQQAA\nPkNmZixCmpmZQQAARUMzMxNCAACUQQAAQUMAABZCAACUQQAAR0NmZhhCzcyMQQAAO0NmZiRC\nAACMQQAAPkNmZg5CAACMQQAAP0PNzCBCzcygQQAASEMAABRCAACEQQAAOUPNzB5CMzOPQQAA\nQUPNzCBCzcyIQQAAQUNmZiJCmpmJQQAAO0NmZgBCAAB4QQAAPEPNzCJCAACIQQAAPkMzMxVC\nZmaGQQAAQEMAABxCmpmVQQAAOUPNzBxCzcyUQQAAPkNmZhJCMzOTQQAAOEMAABBCZmaOQQAA\nQ0MzMxdCzcyQQQAAQUMAABBCzcyIQQAAO0MAACZCAACUQQAASUP/AAD//wAA//8AAP//AAD/\n/wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8A\nAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD/\n/wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8A\nAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD/\n/wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8A\nAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD/\n/wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8A\nAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD/\n/wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8A\nAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD/\n/wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP9mZhxCmpmVQQAA\nNUMAAB5CMzOLQQAAOkMzMyFCAACQQQAAQ0PNzBJCZmaaQQAAQUMzMx1CzcykQQAAPkOamRtC\nZmaOQQAANUPNzBxCzcycQQAAQ0NmZghCzcyQQQAAQUMAAChCmpmhQQAAPkMzMxdCzcyIQQAA\nOkMzMxdCZmaKQQAANENmZiRCzcyMQQAANkNmZhpCmpmpQQAAP0NmZgpCzcyoQQAARkNmZhJC\nZmaOQQAAOUPNzBpCAACYQQAAQ0MAACpCmpmlQQAARUOamQlCMzOTQQAAOEMAADhCAACsQQAA\nQkMzMxdCZmaSQQAALkPNzBZCmpmVQQAANEOamQ9CmpmZQQAAPUPNzBhCzcyQQQAAOUMzMxtC\nmpmJQQAANEMzMw1CMzOXQQAAO0NmZiJCzcyUQQAAN0MAACJCMzOPQQAAO0OamRdCzcyUQQAA\nLEMAACJCMzOXQQAANEMAAB5CmpmFQQAAMkPNzBRCzcyQQQAAMkMAAB5CZmaOQQAAPEOamSNC\nMzOXQQAAOEOamRFCAACIQQAAQ0PNzBxCzcyoQQAAREMzMxtCAACgQQAAPkPNzChCAACUQQAA\nNENmZhZCZmaaQQAANUMzMx9CzcyYQQAAOEMAABJCAACQQQAANkMzMyNCMzOTQQAAQ0MAABBC\nAACUQQAAOkNmZjBCmpmdQQAAREMAABRCMzOHQQAAOUNmZh5CZmaWQQAAPkNmZiRCAACYQQAA\nNkMAABZCMzOXQQAAM0MAABBCMzOPQQAAPkMzMylCmpmpQQAAP0NmZh5CmpmNQQAAOkNmZiBC\nMzOXQQAAPEMAAAxCMzOPQQAAPkMAAChCAACcQQAASEMAAApCzcyQQQAAO0OamSVCzcyUQQAA\nP0MAABxCAACMQQAAOkNmZiJCZmaWQQAAQUMAABJCzcyEQQAANUNmZhZCzcyYQQAAQkPNzA5C\nMzOHQQAAOUMzMyVCzcyoQQAAQ0NmZhZCAACIQQAAOUNmZiRCmpmRQQAAQEOamRFCzcyIQQAA\nOENmZiZCAACQQQAAQEMAAA5CmpmBQQAAQ0NmZiRCzcyYQQAAPEOamQ9CzcyEQQAAPkMzMydC\nMzObQQAARkMAAAZCAACYQQAAPkPNzB5CMzOTQQAAPkNmZh5CmpmJQQAAREMzMzdCMzOXQQAA\nRUMAAA5CAACMQQAAPkMzMytCAACUQQAAQ0OamSNCZmaGQQAAP0PNzBRCMzObQQAAOEPNzBBC\nzcyAQQAAO0NmZihCzcyYQQAAQ0NmZgpCmpmJQQAAPUOamStCzcyMQQAAREPNzBJCZmaWQQAA\nO0NmZgxCMzObQQAAQUMzMxVCZmaOQQAAP0MzMyVCZmaiQQAAQkMzMxFCAACcQQAAPkOamRNC\nzcyUQQAAPUMzMxlCmpmZQQAAPUOamRtCZmaWQQAAPkPNzA5CAACQQQAASkNmZiRCzcyQQQAA\nTUMAAAhCzcyIQQAAOUNmZh5CzcyQQQAAOkPNzBBCZmaKQQAAO0MzMyNCMzOXQQAAUENmZhhC\nzcyUQQAAPkMzMyFCAACUQQAARENmZgRCzcyAQQAAMkPNzCxCAACUQQAAQEMAAAxCMzOPQQAA\nQEMAACRCAACgQQAAS0PNzBZCAACAQQAAN0MzMxdCAACgQQAAPkOamRdCzcyUQQAAQUPNzB5C\nMzOXQQAAOENmZhpCmpmJQQAAR0PNzBhCAACgQQAAPkNmZhhCAACIQQAANUPNzCxCAACYQQAA\nRUNmZhhCAACEQQAARkNmZjZCZmaiQQAAP0PNzB5CmpmNQQAAQUPNzChCAACcQQAARUNmZh5C\nmpmlQQAAP0PNzCpCZmaSQQAARENmZhpCAACIQQAAPEMzMxVCAACkQQAAR0PNzA5CAACIQQAA\nPUNmZiRCzcyUQQAAPUPNzBBCmpmJQQAAO0PNzBZCZmaeQQAARkPNzCBCAACIQQAAMEOamSVC\nAACUQQAASkPNzAxCZmZ+QQAAOkNmZiJCAACYQQAAR0MzMxtCzcyMQQAAP0MAACZCZmaSQQAA\nQ0MAABxCzcyIQQAAP0MAABpCMzOPQQAAPkNmZixCmpmZQQAARUMzMxNCAACUQQAAQUMAABZC\nAACUQQAAR0NmZhhCzcyMQQAAO0NmZiRCAACMQQAAPkNmZg5CAACMQQAAP0PNzCBCzcygQQAA\nSEMAABRCAACEQQAAOUPNzB5CMzOPQQAAQUPNzCBCzcyIQQAAQUNmZiJCmpmJQQAAO0NmZgBC\nAAB4QQAAPEPNzCJCAACIQQAAPkMzMxVCZmaGQQAAQEMAABxCmpmVQQAAOUPNzBxCzcyUQQAA\nPkNmZhJCMzOTQQAAOEMAABBCZmaOQQAAQ0MzMxdCzcyQQQAAQUMAABBCzcyIQQAAO0MAACZC\nAACUQQAASUO4HudBMzNfQc3MGkO4HudBMzNfQc3MGkMK10RCZma4QTMzYUMK10RCZma4QTMz\nYUMAAAABuB7nQTMzX0HNzBpDCtdEQmZmuEEzM2FDAADAfwAAAEAAAAAAAAAAAQAAwH8AAABA\nAAAAAAAAwH8AAIBAAACAPwAAAAEAAMB/AACAQAAAgD8AAMB/AACAQAAAgD8AAAABAADAfwAA\ngEAAAIA/AADAfwAAgEAAAIA/AAAAAQAAwH8AAIBAAACAP2ZmAEIAAHhBOf42QzdRAkIAAHhB\nhDk3Qwc8BEIAAHhB0HQ3Q9cmBkIAAHhBG7A3Q6gRCEIAAHhBZ+s3Q3j8CUIAAHhBsiY4Q0jn\nC0IAAHhB/WE4QxnSDUIAAHhBSZ04Q+m8D0IAAHhBlNg4Q7mnEUIAAHhB4BM5Q4qSE0IAAHhB\nK085Q1p9FUIAAHhBd4o5QypoF0IAAHhBwsU5Q/tSGUIAAHhBDgE6Q8s9G0IAAHhBWTw6Q5so\nHUIAAHhBpXc6Q2wTH0IAAHhB8LI6Qzz+IEIAAHhBPO46QwzpIkIAAHhBhyk7Q93TJEIAAHhB\n02Q7Q62+JkIAAHhBHqA7Q32pKEIAAHhBats7Q06UKkIAAHhBtRY8Qx5/LEIAAHhBAVI8Q+5p\nLkIAAHhBTI08Q79UMEIAAHhBmMg8Q48/MkIAAHhB4wM9Q18qNEIAAHhBLz89QzAVNkIAAHhB\neno9QwAAOEIAAHhBxrU9Q2ZmAEJ5DX1Br2Q3QzdRAkJ5DX1B+p83Qwc8BEJ5DX1BRts3Q9cm\nBkJ5DX1BkRY4Q6gRCEJ5DX1B3VE4Q3j8CUJ5DX1BKI04Q0jnC0J5DX1BdMg4QxnSDUJ5DX1B\nvwM5Q+m8D0J5DX1BCz85Q7mnEUJ5DX1BVno5Q4qSE0J5DX1BorU5Q1p9FUJ5DX1B7fA5Qypo\nF0J5DX1BOSw6Q/tSGUJ5DX1BhGc6Q8s9G0J5DX1B0KI6Q5soHUJ5DX1BG946Q2wTH0J5DX1B\nZxk7Qzz+IEJ5DX1BslQ7QwzpIkJ5DX1B/o87Q93TJEJ5DX1BScs7Q62+JkJ5DX1BlQY8Q32p\nKEJ5DX1B4EE8Q06UKkJ5DX1BLH08Qx5/LEJ5DX1Bd7g8Q+5pLkJ5DX1Bw/M8Q79UMEJ5DX1B\nDi89Q48/MkJ5DX1BWmo9Q18qNEJ5DX1BpaU9QzAVNkJ5DX1B8eA9QwAAOEJ5DX1BPBw+Q2Zm\nAEJ5DYFBJcs3QzdRAkJ5DYFBcQY4Qwc8BEJ5DYFBvEE4Q9cmBkJ5DYFBCH04Q6gRCEJ5DYFB\nU7g4Q3j8CUJ5DYFBn/M4Q0jnC0J5DYFB6i45QxnSDUJ5DYFBNmo5Q+m8D0J5DYFBgaU5Q7mn\nEUJ5DYFBzeA5Q4qSE0J5DYFBGBw6Q1p9FUJ5DYFBZFc6QypoF0J5DYFBr5I6Q/tSGUJ5DYFB\n+806Q8s9G0J5DYFBRgk7Q5soHUJ5DYFBkkQ7Q2wTH0J5DYFB3X87Qzz+IEJ5DYFBKbs7Qwzp\nIkJ5DYFBdPY7Q93TJEJ5DYFBwDE8Q62+JkJ5DYFBC208Q32pKEJ5DYFBV6g8Q06UKkJ5DYFB\nouM8Qx5/LEJ5DYFB7h49Q+5pLkJ5DYFBOVo9Q79UMEJ5DYFBhZU9Q48/MkJ5DYFB0NA9Q18q\nNEJ5DYFBHAw+QzAVNkJ5DYFBZ0c+QwAAOEJ5DYFBs4I+Q2ZmAEI2lINBnDE4QzdRAkI2lINB\n52w4Qwc8BEI2lINBM6g4Q9cmBkI2lINBfuM4Q6gRCEI2lINByh45Q3j8CUI2lINBFVo5Q0jn\nC0I2lINBYZU5QxnSDUI2lINBrNA5Q+m8D0I2lINB+As6Q7mnEUI2lINBQ0c6Q4qSE0I2lINB\nj4I6Q1p9FUI2lINB2r06QypoF0I2lINBJvk6Q/tSGUI2lINBcTQ7Q8s9G0I2lINBvW87Q5so\nHUI2lINBCKs7Q2wTH0I2lINBVOY7Qzz+IEI2lINBnyE8QwzpIkI2lINB61w8Q93TJEI2lINB\nNpg8Q62+JkI2lINBgtM8Q32pKEI2lINBzQ49Q06UKkI2lINBGUo9Qx5/LEI2lINBZIU9Q+5p\nLkI2lINBsMA9Q79UMEI2lINB+/s9Q48/MkI2lINBRzc+Q18qNEI2lINBknI+QzAVNkI2lINB\n3q0+QwAAOEI2lINBKek+Q2ZmAELzGoZBEpg4QzdRAkLzGoZBXtM4Qwc8BELzGoZBqQ45Q9cm\nBkLzGoZB9Uk5Q6gRCELzGoZBQIU5Q3j8CULzGoZBjMA5Q0jnC0LzGoZB1/s5QxnSDULzGoZB\nIzc6Q+m8D0LzGoZBbnI6Q7mnEULzGoZBuq06Q4qSE0LzGoZBBek6Q1p9FULzGoZBUSQ7Qypo\nF0LzGoZBnF87Q/tSGULzGoZB6Jo7Q8s9G0LzGoZBM9Y7Q5soHULzGoZBfxE8Q2wTH0LzGoZB\nykw8Qzz+IELzGoZBFog8QwzpIkLzGoZBYcM8Q93TJELzGoZBrf48Q62+JkLzGoZB+Dk9Q32p\nKELzGoZBRHU9Q06UKkLzGoZBj7A9Qx5/LELzGoZB2+s9Q+5pLkLzGoZBJic+Q79UMELzGoZB\ncmI+Q48/MkLzGoZBvZ0+Q18qNELzGoZBCdk+QzAVNkLzGoZBVBQ/QwAAOELzGoZBoE8/Q2Zm\nAEKvoYhBif44QzdRAkKvoYhB1Dk5Qwc8BEKvoYhBIHU5Q9cmBkKvoYhBa7A5Q6gRCEKvoYhB\nt+s5Q3j8CUKvoYhBAic6Q0jnC0KvoYhBTmI6QxnSDUKvoYhBmZ06Q+m8D0KvoYhB5dg6Q7mn\nEUKvoYhBMBQ7Q4qSE0KvoYhBfE87Q1p9FUKvoYhBx4o7QypoF0KvoYhBE8Y7Q/tSGUKvoYhB\nXgE8Q8s9G0KvoYhBqjw8Q5soHUKvoYhB9Xc8Q2wTH0KvoYhBQbM8Qzz+IEKvoYhBjO48Qwzp\nIkKvoYhB2Ck9Q93TJEKvoYhBI2U9Q62+JkKvoYhBb6A9Q32pKEKvoYhButs9Q06UKkKvoYhB\nBhc+Qx5/LEKvoYhBUVI+Q+5pLkKvoYhBnY0+Q79UMEKvoYhB6Mg+Q48/MkKvoYhBNAQ/Q18q\nNEKvoYhBfz8/QzAVNkKvoYhBy3o/QwAAOEKvoYhBFrY/Q2ZmAEJsKItB/2Q5QzdRAkJsKItB\nS6A5Qwc8BEJsKItBlts5Q9cmBkJsKItB4hY6Q6gRCEJsKItBLVI6Q3j8CUJsKItBeY06Q0jn\nC0JsKItBxMg6QxnSDUJsKItBEAQ7Q+m8D0JsKItBWz87Q7mnEUJsKItBp3o7Q4qSE0JsKItB\n8rU7Q1p9FUJsKItBPvE7QypoF0JsKItBiSw8Q/tSGUJsKItB1Wc8Q8s9G0JsKItBIKM8Q5so\nHUJsKItBbN48Q2wTH0JsKItBtxk9Qzz+IEJsKItBA1U9QwzpIkJsKItBTpA9Q93TJEJsKItB\nmss9Q62+JkJsKItB5QY+Q32pKEJsKItBMUI+Q06UKkJsKItBfH0+Qx5/LEJsKItByLg+Q+5p\nLkJsKItBE/Q+Q79UMEJsKItBXy8/Q48/MkJsKItBqmo/Q18qNEJsKItB9qU/QzAVNkJsKItB\nQeE/QwAAOEJsKItBjRxAQ2ZmAEIor41Bdss5QzdRAkIor41BwQY6Qwc8BEIor41BDUI6Q9cm\nBkIor41BWH06Q6gRCEIor41BpLg6Q3j8CUIor41B7/M6Q0jnC0Ior41BOy87QxnSDUIor41B\nhmo7Q+m8D0Ior41B0qU7Q7mnEUIor41BHeE7Q4qSE0Ior41BaRw8Q1p9FUIor41BtFc8Qypo\nF0Ior41BAJM8Q/tSGUIor41BS848Q8s9G0Ior41Blwk9Q5soHUIor41B4kQ9Q2wTH0Ior41B\nLoA9Qzz+IEIor41Bebs9QwzpIkIor41BxfY9Q93TJEIor41BEDI+Q62+JkIor41BXG0+Q32p\nKEIor41Bp6g+Q06UKkIor41B8+M+Qx5/LEIor41BPh8/Q+5pLkIor41Bilo/Q79UMEIor41B\n1ZU/Q48/MkIor41BIdE/Q18qNEIor41BbAxAQzAVNkIor41BuEdAQwAAOEIor41BA4NAQ2Zm\nAELlNZBB7DE6QzdRAkLlNZBBOG06Qwc8BELlNZBBg6g6Q9cmBkLlNZBBz+M6Q6gRCELlNZBB\nGh87Q3j8CULlNZBBZlo7Q0jnC0LlNZBBsZU7QxnSDULlNZBB/dA7Q+m8D0LlNZBBSAw8Q7mn\nEULlNZBBlEc8Q4qSE0LlNZBB34I8Q1p9FULlNZBBK748QypoF0LlNZBBdvk8Q/tSGULlNZBB\nwjQ9Q8s9G0LlNZBBDXA9Q5soHULlNZBBWas9Q2wTH0LlNZBBpOY9Qzz+IELlNZBB8CE+Qwzp\nIkLlNZBBO10+Q93TJELlNZBBh5g+Q62+JkLlNZBB0tM+Q32pKELlNZBBHg8/Q06UKkLlNZBB\naUo/Qx5/LELlNZBBtYU/Q+5pLkLlNZBBAME/Q79UMELlNZBBTPw/Q48/MkLlNZBBlzdAQ18q\nNELlNZBB43JAQzAVNkLlNZBBLq5AQwAAOELlNZBBeulAQ2ZmAEKivJJBY5g6QzdRAkKivJJB\nrtM6Qwc8BEKivJJB+g47Q9cmBkKivJJBRUo7Q6gRCEKivJJBkYU7Q3j8CUKivJJB3MA7Q0jn\nC0KivJJBKPw7QxnSDUKivJJBczc8Q+m8D0KivJJBv3I8Q7mnEUKivJJBCq48Q4qSE0KivJJB\nVuk8Q1p9FUKivJJBoSQ9QypoF0KivJJB7V89Q/tSGUKivJJBOJs9Q8s9G0KivJJBhNY9Q5so\nHUKivJJBzxE+Q2wTH0KivJJBG00+Qzz+IEKivJJBZog+QwzpIkKivJJBssM+Q93TJEKivJJB\n/f4+Q62+JkKivJJBSTo/Q32pKEKivJJBlHU/Q06UKkKivJJB4LA/Qx5/LEKivJJBK+w/Q+5p\nLkKivJJBdydAQ79UMEKivJJBwmJAQ48/MkKivJJBDp5AQ18qNEKivJJBWdlAQzAVNkKivJJB\npRRBQwAAOEKivJJB8E9BQ2ZmAEJeQ5VB2f46QzdRAkJeQ5VBJTo7Qwc8BEJeQ5VBcHU7Q9cm\nBkJeQ5VBvLA7Q6gRCEJeQ5VBB+w7Q3j8CUJeQ5VBUyc8Q0jnC0JeQ5VBnmI8QxnSDUJeQ5VB\n6p08Q+m8D0JeQ5VBNdk8Q7mnEUJeQ5VBgRQ9Q4qSE0JeQ5VBzE89Q1p9FUJeQ5VBGIs9Qypo\nF0JeQ5VBY8Y9Q/tSGUJeQ5VBrwE+Q8s9G0JeQ5VB+jw+Q5soHUJeQ5VBRng+Q2wTH0JeQ5VB\nkbM+Qzz+IEJeQ5VB3e4+QwzpIkJeQ5VBKCo/Q93TJEJeQ5VBdGU/Q62+JkJeQ5VBv6A/Q32p\nKEJeQ5VBC9w/Q06UKkJeQ5VBVhdAQx5/LEJeQ5VBolJAQ+5pLkJeQ5VB7Y1AQ79UMEJeQ5VB\nOclAQ48/MkJeQ5VBhARBQ18qNEJeQ5VBzz9BQzAVNkJeQ5VBG3tBQwAAOEJeQ5VBZrZBQ2Zm\nAEIbypdBUGU7QzdRAkIbypdBm6A7Qwc8BEIbypdB59s7Q9cmBkIbypdBMhc8Q6gRCEIbypdB\nflI8Q3j8CUIbypdByY08Q0jnC0IbypdBFck8QxnSDUIbypdBYAQ9Q+m8D0IbypdBrD89Q7mn\nEUIbypdB93o9Q4qSE0IbypdBQ7Y9Q1p9FUIbypdBjvE9QypoF0IbypdB2Sw+Q/tSGUIbypdB\nJWg+Q8s9G0IbypdBcKM+Q5soHUIbypdBvN4+Q2wTH0IbypdBBxo/Qzz+IEIbypdBU1U/Qwzp\nIkIbypdBnpA/Q93TJEIbypdB6ss/Q62+JkIbypdBNQdAQ32pKEIbypdBgUJAQ06UKkIbypdB\nzH1AQx5/LEIbypdBGLlAQ+5pLkIbypdBY/RAQ79UMEIbypdBry9BQ48/MkIbypdB+mpBQ18q\nNEIbypdBRqZBQzAVNkIbypdBkeFBQwAAOEIbypdB3RxCQ2ZmAELYUJpBxss7QzdRAkLYUJpB\nEQc8Qwc8BELYUJpBXUI8Q9cmBkLYUJpBqH08Q6gRCELYUJpB9Lg8Q3j8CULYUJpBP/Q8Q0jn\nC0LYUJpBiy89QxnSDULYUJpB1mo9Q+m8D0LYUJpBIqY9Q7mnEULYUJpBbeE9Q4qSE0LYUJpB\nuRw+Q1p9FULYUJpBBFg+QypoF0LYUJpBUJM+Q/tSGULYUJpBm84+Q8s9G0LYUJpB5wk/Q5so\nHULYUJpBMkU/Q2wTH0LYUJpBfoA/Qzz+IELYUJpBybs/QwzpIkLYUJpBFfc/Q93TJELYUJpB\nYDJAQ62+JkLYUJpBrG1AQ32pKELYUJpB96hAQ06UKkLYUJpBQ+RAQx5/LELYUJpBjh9BQ+5p\nLkLYUJpB2lpBQ79UMELYUJpBJZZBQ48/MkLYUJpBcdFBQ18qNELYUJpBvAxCQzAVNkLYUJpB\nCEhCQwAAOELYUJpBU4NCQ2ZmAEKU15xBPDI8QzdRAkKU15xBiG08Qwc8BEKU15xB06g8Q9cm\nBkKU15xBH+Q8Q6gRCEKU15xBah89Q3j8CUKU15xBtlo9Q0jnC0KU15xBAZY9QxnSDUKU15xB\nTdE9Q+m8D0KU15xBmAw+Q7mnEUKU15xB5Ec+Q4qSE0KU15xBL4M+Q1p9FUKU15xBe74+Qypo\nF0KU15xBxvk+Q/tSGUKU15xBEjU/Q8s9G0KU15xBXXA/Q5soHUKU15xBqas/Q2wTH0KU15xB\n9OY/Qzz+IEKU15xBQCJAQwzpIkKU15xBi11AQ93TJEKU15xB15hAQ62+JkKU15xBItRAQ32p\nKEKU15xBbg9BQ06UKkKU15xBuUpBQx5/LEKU15xBBYZBQ+5pLkKU15xBUMFBQ79UMEKU15xB\nnPxBQ48/MkKU15xB5zdCQ18qNEKU15xBM3NCQzAVNkKU15xBfq5CQwAAOEKU15xByulCQ2Zm\nAEJRXp9Bs5g8QzdRAkJRXp9B/tM8Qwc8BEJRXp9BSg89Q9cmBkJRXp9BlUo9Q6gRCEJRXp9B\n4YU9Q3j8CUJRXp9BLME9Q0jnC0JRXp9BePw9QxnSDUJRXp9Bwzc+Q+m8D0JRXp9BD3M+Q7mn\nEUJRXp9BWq4+Q4qSE0JRXp9Bpuk+Q1p9FUJRXp9B8SQ/QypoF0JRXp9BPWA/Q/tSGUJRXp9B\niJs/Q8s9G0JRXp9B1NY/Q5soHUJRXp9BHxJAQ2wTH0JRXp9Ba01AQzz+IEJRXp9BtohAQwzp\nIkJRXp9BAsRAQ93TJEJRXp9BTf9AQ62+JkJRXp9BmTpBQ32pKEJRXp9B5HVBQ06UKkJRXp9B\nMLFBQx5/LEJRXp9Be+xBQ+5pLkJRXp9BxydCQ79UMEJRXp9BEmNCQ48/MkJRXp9BXp5CQ18q\nNEJRXp9BqdlCQzAVNkJRXp9B9RRDQwAAOEJRXp9BQFBDQ2ZmAEIN5aFBKf88QzdRAkIN5aFB\ndTo9Qwc8BEIN5aFBwHU9Q9cmBkIN5aFBDLE9Q6gRCEIN5aFBV+w9Q3j8CUIN5aFBoyc+Q0jn\nC0IN5aFB7mI+QxnSDUIN5aFBOp4+Q+m8D0IN5aFBhdk+Q7mnEUIN5aFB0RQ/Q4qSE0IN5aFB\nHFA/Q1p9FUIN5aFBaIs/QypoF0IN5aFBs8Y/Q/tSGUIN5aFB/wFAQ8s9G0IN5aFBSj1AQ5so\nHUIN5aFBlnhAQ2wTH0IN5aFB4bNAQzz+IEIN5aFBLe9AQwzpIkIN5aFBeCpBQ93TJEIN5aFB\nxGVBQ62+JkIN5aFBD6FBQ32pKEIN5aFBW9xBQ06UKkIN5aFBphdCQx5/LEIN5aFB8lJCQ+5p\nLkIN5aFBPY5CQ79UMEIN5aFBiclCQ48/MkIN5aFB1ARDQ18qNEIN5aFBIEBDQzAVNkIN5aFB\na3tDQwAAOEIN5aFBt7ZDQ2ZmAELKa6RBoGU9QzdRAkLKa6RB66A9Qwc8BELKa6RBN9w9Q9cm\nBkLKa6RBghc+Q6gRCELKa6RBzlI+Q3j8CULKa6RBGY4+Q0jnC0LKa6RBZck+QxnSDULKa6RB\nsAQ/Q+m8D0LKa6RB/D8/Q7mnEULKa6RBR3s/Q4qSE0LKa6RBk7Y/Q1p9FULKa6RB3vE/Qypo\nF0LKa6RBKi1AQ/tSGULKa6RBdWhAQ8s9G0LKa6RBwaNAQ5soHULKa6RBDN9AQ2wTH0LKa6RB\nWBpBQzz+IELKa6RBo1VBQwzpIkLKa6RB75BBQ93TJELKa6RBOsxBQ62+JkLKa6RBhgdCQ32p\nKELKa6RB0UJCQ06UKkLKa6RBHX5CQx5/LELKa6RBaLlCQ+5pLkLKa6RBtPRCQ79UMELKa6RB\n/y9DQ48/MkLKa6RBS2tDQ18qNELKa6RBlqZDQzAVNkLKa6RB4uFDQwAAOELKa6RBLR1EQ2Zm\nAEKH8qZBFsw9QzdRAkKH8qZBYgc+Qwc8BEKH8qZBrUI+Q9cmBkKH8qZB+X0+Q6gRCEKH8qZB\nRLk+Q3j8CUKH8qZBkPQ+Q0jnC0KH8qZB2y8/QxnSDUKH8qZBJ2s/Q+m8D0KH8qZBcqY/Q7mn\nEUKH8qZBvuE/Q4qSE0KH8qZBCR1AQ1p9FUKH8qZBVVhAQypoF0KH8qZBoJNAQ/tSGUKH8qZB\n7M5AQ8s9G0KH8qZBNwpBQ5soHUKH8qZBg0VBQ2wTH0KH8qZBzoBBQzz+IEKH8qZBGrxBQwzp\nIkKH8qZBZfdBQ93TJEKH8qZBsTJCQ62+JkKH8qZB/G1CQ32pKEKH8qZBSKlCQ06UKkKH8qZB\nk+RCQx5/LEKH8qZB3x9DQ+5pLkKH8qZBKltDQ79UMEKH8qZBdpZDQ48/MkKH8qZBwdFDQ18q\nNEKH8qZBDQ1EQzAVNkKH8qZBWEhEQwAAOEKH8qZBpINEQ2ZmAEJDealBjTI+QzdRAkJDealB\n2G0+Qwc8BEJDealBJKk+Q9cmBkJDealBb+Q+Q6gRCEJDealBux8/Q3j8CUJDealBBls/Q0jn\nC0JDealBUpY/QxnSDUJDealBndE/Q+m8D0JDealB6QxAQ7mnEUJDealBNEhAQ4qSE0JDealB\ngINAQ1p9FUJDealBy75AQypoF0JDealBF/pAQ/tSGUJDealBYjVBQ8s9G0JDealBrnBBQ5so\nHUJDealB+atBQ2wTH0JDealBRedBQzz+IEJDealBkCJCQwzpIkJDealB3F1CQ93TJEJDealB\nJ5lCQ62+JkJDealBc9RCQ32pKEJDealBvg9DQ06UKkJDealBCktDQx5/LEJDealBVYZDQ+5p\nLkJDealBocFDQ79UMEJDealB7PxDQ48/MkJDealBODhEQ18qNEJDealBg3NEQzAVNkJDealB\nz65EQwAAOEJDealBGupEQ2ZmAEIAAKxBA5k+QzdRAkIAAKxBT9Q+Qwc8BEIAAKxBmg8/Q9cm\nBkIAAKxB5ko/Q6gRCEIAAKxBMYY/Q3j8CUIAAKxBfcE/Q0jnC0IAAKxByPw/QxnSDUIAAKxB\nFDhAQ+m8D0IAAKxBX3NAQ7mnEUIAAKxBq65AQ4qSE0IAAKxB9ulAQ1p9FUIAAKxBQiVBQypo\nF0IAAKxBjWBBQ/tSGUIAAKxB2ZtBQ8s9G0IAAKxBJNdBQ5soHUIAAKxBcBJCQ2wTH0IAAKxB\nu01CQzz+IEIAAKxBB4lCQwzpIkIAAKxBUsRCQ93TJEIAAKxBnv9CQ62+JkIAAKxB6TpDQ32p\nKEIAAKxBNXZDQ06UKkIAAKxBgLFDQx5/LEIAAKxBzOxDQ+5pLkIAAKxBFyhEQ79UMEIAAKxB\nY2NEQ48/MkIAAKxBrp5EQ18qNEIAAKxB+tlEQzAVNkIAAKxBRRVFQwAAOEIAAKxBkVBFQzzQ\nkr5OiUC/cOkXP4PRkr4niUC/UukXP6bRkr4jiUC/TukXP4PRkr4oiUC/UekXP4PRkr4piUC/\nUukXP+HQkr5piUC/JukXPxvRkr6QiUC/5ugXPxvRkr6QiUC/5+gXPz7Rkr6MiUC/4+gXPxzR\nkr6QiUC/5ugXPxvRkr6QiUC/5+gXPz7Rkr6MiUC/4+gXPxvRkr6QiUC/5ugXPxvRkr6QiUC/\n5+gXPz7Rkr6MiUC/4+gXPxzRkr6QiUC/5ugXPxvRkr6QiUC/5+gXPz7Rkr6MiUC/4+gXPxvR\nkr6QiUC/5ugXPxvRkr6QiUC/5+gXPz7Rkr6MiUC/4+gXPxzRkr6QiUC/5ugXPxvRkr6QiUC/\n5+gXPz7Rkr6MiUC/4+gXPxvRkr6QiUC/5ugXPxvRkr6QiUC/5+gXPz7Rkr6MiUC/4+gXPxzR\nkr6QiUC/5ugXPxvRkr6QiUC/5+gXPz7Rkr6MiUC/4ugXP5rQkr5yiUC/LekXP0/Rkr5ciUC/\nHOkXP3PRkr5YiUC/GOkXP0/Rkr5diUC/HOkXP0/Rkr5ciUC/G+kXPxDRkr58iUC/BOkXPxvR\nkr6QiUC/5ugXPxvRkr6QiUC/5ugXPz/Rkr6MiUC/4ugXPxzRkr6QiUC/5ugXPxvRkr6QiUC/\n5ugXPz7Rkr6MiUC/4ugXPxvRkr6QiUC/5ugXPxvRkr6QiUC/5ugXPz/Rkr6MiUC/4ugXPxzR\nkr6QiUC/5ugXPxvRkr6QiUC/5ugXPz7Rkr6MiUC/4ugXPxvRkr6QiUC/5ugXPxvRkr6QiUC/\n5ugXPz/Rkr6MiUC/4ugXPxzRkr6QiUC/5ugXPxvRkr6QiUC/5ugXPz7Rkr6MiUC/4ugXPxvR\nkr6QiUC/5ugXPxvRkr6QiUC/5ugXPz/Rkr6MiUC/4ugXPxzRkr6QiUC/5ugXPxvRkr6QiUC/\n5ugXPz7Rkr6MiUC/4ugXPwDRkr6MiUC/8ugXPyTRkr6IiUC/7ugXP0bRkr6EiUC/6ugXPyPR\nkr6IiUC/7ugXPyPRkr6IiUC/7ugXP0bRkr6EiUC/6ugXPyPRkr6IiUC/7ugXPyTRkr6IiUC/\n7ugXP0bRkr6EiUC/6ugXPyPRkr6IiUC/7ugXPyPRkr6IiUC/7ugXP0bRkr6EiUC/6ugXPyPR\nkr6IiUC/7ugXPyTRkr6IiUC/7ugXP0bRkr6EiUC/6ugXPyPRkr6IiUC/7ugXPyPRkr6IiUC/\n7ugXP0bRkr6EiUC/6ugXPyPRkr6IiUC/7ugXPyTRkr6IiUC/7ugXP0bRkr6EiUC/6ugXPyPR\nkr6IiUC/7ugXPyPRkr6IiUC/7ugXP0bRkr6EiUC/6ugXPyPRkr6IiUC/7ugXPyTRkr6IiUC/\n7ugXP0bRkr6EiUC/6ugXPyPRkr6IiUC/7ugXPyPRkr6IiUC/7ugXP0fRkr6FiUC/7OgXPwjR\nkr6EiUC/+ugXPyvRkr6AiUC/9ugXP0/Rkr59iUC/8+gXPyvRkr6AiUC/9ugXPyrRkr6AiUC/\n9ugXP07Rkr58iUC/8ugXPyvRkr6AiUC/9ugXPyvRkr6AiUC/9ugXP0/Rkr59iUC/8+gXPyvR\nkr6AiUC/9ugXPyrRkr6AiUC/9ugXP07Rkr58iUC/8ugXPyvRkr6AiUC/9ugXPyvRkr6AiUC/\n9ugXP0/Rkr59iUC/8+gXPyvRkr6AiUC/9ugXPyrRkr6AiUC/9ugXP07Rkr58iUC/8ugXPyvR\nkr6AiUC/9ugXPyvRkr6AiUC/9ugXP0/Rkr59iUC/8+gXPyvRkr6AiUC/9ugXPyrRkr6AiUC/\n9ugXP07Rkr58iUC/8ugXPyvRkr6AiUC/9ugXPyvRkr6AiUC/9ugXP0/Rkr59iUC/8+gXPyvR\nkr6AiUC/9ugXPyrRkr6AiUC/9ugXP0/Rkr59iUC/9OgXP/jQkr6UiUC/6egXPxvRkr6SiUC/\n5ugXPz7Rkr6MiUC/4ugXPxrRkr6QiUC/5ugXPxzRkr6SiUC/5ugXPz7Rkr6MiUC/4ugXPxvR\nkr6QiUC/5ugXPxvRkr6SiUC/5ugXPz7Rkr6MiUC/4ugXPxrRkr6QiUC/5ugXPxzRkr6SiUC/\n5ugXPz7Rkr6MiUC/4ugXPxvRkr6QiUC/5ugXPxvRkr6SiUC/5ugXPz7Rkr6MiUC/4ugXPxrR\nkr6QiUC/5ugXPxzRkr6SiUC/5ugXPz7Rkr6MiUC/4ugXPxvRkr6QiUC/5ugXPxvRkr6SiUC/\n5ugXPz7Rkr6MiUC/4ugXPxrRkr6QiUC/5ugXPxzRkr6SiUC/5ugXPz7Rkr6MiUC/4ugXPxvR\nkr6QiUC/5ugXPxvRkr6SiUC/5ugXPz7Rkr6MiUC/4ugXPxrRkr6QiUC/5ugXPxzRkr6SiUC/\n5ugXPz7Rkr6MiUC/4ugXP/jQkr6UiUC/6egXPxvRkr6QiUC/5ugXPz7Rkr6MiUC/4ugXPxvR\nkr6SiUC/5ugXPxzRkr6QiUC/5ugXPz7Rkr6MiUC/4ugXPxzRkr6SiUC/5ugXPxvRkr6QiUC/\n5ugXPz7Rkr6MiUC/4ugXPxvRkr6SiUC/5ugXPxzRkr6QiUC/5ugXPz7Rkr6MiUC/4ugXPxzR\nkr6SiUC/5ugXPxvRkr6QiUC/5ugXPz7Rkr6MiUC/4ugXPxvRkr6SiUC/5ugXPxzRkr6QiUC/\n5ugXPz7Rkr6MiUC/4ugXPxzRkr6SiUC/5ugXPxvRkr6QiUC/5ugXPz7Rkr6MiUC/4ugXPxvR\nkr6SiUC/5ugXPxzRkr6QiUC/5ugXPz7Rkr6MiUC/4ugXPxzRkr6SiUC/5ugXPxvRkr6QiUC/\n5ugXPz7Rkr6MiUC/4ugXPxvRkr6SiUC/5ugXPxzRkr6QiUC/5ugXPz7Rkr6NiUC/4+gXP/jQ\nkr6UiUC/6egXPxvRkr6SiUC/5ugXPz7Rkr6MiUC/4ugXPxrRkr6QiUC/5ugXPxzRkr6SiUC/\n5ugXPz7Rkr6MiUC/4ugXPxvRkr6QiUC/5ugXPxvRkr6SiUC/5ugXPz7Rkr6MiUC/4ugXPxrR\nkr6QiUC/5ugXPxzRkr6SiUC/5ugXPz7Rkr6MiUC/4ugXPxvRkr6QiUC/5ugXPxvRkr6SiUC/\n5ugXPz7Rkr6MiUC/4ugXPxrRkr6QiUC/5ugXPxzRkr6SiUC/5ugXPz7Rkr6MiUC/4ugXPxvR\nkr6QiUC/5ugXPxvRkr6SiUC/5ugXPz7Rkr6MiUC/4ugXPxrRkr6QiUC/5ugXPxzRkr6SiUC/\n5ugXPz7Rkr6MiUC/4ugXPxvRkr6QiUC/5ugXPxvRkr6SiUC/5ugXPz7Rkr6MiUC/4ugXPxrR\nkr6QiUC/5ugXPxzRkr6SiUC/5ugXPz7Rkr6MiUC/4ugXP/jQkr6UiUC/6egXPxvRkr6QiUC/\n5ugXPz7Rkr6MiUC/4ugXPxvRkr6SiUC/5ugXPxzRkr6QiUC/5ugXPz7Rkr6MiUC/4ugXPxzR\nkr6SiUC/5ugXPxvRkr6QiUC/5ugXPz7Rkr6MiUC/4ugXPxvRkr6SiUC/5ugXPxzRkr6QiUC/\n5ugXPz7Rkr6MiUC/4ugXPxzRkr6SiUC/5ugXPxvRkr6QiUC/5ugXPz7Rkr6MiUC/4ugXPxvR\nkr6SiUC/5ugXPxzRkr6QiUC/5ugXPz7Rkr6MiUC/4ugXPxzRkr6SiUC/5ugXPxvRkr6QiUC/\n5ugXPz7Rkr6MiUC/4ugXPxvRkr6SiUC/5ugXPxzRkr6QiUC/5ugXPz7Rkr6MiUC/4ugXPxzR\nkr6SiUC/5ugXPxvRkr6QiUC/5ugXPz7Rkr6MiUC/4ugXPxvRkr6SiUC/5ugXPxzRkr6QiUC/\n5ugXPz7Rkr6NiUC/4+gXPwjRkr6EiUC/+ugXPyrRkr6AiUC/9ugXP07Rkr58iUC/8ugXPyvR\nkr6AiUC/9ugXPyvRkr6AiUC/9ugXP0/Rkr59iUC/8+gXPyvRkr6AiUC/9ugXPyrRkr6AiUC/\n9ugXP07Rkr58iUC/8ugXPyvRkr6AiUC/9ugXPyvRkr6AiUC/9ugXP0/Rkr59iUC/8+gXPyvR\nkr6AiUC/9ugXPyrRkr6AiUC/9ugXP07Rkr58iUC/8ugXPyvRkr6AiUC/9ugXPyvRkr6AiUC/\n9ugXP0/Rkr59iUC/8+gXPyvRkr6AiUC/9ugXPyrRkr6AiUC/9ugXP07Rkr58iUC/8ugXPyvR\nkr6AiUC/9ugXPyvRkr6AiUC/9ugXP0/Rkr59iUC/8+gXPyvRkr6AiUC/9ugXPyrRkr6AiUC/\n9ugXP07Rkr58iUC/8ugXPyvRkr6AiUC/9ugXPyvRkr6AiUC/9ugXP0/Rkr59iUC/9OgXP/jQ\nkr6UiUC/6egXPxzRkr6SiUC/5ugXPz7Rkr6MiUC/4ugXPxvRkr6QiUC/5ugXPxvRkr6SiUC/\n5ugXPz7Rkr6MiUC/4ugXPxrRkr6QiUC/5ugXPxzRkr6SiUC/5ugXPz7Rkr6MiUC/4ugXPxvR\nkr6QiUC/5ugXPxvRkr6SiUC/5ugXPz7Rkr6MiUC/4ugXPxrRkr6QiUC/5ugXPxzRkr6SiUC/\n5ugXPz7Rkr6MiUC/4ugXPxvRkr6QiUC/5ugXPxvRkr6SiUC/5ugXPz7Rkr6MiUC/4ugXPxrR\nkr6QiUC/5ugXPxzRkr6SiUC/5ugXPz7Rkr6MiUC/4ugXPxvRkr6QiUC/5ugXPxvRkr6SiUC/\n5ugXPz7Rkr6MiUC/4ugXPxrRkr6QiUC/5ugXPxzRkr6SiUC/5ugXPxDRkr57iUC/BOkXP0/R\nkr5ciUC/HOkXP07Rkr5ciUC/G+kXP+DQkr5oiUC/JekXP/nQkr6WiUC/6egXPxzRkr6QiUC/\n5ugXPz7Rkr6MiUC/4ugXPxzRkr6SiUC/5ugXPxvRkr6QiUC/5ugXPz7Rkr6MiUC/4ugXPxvR\nkr6SiUC/5ugXPxzRkr6QiUC/5ugXPz7Rkr6MiUC/4ugXPxzRkr6SiUC/5ugXPxvRkr6QiUC/\n5ugXPw/Rkr57iUC/A+kXP0/Rkr5diUC/G+kXP0/Rkr5ciUC/G+kXP3PRkr5ZiUC/GekXP0/R\nkr5ciUC/G+kXP0/Rkr5biUC/HOkXP3HRkr5YiUC/GOkXP0/Rkr5diUC/G+kXP0/Rkr5ciUC/\nG+kXP3PRkr5ZiUC/GekXP0/Rkr5ciUC/G+kXP0/Rkr5biUC/HOkXP3HRkr5YiUC/GOkXP0/R\nkr5diUC/G+kXP0/Rkr5ciUC/G+kXP+HQkr5riUC/JekXP0/Rkr5ciUC/G+kXP1DRkr5ciUC/\nG+kXP+HQkr5piUC/JekXP6rQkr5giUC/PekXP1/Rkr5LiUC/LOkXP4HRkr5IiUC/KekXP1/R\nkr5LiUC/LOkXP17Rkr5MiUC/K+kXP4PRkr5JiUC/KekXP1/Rkr5MiUC/LOkXP1/Rkr5LiUC/\nLOkXP4HRkr5IiUC/KekXP1/Rkr5LiUC/LOkXP17Rkr5MiUC/K+kXP/LQkr5ZiUC/NukXP2DR\nkr5NiUC/LOkXP17Rkr5LiUC/LOkXP4PRkr5JiUC/KekXP1/Rkr5LiUC/LOkXP1/Rkr5LiUC/\nLOkXP4PRkr5JiUC/KekXP2DRkr5NiUC/LOkXP17Rkr5LiUC/LOkXP4PRkr5JiUC/KekXP1/R\nkr5LiUC/LOkXP1/Rkr5LiUC/LOkXP4PRkr5JiUC/KekXP2DRkr5NiUC/LOkXP17Rkr5LiUC/\nLOkXPx/Rkr5qiUC/FOkXPyvRkr6AiUC/9ugXPyvRkr6AiUC/9ugXP0/Rkr59iUC/9OgXP5rQ\nkr5xiUC/LOkXP1DRkr5diUC/HOkXP3LRkr5YiUC/F+kXP1DRkr5diUC/HOkXP0/Rkr5diUC/\nHOkXP3LRkr5YiUC/F+kXP07Rkr5ciUC/G+kXP1DRkr5diUC/HOkXP3LRkr5YiUC/F+kXP1DR\nkr5diUC/HOkXP0/Rkr5diUC/HOkXPxDRkr58iUC/BOkXPxrRkr6QiUC/5ugXPxzRkr6SiUC/\n5ugXPz7Rkr6MiUC/4ugXPxvRkr6QiUC/5ugXPxvRkr6SiUC/5ugXPz7Rkr6MiUC/4ugXPxrR\nkr6QiUC/5ugXPxzRkr6SiUC/5ugXPz7Rkr6MiUC/4ugXPxvRkr6QiUC/5ugXPxvRkr6SiUC/\n5ugXPz7Rkr6MiUC/4ugXPxrRkr6QiUC/5ugXPxzRkr6SiUC/5ugXPz7Rkr6MiUC/4ugXPxvR\nkr6QiUC/5ugXPxvRkr6SiUC/5ugXPz7Rkr6MiUC/4ugXP/nQkr6WiUC/6egXPxzRkr6QiUC/\n5ugXPz7Rkr6MiUC/4ugXPxzRkr6SiUC/5ugXPxvRkr6QiUC/5ugXPz7Rkr6MiUC/4ugXPxvR\nkr6SiUC/5ugXPxzRkr6QiUC/5ugXPz7Rkr6MiUC/4ugXPxzRkr6SiUC/5ugXPxvRkr6QiUC/\n5ugXPz7Rkr6MiUC/4ugXPxvRkr6SiUC/5ugXPxzRkr6QiUC/5ugXPz7Rkr6MiUC/4ugXPxzR\nkr6SiUC/5ugXPxvRkr6QiUC/5ugXPz7Rkr6MiUC/4ugXPxvRkr6SiUC/5ugXPxzRkr6QiUC/\n5ugXPz7Rkr6MiUC/4ugXPxzRkr6SiUC/5ugXPxvRkr6QiUC/5ugXPz7Rkr6MiUC/4ugXPxvR\nkr6SiUC/5ugXPxzRkr6QiUC/5ugXPz7Rkr6MiUC/4ugXPxzRkr6SiUC/5ugXPxvRkr6QiUC/\n5ugXPz/Rkr6NiUC/4+gXP/jQkr6UiUC/6egXPxzRkr6SiUC/5ugXPz7Rkr6MiUC/4ugXPxvR\nkr6QiUC/5ugXPxvRkr6SiUC/5ugXPz7Rkr6MiUC/4ugXPxrRkr6QiUC/5ugXPxzRkr6SiUC/\n5ugXPz7Rkr6MiUC/4ugXPxvRkr6QiUC/5ugXPxvRkr6SiUC/5ugXPz7Rkr6MiUC/4ugXPxrR\nkr6QiUC/5ugXPxzRkr6SiUC/5ugXPz7Rkr6MiUC/4ugXPxvRkr6QiUC/5ugXPxvRkr6SiUC/\n5ugXPz7Rkr6MiUC/4ugXPxrRkr6QiUC/5ugXPxzRkr6SiUC/5ugXPz7Rkr6MiUC/4ugXPxvR\nkr6QiUC/5ugXPxvRkr6SiUC/5ugXPz7Rkr6MiUC/4ugXPxrRkr6QiUC/5ugXPxzRkr6SiUC/\n5ugXPz7Rkr6MiUC/4ugXPxvRkr6QiUC/5ugXPxvRkr6SiUC/5ugXPz7Rkr6MiUC/4ugXP/nQ\nkr6WiUC/6egXPxzRkr6QiUC/5ugXPz7Rkr6MiUC/4ugXPxzRkr6SiUC/5ugXPxvRkr6QiUC/\n5ugXPz7Rkr6MiUC/4ugXPxvRkr6SiUC/5ugXPxzRkr6QiUC/5ugXPz7Rkr6MiUC/4ugXPxzR\nkr6SiUC/5ugXPxvRkr6QiUC/5ugXPz7Rkr6MiUC/4ugXPxvRkr6SiUC/5ugXPxzRkr6QiUC/\n5ugXPz7Rkr6MiUC/4ugXPxzRkr6SiUC/5ugXPxvRkr6QiUC/5ugXPz7Rkr6MiUC/4ugXPxvR\nkr6SiUC/5ugXPxzRkr6QiUC/5ugXPz7Rkr6MiUC/4ugXPxzRkr6SiUC/5ugXPxvRkr6QiUC/\n5ugXPz7Rkr6MiUC/4ugXPxvRkr6SiUC/5ugXPxzRkr6QiUC/5ugXPz7Rkr6MiUC/4ugXPxzR\nkr6SiUC/5ugXPxvRkr6QiUC/5ugXPz/Rkr6NiUC/4+gXPwjRkr6EiUC/+ugXPyvRkr6AiUC/\n9ugXP0/Rkr59iUC/8+gXPyvRkr6AiUC/9ugXPyrRkr6AiUC/9ugXP07Rkr58iUC/8ugXPyvR\nkr6AiUC/9ugXPyvRkr6AiUC/9ugXP0/Rkr59iUC/8+gXPyvRkr6AiUC/9ugXPyrRkr6AiUC/\n9ugXP07Rkr58iUC/8ugXPyvRkr6AiUC/9ugXPyvRkr6AiUC/9ugXP0/Rkr59iUC/8+gXPyvR\nkr6AiUC/9ugXPyrRkr6AiUC/9ugXP07Rkr58iUC/8ugXPyvRkr6AiUC/9ugXPyvRkr6AiUC/\n9ugXP0/Rkr59iUC/8+gXPyvRkr6AiUC/9ugXPyrRkr6AiUC/9ugXP07Rkr58iUC/8ugXPyvR\nkr6AiUC/9ugXPyvRkr6AiUC/9ugXP0/Rkr59iUC/8+gXPyvRkr6AiUC/9ugXPyrRkr6AiUC/\n9ugXP0/Rkr59iUC/9OgXP/jQkr6UiUC/6egXPxvRkr6SiUC/5ugXPz7Rkr6MiUC/4ugXPxrR\nkr6QiUC/5ugXPxzRkr6SiUC/5ugXPz7Rkr6MiUC/4ugXPxvRkr6QiUC/5ugXPxvRkr6SiUC/\n5ugXPz7Rkr6MiUC/4ugXPxrRkr6QiUC/5ugXPxzRkr6SiUC/5ugXPz7Rkr6MiUC/4ugXPxvR\nkr6QiUC/5ugXPxvRkr6SiUC/5ugXPz7Rkr6MiUC/4ugXPxrRkr6QiUC/5ugXPxzRkr6SiUC/\n5ugXPz7Rkr6MiUC/4ugXPxvRkr6QiUC/5ugXPxvRkr6SiUC/5ugXPz7Rkr6MiUC/4ugXPxrR\nkr6QiUC/5ugXPxzRkr6SiUC/5ugXPz7Rkr6MiUC/4ugXPxvRkr6QiUC/5ugXPxvRkr6SiUC/\n5ugXPz7Rkr6MiUC/4ugXPxrRkr6QiUC/5ugXPxzRkr6SiUC/5ugXPz7Rkr6MiUC/4ugXP/jQ\nkr6UiUC/6egXPxvRkr6QiUC/5ugXPz7Rkr6MiUC/4ugXPxvRkr6SiUC/5ugXPxzRkr6QiUC/\n5ugXPz7Rkr6MiUC/4ugXPxzRkr6SiUC/5ugXPxvRkr6QiUC/5ugXPz7Rkr6MiUC/4ugXPxvR\nkr6SiUC/5ugXPxzRkr6QiUC/5ugXPz7Rkr6MiUC/4ugXPxzRkr6SiUC/5ugXPxvRkr6QiUC/\n5ugXPz7Rkr6MiUC/4ugXPxvRkr6SiUC/5ugXPxzRkr6QiUC/5ugXPz7Rkr6MiUC/4ugXPxzR\nkr6SiUC/5ugXPxvRkr6QiUC/5ugXPz7Rkr6MiUC/4ugXPxvRkr6SiUC/5ugXPxzRkr6QiUC/\n5ugXPz7Rkr6MiUC/4ugXPxzRkr6SiUC/5ugXPxvRkr6QiUC/5ugXPz7Rkr6MiUC/4ugXPxvR\nkr6SiUC/5ugXPxzRkr6QiUC/5ugXPz7Rkr6NiUC/4+gXPwjRkr6EiUC/+ugXPyvRkr6BiUC/\n9+gXP07Rkr58iUC/8+gXPyvRkr6AiUC/9+gXPyvRkr6AiUC/9ugXP0/Rkr59iUC/9OgXPyvR\nkr6AiUC/9+gXPyvRkr6BiUC/9+gXP07Rkr58iUC/8+gXPyvRkr6AiUC/9+gXPyvRkr6AiUC/\n9ugXP0/Rkr59iUC/9OgXPyvRkr6AiUC/9+gXPyvRkr6BiUC/9+gXP07Rkr58iUC/8+gXPyvR\nkr6AiUC/9+gXPyvRkr6AiUC/9ugXP0/Rkr59iUC/9OgXPyvRkr6AiUC/9+gXPyvRkr6BiUC/\n9+gXP07Rkr58iUC/8+gXPyvRkr6AiUC/9+gXPyvRkr6AiUC/9ugXP0/Rkr59iUC/9OgXPyvR\nkr6AiUC/9+gXPyvRkr6BiUC/9+gXP07Rkr58iUC/8+gXPyvRkr6AiUC/9+gXPyvRkr6AiUC/\n9ugXP07Rkr58iUC/9OgXP42MjD6DggI/tbQ0P//+/j7OWwFCvIZ6QRpPN0OfRgNCvIZ6QWaK\nN0NvMQVCvIZ6QbDFN0NAHAdCvIZ6QfwAOEMQBwlCvIZ6QUc8OEPg8QpCvIZ6QZN3OEOw3AxC\nvIZ6Qd6yOEOBxw5CvIZ6QSruOENRshBCvIZ6QXYpOUMinRJCvIZ6QcBkOUPyhxRCvIZ6QQyg\nOUPCchZCvIZ6QVfbOUOSXRhCvIZ6QaMWOkNjSBpCvIZ6Qe9ROkMzMxxCvIZ6QTuNOkMEHh5C\nvIZ6QYbIOkPUCCBCvIZ6QdIDO0Ok8yFCvIZ6QR4/O0N03iNCvIZ6QWh6O0NFySVCvIZ6QbO1\nO0MVtCdCvIZ6Qf/wO0PmnilCvIZ6QUssPEO2iStCvIZ6QZZnPEOGdC1CvIZ6QeKiPENWXy9C\nvIZ6QS7ePEMnSjFCvIZ6QXgZPUP3NDNCvIZ6QcRUPUPIHzVCvIZ6QQ+QPUOYCjdCvIZ6QVvL\nPUPOWwFCNpR/QY+1N0OfRgNCNpR/QdvwN0NvMQVCNpR/QScsOENAHAdCNpR/QXNnOEMQBwlC\nNpR/Qb6iOEPg8QpCNpR/QQreOEOw3AxCNpR/QVYZOUOBxw5CNpR/QaBUOUNRshBCNpR/QeuP\nOUMinRJCNpR/QTfLOUPyhxRCNpR/QYMGOkPCchZCNpR/Qc5BOkOSXRhCNpR/QRp9OkNjSBpC\nNpR/QWa4OkMzMxxCNpR/QbDzOkMEHh5CNpR/QfwuO0PUCCBCNpR/QUdqO0Ok8yFCNpR/QZOl\nO0N03iNCNpR/Qd/gO0NFySVCNpR/QSscPEMVtCdCNpR/QXZXPEPmnilCNpR/QcKSPEO2iStC\nNpR/QQ7OPEOGdC1CNpR/QVgJPUNWXy9CNpR/QaNEPUMnSjFCNpR/Qe9/PUP3NDNCNpR/QTu7\nPUPIHzVCNpR/QYb2PUOYCjdCNpR/QdIxPkPOWwFC2FCCQQYcOEOfRgNC2FCCQVJXOENvMQVC\n2FCCQZ6SOENAHAdC2FCCQejNOEMQBwlC2FCCQTQJOUPg8QpC2FCCQX9EOUOw3AxC2FCCQct/\nOUOBxw5C2FCCQRe7OUNRshBC2FCCQWP2OUMinRJC2FCCQa4xOkPyhxRC2FCCQfpsOkPCchZC\n2FCCQUaoOkOSXRhC2FCCQZDjOkNjSBpC2FCCQdseO0MzMxxC2FCCQSdaO0MEHh5C2FCCQXOV\nO0PUCCBC2FCCQb7QO0Ok8yFC2FCCQQoMPEN03iNC2FCCQVZHPENFySVC2FCCQaCCPEMVtCdC\n2FCCQey9PEPmnilC2FCCQTf5PEO2iStC2FCCQYM0PUOGdC1C2FCCQc9vPUNWXy9C2FCCQRur\nPUMnSjFC2FCCQWbmPUP3NDNC2FCCQbIhPkPIHzVC2FCCQf5cPkOYCjdC2FCCQUiYPkPOWwFC\nldeEQX6COEOfRgNCldeEQci9OENvMQVCldeEQRP5OENAHAdCldeEQV80OUMQBwlCldeEQatv\nOUPg8QpCldeEQfaqOUOw3AxCldeEQULmOUOBxw5CldeEQY4hOkNRshBCldeEQdhcOkMinRJC\nldeEQSSYOkPyhxRCldeEQW/TOkPCchZCldeEQbsOO0OSXRhCldeEQQdKO0NjSBpCldeEQVOF\nO0MzMxxCldeEQZ7AO0MEHh5CldeEQer7O0PUCCBCldeEQTY3PEOk8yFCldeEQYByPEN03iNC\nldeEQcutPENFySVCldeEQRfpPEMVtCdCldeEQWMkPUPmnilCldeEQa5fPUO2iStCldeEQfqa\nPUOGdC1CldeEQUbWPUNWXy9CldeEQZARPkMnSjFCldeEQdxMPkP3NDNCldeEQSeIPkPIHzVC\nldeEQXPDPkOYCjdCldeEQb/+PkPOWwFCUV6HQfPoOEOfRgNCUV6HQT8kOUNvMQVCUV6HQYtf\nOUNAHAdCUV6HQdaaOUMQBwlCUV6HQSLWOUPg8QpCUV6HQW4ROkOw3AxCUV6HQbhMOkOBxw5C\nUV6HQQOIOkNRshBCUV6HQU/DOkMinRJCUV6HQZv+OkPyhxRCUV6HQeY5O0PCchZCUV6HQTJ1\nO0OSXRhCUV6HQX6wO0NjSBpCUV6HQcjrO0MzMxxCUV6HQRQnPEMEHh5CUV6HQV9iPEPUCCBC\nUV6HQaudPEOk8yFCUV6HQffYPEN03iNCUV6HQUMUPUNFySVCUV6HQY5PPUMVtCdCUV6HQdqK\nPUPmnilCUV6HQSbGPUO2iStCUV6HQXABPkOGdC1CUV6HQbs8PkNWXy9CUV6HQQd4PkMnSjFC\nUV6HQVOzPkP3NDNCUV6HQZ7uPkPIHzVCUV6HQeopP0OYCjdCUV6HQTZlP0POWwFCDuWJQWpP\nOUOfRgNCDuWJQbaKOUNvMQVCDuWJQQDGOUNAHAdCDuWJQUwBOkMQBwlCDuWJQZc8OkPg8QpC\nDuWJQeN3OkOw3AxCDuWJQS+zOkOBxw5CDuWJQXvuOkNRshBCDuWJQcYpO0MinRJCDuWJQRJl\nO0PyhxRCDuWJQV6gO0PCchZCDuWJQajbO0OSXRhCDuWJQfMWPENjSBpCDuWJQT9SPEMzMxxC\nDuWJQYuNPEMEHh5CDuWJQdbIPEPUCCBCDuWJQSIEPUOk8yFCDuWJQW4/PUN03iNCDuWJQbh6\nPUNFySVCDuWJQQS2PUMVtCdCDuWJQU/xPUPmnilCDuWJQZssPkO2iStCDuWJQednPkOGdC1C\nDuWJQTOjPkNWXy9CDuWJQX7ePkMnSjFCDuWJQcoZP0P3NDNCDuWJQRZVP0PIHzVCDuWJQWCQ\nP0OYCjdCDuWJQavLP0POWwFCymuMQeC1OUOfRgNCymuMQSvxOUNvMQVCymuMQXcsOkNAHAdC\nymuMQcNnOkMQBwlCymuMQQ6jOkPg8QpCymuMQVreOkOw3AxCymuMQaYZO0OBxw5CymuMQfBU\nO0NRshBCymuMQTyQO0MinRJCymuMQYfLO0PyhxRCymuMQdMGPEPCchZCymuMQR9CPEOSXRhC\nymuMQWt9PENjSBpCymuMQba4PEMzMxxCymuMQQL0PEMEHh5CymuMQU4vPUPUCCBCymuMQZhq\nPUOk8yFCymuMQeOlPUN03iNCymuMQS/hPUNFySVCymuMQXscPkMVtCdCymuMQcZXPkPmnilC\nymuMQRKTPkO2iStCymuMQV7OPkOGdC1CymuMQagJP0NWXy9CymuMQfREP0MnSjFCymuMQT+A\nP0P3NDNCymuMQYu7P0PIHzVCymuMQdf2P0OYCjdCymuMQSMyQEPOWwFChvKOQVccOkOfRgNC\nhvKOQaNXOkNvMQVChvKOQe6SOkNAHAdChvKOQTrOOkMQBwlChvKOQYYJO0Pg8QpChvKOQdBE\nO0Ow3AxChvKOQRuAO0OBxw5ChvKOQWe7O0NRshBChvKOQbP2O0MinRJChvKOQf4xPEPyhxRC\nhvKOQUptPEPCchZChvKOQZaoPEOSXRhChvKOQeDjPENjSBpChvKOQSwfPUMzMxxChvKOQXda\nPUMEHh5ChvKOQcOVPUPUCCBChvKOQQ/RPUOk8yFChvKOQVsMPkN03iNChvKOQaZHPkNFySVC\nhvKOQfKCPkMVtCdChvKOQT6+PkPmnilChvKOQYj5PkO2iStChvKOQdM0P0OGdC1ChvKOQR9w\nP0NWXy9ChvKOQWurP0MnSjFChvKOQbbmP0P3NDNChvKOQQIiQEPIHzVChvKOQU5dQEOYCjdC\nhvKOQZiYQEPOWwFCRHmRQc6COkOfRgNCRHmRQRi+OkNvMQVCRHmRQWT5OkNAHAdCRHmRQa80\nO0MQBwlCRHmRQftvO0Pg8QpCRHmRQUerO0Ow3AxCRHmRQZPmO0OBxw5CRHmRQd4hPENRshBC\nRHmRQSpdPEMinRJCRHmRQXaYPEPyhxRCRHmRQcDTPEPCchZCRHmRQQsPPUOSXRhCRHmRQVdK\nPUNjSBpCRHmRQaOFPUMzMxxCRHmRQe7APUMEHh5CRHmRQTr8PUPUCCBCRHmRQYY3PkOk8yFC\nRHmRQdByPkN03iNCRHmRQRyuPkNFySVCRHmRQWfpPkMVtCdCRHmRQbMkP0PmnilCRHmRQf9f\nP0O2iStCRHmRQUubP0OGdC1CRHmRQZbWP0NWXy9CRHmRQeIRQEMnSjFCRHmRQS5NQEP3NDNC\nRHmRQXiIQEPIHzVCRHmRQcPDQEOYCjdCRHmRQQ//QEPOWwFCAACUQUPpOkOfRgNCAACUQY8k\nO0NvMQVCAACUQdtfO0NAHAdCAACUQSabO0MQBwlCAACUQXLWO0Pg8QpCAACUQb4RPEOw3AxC\nAACUQQhNPEOBxw5CAACUQVSIPENRshBCAACUQZ/DPEMinRJCAACUQev+PEPyhxRCAACUQTc6\nPUPCchZCAACUQYN1PUOSXRhCAACUQc6wPUNjSBpCAACUQRrsPUMzMxxCAACUQWYnPkMEHh5C\nAACUQbBiPkPUCCBCAACUQfudPkOk8yFCAACUQUfZPkN03iNCAACUQZMUP0NFySVCAACUQd5P\nP0MVtCdCAACUQSqLP0PmnilCAACUQXbGP0O2iStCAACUQcABQEOGdC1CAACUQQw9QENWXy9C\nAACUQVd4QEMnSjFCAACUQaOzQEP3NDNCAACUQe/uQEPIHzVCAACUQToqQUOYCjdCAACUQYZl\nQUPOWwFCvYaWQbtPO0OfRgNCvYaWQQaLO0NvMQVCvYaWQVLGO0NAHAdCvYaWQZ4BPEMQBwlC\nvYaWQeg8PEPg8QpCvYaWQTN4PEOw3AxCvYaWQX+zPEOBxw5CvYaWQcvuPENRshBCvYaWQRYq\nPUMinRJCvYaWQWJlPUPyhxRCvYaWQa6gPUPCchZCvYaWQfjbPUOSXRhCvYaWQUQXPkNjSBpC\nvYaWQY9SPkMzMxxCvYaWQduNPkMEHh5CvYaWQSfJPkPUCCBCvYaWQXIEP0Ok8yFCvYaWQb4/\nP0N03iNCvYaWQQh7P0NFySVCvYaWQVW2P0MVtCdCvYaWQaDxP0PmnilCvYaWQessQEO2iStC\nvYaWQTdoQEOGdC1CvYaWQYOjQENWXy9CvYaWQc7eQEMnSjFCvYaWQRoaQUP3NDNCvYaWQWZV\nQUPIHzVCvYaWQbCQQUOYCjdCvYaWQfvLQUPOWwFCeg2ZQTC2O0OfRgNCeg2ZQXzxO0NvMQVC\neg2ZQccsPENAHAdCeg2ZQRNoPEMQBwlCeg2ZQV+jPEPg8QpCeg2ZQarePEOw3AxCeg2ZQfYZ\nPUOBxw5Ceg2ZQUBVPUNRshBCeg2ZQY2QPUMinRJCeg2ZQdjLPUPyhxRCeg2ZQSMHPkPCchZC\neg2ZQW9CPkOSXRhCeg2ZQbt9PkNjSBpCeg2ZQQa5PkMzMxxCeg2ZQVL0PkMEHh5Ceg2ZQZ4v\nP0PUCCBCeg2ZQehqP0Ok8yFCeg2ZQTOmP0N03iNCeg2ZQX/hP0NFySVCeg2ZQcscQEMVtCdC\neg2ZQRZYQEPmnilCeg2ZQWKTQEO2iStCeg2ZQa7OQEOGdC1Ceg2ZQfgJQUNWXy9Ceg2ZQURF\nQUMnSjFCeg2ZQY+AQUP3NDNCeg2ZQdu7QUPIHzVCeg2ZQSf3QUOYCjdCeg2ZQXMyQkPOWwFC\nNpSbQaccPEOfRgNCNpSbQfNXPENvMQVCNpSbQT6TPENAHAdCNpSbQYrOPEMQBwlCNpSbQdYJ\nPUPg8QpCNpSbQSBFPUOw3AxCNpSbQWuAPUOBxw5CNpSbQbe7PUNRshBCNpSbQQP3PUMinRJC\nNpSbQU4yPkPyhxRCNpSbQZptPkPCchZCNpSbQeaoPkOSXRhCNpSbQTDkPkNjSBpCNpSbQXwf\nP0MzMxxCNpSbQcdaP0MEHh5CNpSbQROWP0PUCCBCNpSbQV/RP0Ok8yFCNpSbQasMQEN03iNC\nNpSbQfZHQENFySVCNpSbQUKDQEMVtCdCNpSbQY6+QEPmnilCNpSbQdj5QEO2iStCNpSbQSM1\nQUOGdC1CNpSbQW9wQUNWXy9CNpSbQburQUMnSjFCNpSbQQbnQUP3NDNCNpSbQVIiQkPIHzVC\nNpSbQZ5dQkOYCjdCNpSbQeiYQkPOWwFC8hqeQR6DPEOfRgNC8hqeQWi+PENvMQVC8hqeQbT5\nPENAHAdC8hqeQf80PUMQBwlC8hqeQUtwPUPg8QpC8hqeQZerPUOw3AxC8hqeQePmPUOBxw5C\n8hqeQS4iPkNRshBC8hqeQXpdPkMinRJC8hqeQcaYPkPyhxRC8hqeQRDUPkPCchZC8hqeQVsP\nP0OSXRhC8hqeQadKP0NjSBpC8hqeQfOFP0MzMxxC8hqeQT7BP0MEHh5C8hqeQYr8P0PUCCBC\n8hqeQdY3QEOk8yFC8hqeQSBzQEN03iNC8hqeQWyuQENFySVC8hqeQbfpQEMVtCdC8hqeQQMl\nQUPmnilC8hqeQU9gQUO2iStC8hqeQZubQUOGdC1C8hqeQebWQUNWXy9C8hqeQTISQkMnSjFC\n8hqeQX5NQkP3NDNC8hqeQciIQkPIHzVC8hqeQRPEQkOYCjdC8hqeQV//QkPOWwFCr6GgQZPp\nPEOfRgNCr6GgQd8kPUNvMQVCr6GgQStgPUNAHAdCr6GgQXabPUMQBwlCr6GgQcLWPUPg8QpC\nr6GgQQ4SPkOw3AxCr6GgQVhNPkOBxw5Cr6GgQaSIPkNRshBCr6GgQe/DPkMinRJCr6GgQTv/\nPkPyhxRCr6GgQYc6P0PCchZCr6GgQdN1P0OSXRhCr6GgQR6xP0NjSBpCr6GgQWrsP0MzMxxC\nr6GgQbYnQEMEHh5Cr6GgQQBjQEPUCCBCr6GgQUueQEOk8yFCr6GgQZfZQEN03iNCr6GgQeMU\nQUNFySVCr6GgQS5QQUMVtCdCr6GgQXqLQUPmnilCr6GgQcbGQUO2iStCr6GgQRACQkOGdC1C\nr6GgQVw9QkNWXy9Cr6GgQad4QkMnSjFCr6GgQfOzQkP3NDNCr6GgQT/vQkPIHzVCr6GgQYsq\nQ0OYCjdCr6GgQdZlQ0POWwFCbCijQQtQPUOfRgNCbCijQVaLPUNvMQVCbCijQaLGPUNAHAdC\nbCijQe4BPkMQBwlCbCijQTg9PkPg8QpCbCijQYN4PkOw3AxCbCijQc+zPkOBxw5CbCijQRvv\nPkNRshBCbCijQWYqP0MinRJCbCijQbJlP0PyhxRCbCijQf6gP0PCchZCbCijQUjcP0OSXRhC\nbCijQZQXQENjSBpCbCijQd9SQEMzMxxCbCijQSuOQEMEHh5CbCijQXfJQEPUCCBCbCijQcME\nQUOk8yFCbCijQQ5AQUN03iNCbCijQVp7QUNFySVCbCijQaa2QUMVtCdCbCijQfDxQUPmnilC\nbCijQTstQkO2iStCbCijQYdoQkOGdC1CbCijQdOjQkNWXy9CbCijQR7fQkMnSjFCbCijQWoa\nQ0P3NDNCbCijQbZVQ0PIHzVCbCijQQCRQ0OYCjdCbCijQUzMQ0POWwFCKa+lQYC2PUOfRgNC\nKa+lQczxPUNvMQVCKa+lQRctPkNAHAdCKa+lQWNoPkMQBwlCKa+lQa+jPkPg8QpCKa+lQfve\nPkOw3AxCKa+lQUYaP0OBxw5CKa+lQZJVP0NRshBCKa+lQd6QP0MinRJCKa+lQSjMP0PyhxRC\nKa+lQXMHQEPCchZCKa+lQb9CQEOSXRhCKa+lQQt+QENjSBpCKa+lQVa5QEMzMxxCKa+lQaL0\nQEMEHh5CKa+lQe4vQUPUCCBCKa+lQThrQUOk8yFCKa+lQYSmQUN03iNCKa+lQc/hQUNFySVC\nKa+lQRsdQkMVtCdCKa+lQWdYQkPmnilCKa+lQbOTQkO2iStCKa+lQf7OQkOGdC1CKa+lQUoK\nQ0NWXy9CKa+lQZZFQ0MnSjFCKa+lQeCAQ0P3NDNCKa+lQSu8Q0PIHzVCKa+lQXf3Q0OYCjdC\nKa+lQcMyREPOWwFC5TWoQfccPkOfRgNC5TWoQUNYPkNvMQVC5TWoQY6TPkNAHAdC5TWoQdrO\nPkMQBwlC5TWoQSYKP0Pg8QpC5TWoQXBFP0Ow3AxC5TWoQbyAP0OBxw5C5TWoQQe8P0NRshBC\n5TWoQVP3P0MinRJC5TWoQZ8yQEPyhxRC5TWoQettQEPCchZC5TWoQTapQEOSXRhC5TWoQYLk\nQENjSBpC5TWoQc4fQUMzMxxC5TWoQRhbQUMEHh5C5TWoQWOWQUPUCCBC5TWoQa/RQUOk8yFC\n5TWoQfsMQkN03iNC5TWoQUZIQkNFySVC5TWoQZKDQkMVtCdC5TWoQd6+QkPmnilC5TWoQSj6\nQkO2iStC5TWoQXQ1Q0OGdC1C5TWoQb9wQ0NWXy9C5TWoQQusQ0MnSjFC5TWoQVfnQ0P3NDNC\n5TWoQaMiREPIHzVC5TWoQe5dREOYCjdC5TWoQTqZREPOWwFCoryqQW6DPkOfRgNCoryqQbq+\nPkNvMQVCoryqQQb6PkNAHAdCoryqQVA1P0MQBwlCoryqQZtwP0Pg8QpCoryqQeerP0Ow3AxC\noryqQTPnP0OBxw5CoryqQX4iQENRshBCoryqQcpdQEMinRJCoryqQRaZQEPyhxRCoryqQWDU\nQEPCchZCoryqQawPQUOSXRhCoryqQfdKQUNjSBpCoryqQUOGQUMzMxxCoryqQY/BQUMEHh5C\noryqQdv8QUPUCCBCoryqQSY4QkOk8yFCoryqQXJzQkN03iNCoryqQb6uQkNFySVCoryqQQjq\nQkMVtCdCoryqQVMlQ0PmnilCoryqQZ9gQ0O2iStCoryqQeubQ0OGdC1CoryqQTbXQ0NWXy9C\noryqQYISREMnSjFCoryqQc5NREP3NDNCoryqQRiJREPIHzVCoryqQWTEREOYCjdCoryqQa//\nREOZmJg+mZiYPpmYmD4AAIA/AAAAAQEBAQAAAAAAAADwQQAAwH8AAMB/AAAMQgAAwH8AAMB/\nAAAgQgAAwH8AAMB/AAA0QgAAwH8AAMB/AADAfwAAYEEAAMB/AADAfwAAgEEAAMB/AADAfwAA\nkEEAAMB/AADAfwAAoEEAAMB/AADAfwAAsEEAAMB/AADAfwAAwH8AACBDAADAfwAAwH8AADRD\nAADAfwAAwH8AAEhDAADAfwAAwH8AAFxDAAAAAQ=="}]},"context":{"shiny":false,"rmarkdown":null},"vertexShader":"#line 2 1\n// File 1 is the vertex shader\n#ifdef GL_ES\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n#endif\n\nattribute vec3 aPos;\nattribute vec4 aCol;\nuniform mat4 mvMatrix;\nuniform mat4 prMatrix;\nvarying vec4 vCol;\nvarying vec4 vPosition;\n\n#ifdef NEEDS_VNORMAL\nattribute vec3 aNorm;\nuniform mat4 normMatrix;\nvarying vec4 vNormal;\n#endif\n\n#if defined(HAS_TEXTURE) || defined (IS_TEXT)\nattribute vec2 aTexcoord;\nvarying vec2 vTexcoord;\n#endif\n\n#ifdef FIXED_SIZE\nuniform vec3 textScale;\n#endif\n\n#ifdef FIXED_QUADS\nattribute vec3 aOfs;\n#endif\n\n#ifdef IS_TWOSIDED\n#ifdef HAS_NORMALS\nvarying float normz;\nuniform mat4 invPrMatrix;\n#else\nattribute vec3 aPos1;\nattribute vec3 aPos2;\nvarying float normz;\n#endif\n#endif // IS_TWOSIDED\n\n#ifdef FAT_LINES\nattribute vec3 aNext;\nattribute vec2 aPoint;\nvarying vec2 vPoint;\nvarying float vLength;\nuniform float uAspect;\nuniform float uLwd;\n#endif\n\n#ifdef USE_ENVMAP\nvarying vec3 vReflection;\n#endif\n\nvoid main(void) {\n  \n#ifndef IS_BRUSH\n#if defined(NCLIPPLANES) || !defined(FIXED_QUADS) || defined(HAS_FOG) || defined(USE_ENVMAP)\n  vPosition = mvMatrix * vec4(aPos, 1.);\n#endif\n  \n#ifndef FIXED_QUADS\n  gl_Position = prMatrix * vPosition;\n#endif\n#endif // !IS_BRUSH\n  \n#ifdef IS_POINTS\n  gl_PointSize = POINTSIZE;\n#endif\n  \n  vCol = aCol;\n  \n// USE_ENVMAP implies NEEDS_VNORMAL\n\n#ifdef NEEDS_VNORMAL\n  vNormal = normMatrix * vec4(-aNorm, dot(aNorm, aPos));\n#endif\n\n#ifdef USE_ENVMAP\n  vReflection = normalize(reflect(vPosition.xyz/vPosition.w, \n                        normalize(vNormal.xyz/vNormal.w)));\n#endif\n  \n#ifdef IS_TWOSIDED\n#ifdef HAS_NORMALS\n  /* normz should be calculated *after* projection */\n  normz = (invPrMatrix*vNormal).z;\n#else\n  vec4 pos1 = prMatrix*(mvMatrix*vec4(aPos1, 1.));\n  pos1 = pos1/pos1.w - gl_Position/gl_Position.w;\n  vec4 pos2 = prMatrix*(mvMatrix*vec4(aPos2, 1.));\n  pos2 = pos2/pos2.w - gl_Position/gl_Position.w;\n  normz = pos1.x*pos2.y - pos1.y*pos2.x;\n#endif\n#endif // IS_TWOSIDED\n  \n#ifdef NEEDS_VNORMAL\n  vNormal = vec4(normalize(vNormal.xyz), 1);\n#endif\n  \n#if defined(HAS_TEXTURE) || defined(IS_TEXT)\n  vTexcoord = aTexcoord;\n#endif\n  \n#if defined(FIXED_SIZE) && !defined(ROTATING)\n  vec4 pos = prMatrix * mvMatrix * vec4(aPos, 1.);\n  pos = pos/pos.w;\n  gl_Position = pos + vec4(aOfs*textScale, 0.);\n#endif\n  \n#if defined(IS_SPRITES) && !defined(FIXED_SIZE)\n  vec4 pos = mvMatrix * vec4(aPos, 1.);\n  pos = pos/pos.w + vec4(aOfs,  0.);\n  gl_Position = prMatrix*pos;\n#endif\n  \n#ifdef FAT_LINES\n  /* This code was inspired by Matt Deslauriers' code in \n   https://mattdesl.svbtle.com/drawing-lines-is-hard */\n  vec2 aspectVec = vec2(uAspect, 1.0);\n  mat4 projViewModel = prMatrix * mvMatrix;\n  vec4 currentProjected = projViewModel * vec4(aPos, 1.0);\n  currentProjected = currentProjected/currentProjected.w;\n  vec4 nextProjected = projViewModel * vec4(aNext, 1.0);\n  vec2 currentScreen = currentProjected.xy * aspectVec;\n  vec2 nextScreen = (nextProjected.xy / nextProjected.w) * aspectVec;\n  float len = uLwd;\n  vec2 dir = vec2(1.0, 0.0);\n  vPoint = aPoint;\n  vLength = length(nextScreen - currentScreen)/2.0;\n  vLength = vLength/(vLength + len);\n  if (vLength > 0.0) {\n    dir = normalize(nextScreen - currentScreen);\n  }\n  vec2 normal = vec2(-dir.y, dir.x);\n  dir.x /= uAspect;\n  normal.x /= uAspect;\n  vec4 offset = vec4(len*(normal*aPoint.x*aPoint.y - dir), 0.0, 0.0);\n  gl_Position = currentProjected + offset;\n#endif\n  \n#ifdef IS_BRUSH\n  gl_Position = vec4(aPos, 1.);\n#endif\n}","fragmentShader":"#line 2 2\n// File 2 is the fragment shader\n#ifdef GL_ES\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n#endif\nvarying vec4 vCol; // carries alpha\nvarying vec4 vPosition;\n#if defined(HAS_TEXTURE) || defined (IS_TEXT)\nvarying vec2 vTexcoord;\nuniform sampler2D uSampler;\n#endif\n\n#ifdef HAS_FOG\nuniform int uFogMode;\nuniform vec3 uFogColor;\nuniform vec4 uFogParms;\n#endif\n\n#if defined(IS_LIT) && !defined(FIXED_QUADS)\nvarying vec4 vNormal;\n#endif\n\n#if NCLIPPLANES > 0\nuniform vec4 vClipplane[NCLIPPLANES];\n#endif\n\n#if NLIGHTS > 0\nuniform mat4 mvMatrix;\n#endif\n\n#ifdef IS_LIT\nuniform vec3 emission;\nuniform float shininess;\n#if NLIGHTS > 0\nuniform vec3 ambient[NLIGHTS];\nuniform vec3 specular[NLIGHTS]; // light*material\nuniform vec3 diffuse[NLIGHTS];\nuniform vec3 lightDir[NLIGHTS];\nuniform bool viewpoint[NLIGHTS];\nuniform bool finite[NLIGHTS];\n#endif\n#endif // IS_LIT\n\n#ifdef IS_TWOSIDED\nuniform bool front;\nvarying float normz;\n#endif\n\n#ifdef FAT_LINES\nvarying vec2 vPoint;\nvarying float vLength;\n#endif\n\n#ifdef USE_ENVMAP\nvarying vec3 vReflection;\n#endif\n\nvoid main(void) {\n  vec4 fragColor;\n#ifdef FAT_LINES\n  vec2 point = vPoint;\n  bool neg = point.y < 0.0;\n  point.y = neg ? (point.y + vLength)/(1.0 - vLength) :\n                 -(point.y - vLength)/(1.0 - vLength);\n#if defined(IS_TRANSPARENT) && defined(IS_LINESTRIP)\n  if (neg && length(point) <= 1.0) discard;\n#endif\n  point.y = min(point.y, 0.0);\n  if (length(point) > 1.0) discard;\n#endif // FAT_LINES\n  \n#ifdef ROUND_POINTS\n  vec2 coord = gl_PointCoord - vec2(0.5);\n  if (length(coord) > 0.5) discard;\n#endif\n  \n#if NCLIPPLANES > 0\n  for (int i = 0; i < NCLIPPLANES; i++)\n    if (dot(vPosition, vClipplane[i]) < 0.0) discard;\n#endif\n    \n#ifdef FIXED_QUADS\n    vec3 n = vec3(0., 0., 1.);\n#elif defined(IS_LIT)\n    vec3 n = normalize(vNormal.xyz);\n#endif\n    \n#ifdef IS_TWOSIDED\n    if ((normz <= 0.) != front) discard;\n#endif\n\n#ifdef IS_LIT\n    vec3 eye = normalize(-vPosition.xyz/vPosition.w);\n    vec3 lightdir;\n    vec4 colDiff;\n    vec3 halfVec;\n    vec4 lighteffect = vec4(emission, 0.);\n    vec3 col;\n    float nDotL;\n#ifdef FIXED_QUADS\n    n = -faceforward(n, n, eye);\n#endif\n    \n#if NLIGHTS > 0\n    // Simulate two-sided lighting\n    if (n.z < 0.0)\n      n = -n;\n    for (int i=0;i<NLIGHTS;i++) {\n      colDiff = vec4(vCol.rgb * diffuse[i], vCol.a);\n      lightdir = lightDir[i];\n      if (!viewpoint[i]) {\n        if (finite[i]) {\n          lightdir = (mvMatrix * vec4(lightdir, 1.)).xyz;\n        } else {\n          lightdir = (mvMatrix * vec4(lightdir, 0.)).xyz;\n        }\n      }\n      if (!finite[i]) {\n        halfVec = normalize(lightdir + eye);\n      } else {\n        lightdir = normalize(lightdir - vPosition.xyz/vPosition.w);\n        halfVec = normalize(lightdir + eye);\n      }\n      col = ambient[i];\n      nDotL = dot(n, lightdir);\n      col = col + max(nDotL, 0.) * colDiff.rgb;\n      col = col + pow(max(dot(halfVec, n), 0.), shininess) * specular[i];\n      lighteffect = lighteffect + vec4(col, colDiff.a);\n    }\n#endif\n    \n#else // not IS_LIT\n    vec4 colDiff = vCol;\n    vec4 lighteffect = colDiff;\n#endif\n    \n#ifdef IS_TEXT\n    vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);\n#endif\n    \n#ifdef HAS_TEXTURE\n\n// These calculations use the definitions from \n// https://docs.gl/gl3/glTexEnv\n\n#ifdef USE_ENVMAP\n    float m = 2.0 * sqrt(dot(vReflection, vReflection) + 2.0*vReflection.z + 1.0);\n    vec4 textureColor = texture2D(uSampler, vReflection.xy / m + vec2(0.5, 0.5));\n#else\n    vec4 textureColor = texture2D(uSampler, vTexcoord);\n#endif\n\n#ifdef TEXTURE_rgb\n\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(textureColor.rgb, lighteffect.a);\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = lighteffect*vec4(textureColor.rgb, 1.);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - textureColor.rgb) * lighteffect.rgb, lighteffect.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(lighteffect.rgb + textureColor.rgb, lighteffect.a);\n#endif\n\n#endif //TEXTURE_rgb\n        \n#ifdef TEXTURE_rgba\n\n#ifdef TEXMODE_replace\n// already done\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = lighteffect*textureColor;\n#endif\n\n#ifdef TEXMODE_decal\n    textureColor = vec4((1. - textureColor.a)*lighteffect.rgb) +\n                     textureColor.a*textureColor.rgb, \n                     lighteffect.a);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - textureColor.rgb) * lighteffect.rgb,\n                    lighteffect.a*textureColor.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(lighteffect.rgb + textureColor.rgb,\n                    lighteffect.a*textureColor.a);\n#endif\n    \n#endif //TEXTURE_rgba\n    \n#ifdef TEXTURE_alpha\n    float luminance = dot(vec3(1.,1.,1.),textureColor.rgb)/3.;\n\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(lighteffect.rgb, luminance);\n#endif \n\n#if defined(TEXMODE_modulate) || defined(TEXMODE_blend) || defined(TEXMODE_add)\n    textureColor = vec4(lighteffect.rgb, lighteffect.a*luminance);\n#endif\n \n#endif // TEXTURE_alpha\n    \n// The TEXTURE_luminance values are not from that reference    \n#ifdef TEXTURE_luminance\n    float luminance = dot(vec3(1.,1.,1.),textureColor.rgb)/3.;\n\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(luminance, luminance, luminance, lighteffect.a);\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = vec4(luminance*lighteffect.rgb, lighteffect.a);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - luminance)*lighteffect.rgb,\n                        lighteffect.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(luminance + lighteffect.rgb, lighteffect.a);\n#endif\n\n#endif // TEXTURE_luminance\n \n    \n#ifdef TEXTURE_luminance_alpha\n    float luminance = dot(vec3(1.,1.,1.),textureColor.rgb)/3.;\n\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(luminance, luminance, luminance, textureColor.a);\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = vec4(luminance*lighteffect.rgb, \n                        textureColor.a*lighteffect.a);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - luminance)*lighteffect.rgb,\n                        textureColor.a*lighteffect.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(luminance + lighteffect.rgb, \n                        textureColor.a*lighteffect.a);\n\n#endif\n\n#endif // TEXTURE_luminance_alpha\n    \n    fragColor = textureColor;\n\n#elif defined(IS_TEXT)\n    if (textureColor.a < 0.1)\n      discard;\n    else\n      fragColor = textureColor;\n#else\n    fragColor = lighteffect;\n#endif // HAS_TEXTURE\n    \n#ifdef HAS_FOG\n    // uFogParms elements: x = near, y = far, z = fogscale, w = (1-sin(FOV/2))/(1+sin(FOV/2))\n    // In Exp and Exp2: use density = density/far\n    // fogF will be the proportion of fog\n    // Initialize it to the linear value\n    float fogF;\n    if (uFogMode > 0) {\n      fogF = (uFogParms.y - vPosition.z/vPosition.w)/(uFogParms.y - uFogParms.x);\n      if (uFogMode > 1)\n        fogF = mix(uFogParms.w, 1.0, fogF);\n      fogF = fogF*uFogParms.z;\n      if (uFogMode == 2)\n        fogF = 1.0 - exp(-fogF);\n      // Docs are wrong: use (density*c)^2, not density*c^2\n      // https://gitlab.freedesktop.org/mesa/mesa/-/blob/master/src/mesa/swrast/s_fog.c#L58\n      else if (uFogMode == 3)\n        fogF = 1.0 - exp(-fogF*fogF);\n      fogF = clamp(fogF, 0.0, 1.0);\n      gl_FragColor = vec4(mix(fragColor.rgb, uFogColor, fogF), fragColor.a);\n    } else gl_FragColor = fragColor;\n#else\n    gl_FragColor = fragColor;\n#endif // HAS_FOG\n    \n}","players":[],"webGLoptions":{"preserveDrawingBuffer":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-fit-comparison-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10: A 3D visualization of the fitted model: the plane represents the fitted model, while the points represent the observed data. <strong>Use the mouse to explore</strong>.
</figcaption></figure>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">limits</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fit_engine</span>, interval <span class="op">=</span> <span class="st">"prediction"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">rutils</span><span class="fu">:::</span><span class="fu">shush</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/augment.html">augment</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html">bind_cols</a></span><span class="op">(</span><span class="va">limits</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">flipper_length_mm</span>, <span class="va">.pred</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># ggplot2::geom_ribbon(</span></span>
<span>  <span class="co">#   mapping = ggplot2::aes(ymin = lwr, ymax = upr),</span></span>
<span>  <span class="co">#   alpha = 0.2</span></span>
<span>  <span class="co"># ) +</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_ribbon</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>      ymin <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/loess.html">loess</a></span><span class="op">(</span><span class="va">lwr</span> <span class="op">~</span> <span class="va">flipper_length_mm</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      ymax <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/loess.html">loess</a></span><span class="op">(</span><span class="va">upr</span> <span class="op">~</span> <span class="va">flipper_length_mm</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="op">)</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.2</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">lwr</span><span class="op">)</span>,</span>
<span>    se <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"loess"</span>,</span>
<span>    formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>,</span>
<span>    linetype <span class="op">=</span> <span class="st">"dashed"</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"black"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">upr</span><span class="op">)</span>,</span>
<span>    se <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"loess"</span>,</span>
<span>    formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>,</span>
<span>    linetype <span class="op">=</span> <span class="st">"dashed"</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"black"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">0</span>, slope <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Observed"</span>, </span>
<span>    y <span class="op">=</span> <span class="st">"Predicted"</span>, </span>
<span>    subtitle <span class="op">=</span> <span class="fu">latex2exp</span><span class="fu">::</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span></span>
<span>        <span class="fu">lm_str_fun</span><span class="op">(</span><span class="va">fit_engine</span>, digits <span class="op">=</span> <span class="fl">3</span>, latex2exp <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>, <span class="st">" | "</span>,</span>
<span>        <span class="st">"$R^{2} = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html">glance</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">$</span><span class="va">r.squared</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"$ | "</span>,</span>
<span>        <span class="st">"$R^{2}_{adj} = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html">glance</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">$</span><span class="va">adj.r.squared</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"$"</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.</span></span>
<span><span class="co">#&gt; ℹ Please use `linewidth` instead.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-model-fit" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-model-fit-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-fit-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11: Relation between observed and predicted values. The red line is a 45-degree line originating from the plane’s origin and represents a perfect fit. The shaded area depicts a smoothed version of the 95% confidence of the <a href="http://www.sthda.com/english/articles/40-regression-analysis/166-predict-in-r-model-predictions-and-confidence-intervals/">prediction interval</a>.
</figcaption></figure>
</div>
</section><section id="adjusted-predictions" class="level3"><h3 class="anchored" data-anchor-id="adjusted-predictions">Adjusted predictions</h3>
<p>If we keep all predictors fixed except one, we can observe the regression line between that independent variable and the dependent variable. Here, we present different visualizations of the fitted model. This is important for understanding how each predictor is associated with the outcome.</p>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/augment.html">augment</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">bill_length_mm</span>, <span class="va">flipper_length_mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">.pred</span>, color <span class="op">=</span> <span class="st">"Prediction"</span><span class="op">)</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.5</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">.pred</span>, color <span class="op">=</span> <span class="st">"Adjusted prediction"</span><span class="op">)</span>,</span>
<span>    fun <span class="op">=</span> <span class="fu">lm_fun</span><span class="op">(</span><span class="va">fit_engine</span>, fix_all_but <span class="op">=</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Bill length (mm)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Flipper length (mm)"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="fu">lm_str_fun</span><span class="op">(</span><span class="va">fit_engine</span>, fix_all_but <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Prediction"</span> <span class="op">=</span> <span class="st">"blue"</span>, <span class="st">"Adjusted prediction"</span> <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-model-fit-comparison-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-model-fit-comparison-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-fit-comparison-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12: Model prediction (blue line) and adjusted prediction (red line) plotted against a scatter plot of the dependent variable (<code>flipper_length_mm</code>) and one of the independent variables (<code>bill_length_mm</code>). The adjusted prediction is calculated by holding the <code>bill_depth_mm</code> variable constant at its mean value.
</figcaption></figure>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/augment.html">augment</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">bill_depth_mm</span>, <span class="va">flipper_length_mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">.pred</span>, color <span class="op">=</span> <span class="st">"Prediction"</span><span class="op">)</span>, </span>
<span>    linewidth <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.5</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">.pred</span>, color <span class="op">=</span> <span class="st">"Adjusted prediction"</span><span class="op">)</span>,</span>
<span>    fun <span class="op">=</span> <span class="fu">lm_fun</span><span class="op">(</span><span class="va">fit_engine</span>, fix_all_but <span class="op">=</span> <span class="fl">2</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Bill depth (mm)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Flipper length (mm)"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="fu">lm_str_fun</span><span class="op">(</span><span class="va">fit_engine</span>, fix_all_but <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Prediction"</span> <span class="op">=</span> <span class="st">"blue"</span>, <span class="st">"Adjusted prediction"</span> <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-model-fit-comparison-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-model-fit-comparison-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-fit-comparison-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13: Model prediction (blue line) and adjusted prediction (red line) plotted against a scatter plot of the dependent variable (<code>flipper_length_mm</code>) and one of the independent variables (<code>bill_depth_mm</code>). The adjusted prediction is calculated by holding the <code>bill_depth_mm</code> variable constant at its mean value.
</figcaption></figure>
</div>
<!-- See: https://cran.r-project.org/web/packages/predict3d/vignettes/predict3d.html -->
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine_2</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggeffects</span><span class="fu">::</span><span class="fu"><a href="https://strengejacke.github.io/ggeffects/reference/predict_response.html">predict_response</a></span><span class="op">(</span></span>
<span>    terms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"bill_length_mm"</span>, <span class="st">"bill_depth_mm"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span>show_data <span class="op">=</span> <span class="cn">TRUE</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Bill length (mm)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Flipper length (mm)"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"Bill depth (mm)"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_gray</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-model-fit-comparison-4" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-model-fit-comparison-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-fit-comparison-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;14: Relationship between <code>flipper_length_mm</code> and <code>bill_length_mm</code>, with data points represented as dots. The three lines show model predictions for different values of the variable <code>bill_depth_mm</code>, with the shaded areas representing confidence intervals.
</figcaption></figure>
</div>
</section><section id="posterior-predictive-checks" class="level3"><h3 class="anchored" data-anchor-id="posterior-predictive-checks">Posterior predictive checks</h3>
<p>Posterior predictive checks are a technique used in Bayesian statistics to assess the fit of a model by comparing observed data to data simulated from the <a href="https://en.wikipedia.org/wiki/Posterior_predictive_distribution">posterior predictive distribution</a>. The model-predicted lines should resemble the observed data line.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">diag_sum_plots</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">fit_engine_2</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">performance</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/performance/reference/check_model.html">check_model</a></span><span class="op">(</span></span>
<span>    panel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"black"</span>, <span class="st">"black"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">rutils</span><span class="fu">:::</span><span class="fu">shush</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">diag_sum_plots</span><span class="op">$</span><span class="va">PP_CHECK</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Flipper length (mm)"</span>,</span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_gray</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="performing-model-diagnostics" class="level2"><h2 class="anchored" data-anchor-id="performing-model-diagnostics">Performing model diagnostics</h2>
<section id="normality" class="level3"><h3 class="anchored" data-anchor-id="normality">Normality</h3>
<p><strong>Assumption 2</strong> is satisfied, as the residuals shown a normal distribution in 11 types of normality tests with different approaches (e.g., moments, regression/correlations; ECDFs).</p>
</section><section id="visual-inspection" class="level3"><h3 class="anchored" data-anchor-id="visual-inspection">Visual inspection</h3>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">test_normality</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Residuals"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-model-residual-diag-normality-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-model-residual-diag-normality-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-residual-diag-normality-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15: Histogram of the model residuals with a kernel density estimate, along with a quantile-quantile (Q-Q) plot between the residuals and the theoretical quantiles of the normal distribution.
</figcaption></figure>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/augment.html">augment</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">.resid</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="va">.resid</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">name</span>, y <span class="op">=</span> <span class="va">value</span>, fill <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span></span>
<span>    outlier.colour <span class="op">=</span> <span class="st">"red"</span>, </span>
<span>    outlier.shape <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    width <span class="op">=</span> <span class="fl">0.5</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.2</span>, alpha <span class="op">=</span> <span class="fl">0.1</span>, color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span></span>
<span>    labels <span class="op">=</span> <span class="st">"Residuals"</span>,</span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/predict3d/man/gg_color_hue.html">gg_color_hue</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Variable"</span>, y <span class="op">=</span> <span class="st">"Value"</span>, fill <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    axis.title.y <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.text.y <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.ticks.y <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-model-residual-diag-normality-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-model-residual-diag-normality-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-residual-diag-normality-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16: Boxplot of model residuals with outliers highlighted in red and other residuals indicated by jittered points.
</figcaption></figure>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats_sum</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Residuals"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-model-residual-diag-normality-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-model-residual-diag-normality-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;8: Summary statistics of model residuals.
</figcaption><div aria-describedby="tbl-model-residual-diag-normality-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["value"],"name":[2],"type":["chr"],"align":["left"]}],"data":[{"1":"name","2":"Residuals"},{"1":"n","2":"150"},{"1":"n_rm_na","2":"150"},{"1":"n_na","2":"0"},{"1":"mean","2":"-0.000000000000000283060611986722"},{"1":"var","2":"34.7411912950859"},{"1":"sd","2":"5.89416586932247"},{"1":"min","2":"-17.7248992240667"},{"1":"q_1","2":"-3.15091069530549"},{"1":"median","2":"-0.0638374664800506"},{"1":"q_3","2":"3.7849465471658"},{"1":"max","2":"16.4934792060701"},{"1":"iqr","2":"6.9358572424713"},{"1":"skewness","2":"-0.13958919317545"},{"1":"kurtosis","2":"3.34335140208504"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</figure>
</div>
</section><section id="tests" class="level3"><h3 class="anchored" data-anchor-id="tests">Tests</h3>
<p>It’s important to note that the Kolmogorov-Smirnov and Pearson chi-square tests are included here just for reference, as many authors don’t recommend using them when testing for normality <span class="citation" data-cites="dagostino1990">(<a href="#ref-dagostino1990" role="doc-biblioref">D’Agostino &amp; Belanger, 1990</a>)</span>. Learn more about normality tests in <span class="citation" data-cites="thode2002">Thode (<a href="#ref-thode2002" role="doc-biblioref">2002</a>)</span>.</p>
<p>We also recommend checking the original papers for each test to understand their assumptions and limitations:</p>
<ul>
<li>
<a href="https://en.wikipedia.org/wiki/Anderson%E2%80%93Darling_test">Anderson-Darling test</a>: <span class="citation" data-cites="anderson1952">Anderson &amp; Darling (<a href="#ref-anderson1952" role="doc-biblioref">1952</a>)</span>; <span class="citation" data-cites="anderson1954">Anderson &amp; Darling (<a href="#ref-anderson1954" role="doc-biblioref">1954</a>)</span>.</li>
<li>Bonett-Seier test: <span class="citation" data-cites="bonett2002">Bonett &amp; Seier (<a href="#ref-bonett2002" role="doc-biblioref">2002</a>)</span>.</li>
<li>
<a href="https://en.wikipedia.org/wiki/Cram%C3%A9r%E2%80%93von_Mises_criterion">Cramér-von Mises test</a>: <span class="citation" data-cites="cramer1928">Cramér (<a href="#ref-cramer1928" role="doc-biblioref">1928</a>)</span>; <span class="citation" data-cites="anderson1962">Anderson (<a href="#ref-anderson1962" role="doc-biblioref">1962</a>)</span>.</li>
<li>
<a href="https://en.wikipedia.org/wiki/D%27Agostino%27s_K-squared_test">D’Agostino test</a>: <span class="citation" data-cites="dagostino1971">D’Agostino (<a href="#ref-dagostino1971" role="doc-biblioref">1971</a>)</span>; <span class="citation" data-cites="dagostino1973">D’Agostino &amp; Pearson (<a href="#ref-dagostino1973" role="doc-biblioref">1973</a>)</span>.</li>
<li>
<a href="https://en.wikipedia.org/wiki/Jarque%E2%80%93Bera_test">Jarque–Bera test</a>: <span class="citation" data-cites="jarque1980">Jarque &amp; Bera (<a href="#ref-jarque1980" role="doc-biblioref">1980</a>)</span>; <span class="citation" data-cites="bera1981">Bera &amp; Jarque (<a href="#ref-bera1981" role="doc-biblioref">1981</a>)</span>; <span class="citation" data-cites="jarque1987">Jarque &amp; Bera (<a href="#ref-jarque1987" role="doc-biblioref">1987</a>)</span>.</li>
<li>
<a href="https://en.wikipedia.org/wiki/Lilliefors_test">Lilliefors (K-S) test</a>: <span class="citation" data-cites="smirnov1948">Smirnov (<a href="#ref-smirnov1948" role="doc-biblioref">1948</a>)</span>; <span class="citation" data-cites="kolmogorov1933">Kolmogorov (<a href="#ref-kolmogorov1933" role="doc-biblioref">1933</a>)</span>; <span class="citation" data-cites="massey1951">Massey (<a href="#ref-massey1951" role="doc-biblioref">1951</a>)</span>; <span class="citation" data-cites="lilliefors1967">Lilliefors (<a href="#ref-lilliefors1967" role="doc-biblioref">1967</a>)</span>; <span class="citation" data-cites="dallal1986">Dallal &amp; Wilkinson (<a href="#ref-dallal1986" role="doc-biblioref">1986</a>)</span>.</li>
<li>
<a href="https://en.wikipedia.org/wiki/Pearson%27s_chi-squared_test">Pearson chi-square test</a>: <span class="citation" data-cites="pearson1900">Pearson (<a href="#ref-pearson1900" role="doc-biblioref">1900</a>)</span>.</li>
<li>
<a href="https://en.wikipedia.org/wiki/Shapiro%E2%80%93Francia_test">Shapiro-Francia test</a>: <span class="citation" data-cites="shapiro1972">Shapiro &amp; Francia (<a href="#ref-shapiro1972" role="doc-biblioref">1972</a>)</span>.</li>
<li>
<a href="https://en.wikipedia.org/wiki/Shapiro%E2%80%93Wilk_test">Shapiro-Wilk test</a>: <span class="citation" data-cites="shapiro1965">Shapiro &amp; Wilk (<a href="#ref-shapiro1965" role="doc-biblioref">1965</a>)</span>.</li>
</ul>
<p><span class="math display">\[
\begin{cases}
\text{H}_{0}: \text{The data is normally distributed} \\
\text{H}_{a}: \text{The data is not normally distributed}
\end{cases}
\]</span></p>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">normality_sum</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-model-residual-diag-normality-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-model-residual-diag-normality-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;9: Summary of statistical tests conducted to assess the normality of the residuals.
</figcaption><div aria-describedby="tbl-model-residual-diag-normality-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["test"],"name":[1],"type":["chr"],"align":["left"]},{"label":["statistic_1"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["statistic_2"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["p_value"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"Anderson-Darling","2":"0.50740413","3":"NA","4":"0.19721083"},{"1":"Bonett-Seier","2":"4.57474207","3":"1.126334","4":"0.26002403"},{"1":"Cramér-von Mises","2":"0.08316926","3":"NA","4":"0.18699024"},{"1":"D'Agostino Omnibus Test","2":"1.65926998","3":"NA","4":"0.43620848"},{"1":"D'Agostino Skewness Test","2":"-0.72625464","3":"NA","4":"0.46768268"},{"1":"D'Agostino Kurtosis Test","2":"1.06387226","3":"NA","4":"0.28738657"},{"1":"Jarque–Bera","2":"1.22394223","3":"2.000000","4":"0.54228092"},{"1":"Lilliefors (K-S)","2":"0.05502972","3":"NA","4":"0.32391746"},{"1":"Pearson chi-square","2":"21.00000000","3":"NA","4":"0.05038045"},{"1":"Shapiro-Francia","2":"0.99167665","3":"NA","4":"0.52895319"},{"1":"Shapiro-Wilk","2":"0.99057252","3":"NA","4":"0.35402082"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</figure>
</div>
<p>Correlation between observed residuals and expected residuals under normality.</p>
<div class="cell">
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_test_correlation.html">ols_test_correlation</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.9952751</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="linearity" class="level3"><h3 class="anchored" data-anchor-id="linearity">Linearity</h3>
<p><strong>Assumption 3</strong> is satisfied, as the relationship between the variables is fairly linear.</p>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/augment.html">augment</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">.pred</span>, <span class="va">.resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span></span>
<span>    yintercept <span class="op">=</span> <span class="fl">0</span>, </span>
<span>    color <span class="op">=</span> <span class="st">"black"</span>, </span>
<span>    linewidth <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>    linetype <span class="op">=</span> <span class="st">"dashed"</span> </span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, method <span class="op">=</span> <span class="st">"loess"</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Fitted values"</span>, y <span class="op">=</span> <span class="st">"Residuals"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-model-residual-diag-fitted-values-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-model-residual-diag-fitted-values-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-residual-diag-fitted-values-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;17: Residual plot showing the relationship between fitted values and residuals, with the dashed black line representing zero residuals, indicating an ideal model fit, and the red line indicating the smoothed conditional mean of residuals, with the shaded region representing the confidence interval of this estimate.
</figcaption></figure>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plots</span> <span class="op">&lt;-</span> <span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_plot_resid_fit_spread.html">ols_plot_resid_fit_spread</a></span><span class="op">(</span>print_plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">plots</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">q</span> <span class="op">&lt;-</span> <span class="va">plots</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">q</span> <span class="op">&lt;-</span> <span class="va">q</span> <span class="op">|&gt;</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot_build.html">ggplot_build</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">q</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">colour</span> <span class="op">&lt;-</span> <span class="st">"red"</span></span>
<span>  <span class="va">q</span><span class="op">$</span><span class="va">plot</span><span class="op">$</span><span class="va">layers</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">constructor</span><span class="op">$</span><span class="va">color</span> <span class="op">&lt;-</span> <span class="st">"red"</span></span>
<span>  </span>
<span>  <span class="va">plots</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">q</span> <span class="op">|&gt;</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot_gtable.html">ggplot_gtable</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">ggplotify</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggplotify/man/as.ggplot.html">as.ggplot</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span>  </span>
<span><span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span><span class="va">plots</span><span class="op">$</span><span class="va">fm_plot</span>, <span class="va">plots</span><span class="op">$</span><span class="va">rsd_plot</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-model-residual-diag-linearity-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-model-residual-diag-linearity-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-residual-diag-linearity-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;18: Residual fit spread plots to detect non-linearity, influential observations, and outliers. The side-by-side plots show the centered fit and residuals, illustrating the variation explained by the model and what remains in the residuals. Inappropriately specified models often exhibit greater spread in the residuals than in the centered fit. “Proportion Less” indicates the cumulative distribution function, representing the proportion of observations below a specific value, facilitating an assessment of model performance.
</figcaption></figure>
</div>
<p><a href="https://en.wikipedia.org/wiki/Ramsey_RESET_test">Ramsey’s RESET test</a> indicates that the model may has no omitted variables. This test examines whether non-linear combinations of the fitted values can explain the response variable.</p>
<p>Learn more about the Ramsey’s RESET test in: <span class="citation" data-cites="ramsey1969">Ramsey (<a href="#ref-ramsey1969" role="doc-biblioref">1969</a>)</span>.</p>
<p><span class="math display">\[
\begin{cases}
\text{H}_{0}: \text{The model has no omitted variables} \\
\text{H}_{a}: \text{The model has omitted variables}
\end{cases}
\]</span></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">lmtest</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/resettest.html">resettest</a></span><span class="op">(</span>power <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  RESET test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  fit_engine</span></span>
<span><span class="co">#&gt; RESET = 1.2564, df1 = 2, df2 = 145, p-value = 0.2878</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">lmtest</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/resettest.html">resettest</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"regressor"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  RESET test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  fit_engine</span></span>
<span><span class="co">#&gt; RESET = 1.0705, df1 = 4, df2 = 143, p-value = 0.3734</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="homoscedasticity-common-variance" class="level3"><h3 class="anchored" data-anchor-id="homoscedasticity-common-variance">Homoscedasticity (common variance)</h3>
<p><strong>Assumption 4</strong> is satisfied, as the residuals exhibit constant variance. While some heteroscedasticity is present, the Breusch-Pagan test (not studentized) indicate that it is not severe.</p>
<p>When comparing the standardized residuals (<span class="math inline">\(\sqrt{|\text{Standardized Residuals}|}\)</span>) spread to the fitted values and each predictor, we can observe that the residuals are fairly constant across the range of values. This suggests that the residuals have a constant variance.</p>
<section id="visual-inspection-1" class="level4"><h4 class="anchored" data-anchor-id="visual-inspection-1">Visual inspection</h4>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    .sd_resid <span class="op">=</span> </span>
<span>      <span class="va">fit_engine</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">rstandard</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">.pred</span>, <span class="va">.sd_resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, method <span class="op">=</span> <span class="st">"loess"</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Fitted values"</span>, </span>
<span>    y <span class="op">=</span> <span class="fu">latex2exp</span><span class="fu">::</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">"$\\sqrt{|Standardized \\ Residuals|}$"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-model-diag-homoscedasticity-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-model-diag-homoscedasticity-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-67-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-diag-homoscedasticity-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;19: Relation between the fitted values of the model and its standardized residuals.
</figcaption></figure>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    .sd_resid <span class="op">=</span> </span>
<span>      <span class="va">fit_engine</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">rstandard</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html">bind_cols</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">bill_length_mm</span>, <span class="va">.sd_resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, method <span class="op">=</span> <span class="st">"loess"</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Bill length (mm)"</span>, </span>
<span>    y <span class="op">=</span> <span class="fu">latex2exp</span><span class="fu">::</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">"$\\sqrt{|Standardized \\ Residuals|}$"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-model-diag-homoscedasticity-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-model-diag-homoscedasticity-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-68-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-diag-homoscedasticity-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;20: Relation between <code>bill_length_mm</code> and the model standardized residuals.
</figcaption></figure>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb65"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    .sd_resid <span class="op">=</span> </span>
<span>      <span class="va">fit_engine</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">rstandard</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html">bind_cols</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">bill_depth_mm</span>, <span class="va">.sd_resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, method <span class="op">=</span> <span class="st">"loess"</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Bill depth (mm)"</span>, </span>
<span>    y <span class="op">=</span> <span class="fu">latex2exp</span><span class="fu">::</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">"$\\sqrt{|Standardized \\ Residuals|}$"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-model-diag-homoscedasticity-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-model-diag-homoscedasticity-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-69-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-diag-homoscedasticity-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;21: Relation between <code>bill_depth_mm</code> and the model standardized residuals.
</figcaption></figure>
</div>
</section><section id="breusch-pagan-test" class="level4"><h4 class="anchored" data-anchor-id="breusch-pagan-test">Breusch-Pagan test</h4>
<p>The <a href="https://en.wikipedia.org/wiki/Breusch%E2%80%93Pagan_test">Breusch-Pagan test</a> test indicates that the residuals exhibit constant variance.</p>
<p>As we can see below, the result of the test is not significant, suggesting that the residuals have a constant variance.</p>
<p>Learn more about the Breusch-Pagan test in: <span class="citation" data-cites="breusch1979">Breusch &amp; Pagan (<a href="#ref-breusch1979" role="doc-biblioref">1979</a>)</span> and <span class="citation" data-cites="koenker1981">Koenker (<a href="#ref-koenker1981" role="doc-biblioref">1981</a>)</span>.</p>
<p><span class="math display">\[
\begin{cases}
\text{H}_{0}: \text{The variance is constant} \\
\text{H}_{a}: \text{The variance is not constant}
\end{cases}
\]</span></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine_2</span> <span class="op">|&gt;</span> <span class="fu">performance</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/performance/reference/check_heteroscedasticity.html">check_heteroscedasticity</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; OK: Error variance appears to be homoscedastic (p = 0.887).</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb67"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># With studentising modification of Koenker</span></span>
<span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">lmtest</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/bptest.html">bptest</a></span><span class="op">(</span>studentize <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  studentized Breusch-Pagan test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  fit_engine</span></span>
<span><span class="co">#&gt; BP = 0.64698, df = 2, p-value = 0.7236</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb68"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">lmtest</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/bptest.html">bptest</a></span><span class="op">(</span>studentize <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Breusch-Pagan test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  fit_engine</span></span>
<span><span class="co">#&gt; BP = 0.75804, df = 2, p-value = 0.6845</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb69"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># With studentising modification of Koenker</span></span>
<span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">skedastic</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/skedastic/man/breusch_pagan.html">breusch_pagan</a></span><span class="op">(</span>koenker <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["statistic"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["parameter"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["method"],"name":[4],"type":["chr"],"align":["left"]},{"label":["alternative"],"name":[5],"type":["chr"],"align":["left"]}],"data":[{"1":"0.6469751","2":"0.723621","3":"2","4":"Koenker (studentised)","5":"greater"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb70"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">skedastic</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/skedastic/man/breusch_pagan.html">breusch_pagan</a></span><span class="op">(</span>koenker <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["statistic"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["parameter"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["method"],"name":[4],"type":["chr"],"align":["left"]},{"label":["alternative"],"name":[5],"type":["chr"],"align":["left"]}],"data":[{"1":"0.758045","2":"0.6845302","3":"2","4":"Breusch-Pagan (non-studentised)","5":"greater"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb71"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">form</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/ncvTest.html">ncvTest</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Non-constant Variance Score Test </span></span>
<span><span class="co">#&gt; Variance formula: ~ fitted.values </span></span>
<span><span class="co">#&gt; Chisquare = 0.02002983, Df = 1, p = 0.88745</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb72"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_test_breusch_pagan.html">ols_test_breusch_pagan</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Breusch Pagan Test for Heteroskedasticity</span></span>
<span><span class="co">#&gt;  -----------------------------------------</span></span>
<span><span class="co">#&gt;  Ho: the variance is constant            </span></span>
<span><span class="co">#&gt;  Ha: the variance is not constant        </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;              Data               </span></span>
<span><span class="co">#&gt;  -------------------------------</span></span>
<span><span class="co">#&gt;  Response : ..y </span></span>
<span><span class="co">#&gt;  Variables: fitted values of ..y </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;         Test Summary          </span></span>
<span><span class="co">#&gt;  -----------------------------</span></span>
<span><span class="co">#&gt;  DF            =    1 </span></span>
<span><span class="co">#&gt;  Chi2          =    0.02002983 </span></span>
<span><span class="co">#&gt;  Prob &gt; Chi2   =    0.8874538</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="whites-test" class="level4"><h4 class="anchored" data-anchor-id="whites-test">White’s test</h4>
<p>The <a href="https://en.wikipedia.org/wiki/White_test">White’s test</a> is a general test for heteroskedasticity. It is a generalization of the Breusch-Pagan test and is more flexible in terms of the types of heteroskedasticity it can detect. It has the same null hypothesis as the Breusch-Pagan test.</p>
<p>Like the Breusch-Pagan, the results of the White’s test indicate that the residuals exhibit constant variance.</p>
<p>Learn more about the White’s test in: <span class="citation" data-cites="white1980">White (<a href="#ref-white1980" role="doc-biblioref">1980</a>)</span>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb73"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">skedastic</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/skedastic/man/white.html">white</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["statistic"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["parameter"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["method"],"name":[4],"type":["chr"],"align":["left"]},{"label":["alternative"],"name":[5],"type":["chr"],"align":["left"]}],"data":[{"1":"4.868242","2":"0.3010858","3":"4","4":"White's Test","5":"greater"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section></section><section id="independence" class="level3"><h3 class="anchored" data-anchor-id="independence">Independence</h3>
<p><strong>Assumption 5</strong> is satisfied. Although the residuals show some autocorrelation, they fall within the acceptable range of the Durbin–Watson statistic (1.5 to 2.5). It’s also important to note that the observations for each predicted value are not related to any other prediction; in other words, they are not grouped or sequenced by any variable (by design) (see <span class="citation" data-cites="hair2019">(<a href="#ref-hair2019" role="doc-biblioref">Hair, 2019, p. 291</a>)</span> for more information).</p>
<p>Many authors don’t consider autocorrelation tests for linear regression models, as they are more relevant for time series data. However, we include them here for reference.</p>
<section id="visual-inspection-2" class="level4"><h4 class="anchored" data-anchor-id="visual-inspection-2">Visual inspection</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb74"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">forecast</span><span class="fu">::</span><span class="fu"><a href="https://pkg.robjhyndman.com/forecast/reference/tsdisplay.html">ggtsdisplay</a></span><span class="op">(</span>lag.max<span class="op">=</span><span class="fl">30</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-78-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="newey-west-estimator" class="level4"><h4 class="anchored" data-anchor-id="newey-west-estimator">Newey-West estimator</h4>
<p>The <a href="https://en.wikipedia.org/wiki/Newey%E2%80%93West_estimator">Newey-West estimator</a> is a method used to estimate the <a href="https://en.wikipedia.org/wiki/Covariance_matrix">covariance matrix</a> of the coefficients in a regression model when the residuals are autocorrelated.</p>
<p>Learn more about the Newey-West estimator in: <span class="citation" data-cites="newey1987">Newey &amp; West (<a href="#ref-newey1987" role="doc-biblioref">1987</a>)</span> and <span class="citation" data-cites="newey1994">Newey &amp; West (<a href="#ref-newey1994" role="doc-biblioref">1994</a>)</span>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb75"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">sandwich</span><span class="fu">::</span><span class="fu"><a href="https://sandwich.R-Forge.R-project.org/reference/NeweyWest.html">NeweyWest</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;                (Intercept) bill_length_mm bill_depth_mm</span></span>
<span><span class="co">#&gt; (Intercept)     47.9244280    -0.35523375   -1.88169574</span></span>
<span><span class="co">#&gt; bill_length_mm  -0.3552337     0.02273440   -0.02735218</span></span>
<span><span class="co">#&gt; bill_depth_mm   -1.8816957    -0.02735218    0.15988029</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The Heteroscedasticity and autocorrelation consistent (HAC) estimation of the covariance matrix of the coefficient estimates can also be computed in other ways. The HAC estimator below is a implementation made by <span class="citation" data-cites="zeileis2004">Zeileis (<a href="#ref-zeileis2004" role="doc-biblioref">2004</a>)</span>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb76"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">sandwich</span><span class="fu">::</span><span class="fu"><a href="https://sandwich.R-Forge.R-project.org/reference/vcovHAC.html">vcovHAC</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;                (Intercept) bill_length_mm bill_depth_mm</span></span>
<span><span class="co">#&gt; (Intercept)      46.594526    -0.38006697   -1.74915588</span></span>
<span><span class="co">#&gt; bill_length_mm   -0.380067     0.02178345   -0.02441808</span></span>
<span><span class="co">#&gt; bill_depth_mm    -1.749156    -0.02441808    0.14676678</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="durbin-watson-test" class="level4"><h4 class="anchored" data-anchor-id="durbin-watson-test">Durbin-Watson test</h4>
<p>The <a href="https://en.wikipedia.org/wiki/Durbin%E2%80%93Watson_statistic">Durbin-Watson test</a> is a statistical test used to detect the presence of autocorrelation at lag 1 in the residuals from a regression analysis. The test statistic ranges from 0 to 4, with a value of 2 indicating no autocorrelation. Values less than 2 indicate positive autocorrelation, while values greater than 2 indicate negative autocorrelation <span class="citation" data-cites="fox2016">(<a href="#ref-fox2016" role="doc-biblioref">Fox, 2016</a>)</span>.</p>
<p>A common rule of thumb in the statistical community is that a Durbin-Watson statistic between 1.5 and 2.5 suggests little to no autocorrelation.</p>
<p>Learn more about the Durbin-Watson test in: <span class="citation" data-cites="durbin1950">Durbin &amp; Watson (<a href="#ref-durbin1950" role="doc-biblioref">1950</a>)</span>; <span class="citation" data-cites="durbin1951">Durbin &amp; Watson (<a href="#ref-durbin1951" role="doc-biblioref">1951</a>)</span>; and <span class="citation" data-cites="durbin1971">Durbin &amp; Watson (<a href="#ref-durbin1971" role="doc-biblioref">1971</a>)</span>.</p>
<p><span class="math display">\[
\begin{cases}
\text{H}_{0}: \text{Autocorrelation of the disturbances is 0} \\
\text{H}_{a}: \text{Autocorrelation of the disturbances is not equal to 0}
\end{cases}
\]</span></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb77"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_correlations.html">ols_correlations</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Zero-order"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Partial"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Part"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"0.2982104","2":"0.1942602","3":"0.1837850","_rn_":"bill_length_mm"},{"1":"0.3239430","2":"0.2337652","3":"0.2231289","_rn_":"bill_depth_mm"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb78"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">lmtest</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/dwtest.html">dwtest</a></span><span class="op">(</span><span class="va">fit_engine</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Durbin-Watson test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  fit_engine</span></span>
<span><span class="co">#&gt; DW = 1.5744, p-value = 0.004786</span></span>
<span><span class="co">#&gt; alternative hypothesis: true autocorrelation is greater than 0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb79"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/durbinWatsonTest.html">durbinWatsonTest</a></span><span class="op">(</span><span class="va">fit_engine</span><span class="op">)</span></span>
<span><span class="co">#&gt;  lag Autocorrelation D-W Statistic p-value</span></span>
<span><span class="co">#&gt;    1       0.1951782      1.574424   0.006</span></span>
<span><span class="co">#&gt;  Alternative hypothesis: rho != 0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="ljung-box-test" class="level4"><h4 class="anchored" data-anchor-id="ljung-box-test">Ljung-Box test</h4>
<p>Learn more about the <a href="https://en.wikipedia.org/wiki/Ljung%E2%80%93Box_test">Ljung-Box test</a> in: <span class="citation" data-cites="box1970">Box &amp; Pierce (<a href="#ref-box1970" role="doc-biblioref">1970</a>)</span> and <span class="citation" data-cites="ljung1978">Ljung &amp; Box (<a href="#ref-ljung1978" role="doc-biblioref">1978</a>)</span>.</p>
<p><span class="math display">\[
\begin{cases}
\text{H}_{0}: \text{Residuals are independently distributed} \\
\text{H}_{a}: \text{Residuals are not independently distributed}
\end{cases}
\]</span></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb80"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/box.test.html">Box.test</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"Ljung-Box"</span>, lag <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Box-Ljung test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  stats::residuals(fit_engine)</span></span>
<span><span class="co">#&gt; X-squared = 69.011, df = 10, p-value = 0.0000000000688</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="colinearitymulticollinearity" class="level3"><h3 class="anchored" data-anchor-id="colinearitymulticollinearity">Colinearity/Multicollinearity</h3>
<p>No high degree of colinearity was observed among the independent variables.</p>
<section id="variance-inflation-factor-vif" class="level4"><h4 class="anchored" data-anchor-id="variance-inflation-factor-vif">Variance Inflation Factor (VIF)</h4>
<p>The <a href="https://en.wikipedia.org/wiki/Variance_inflation_factor">Variance Inflation Factor (VIF)</a> indicates the effect of other independent variables on the standard error of a regression coefficient. The VIF is directly related to the tolerance value (<span class="math inline">\(\text{VIF}_{i} = 1/\text{TO}L\)</span>). High VIF values (larger than ~5 <span class="citation" data-cites="struck2024">(@ <a href="#ref-struck2024" role="doc-biblioref">Struck, 2024</a>)</span>) suggest significant collinearity or multicollinearity among the independent variables <span class="citation" data-cites="hair2019">(<a href="#ref-hair2019" role="doc-biblioref">Hair, 2019, p. 265</a>)</span>.</p>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb81"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">diag_sum_plots</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">fit_engine_2</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">performance</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/performance/reference/check_model.html">check_model</a></span><span class="op">(</span>panel <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">rutils</span><span class="fu">:::</span><span class="fu">shush</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">diag_sum_plots</span><span class="op">$</span><span class="va">VIF</span> <span class="op">+</span> </span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="st">"right"</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">11</span>, colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>,</span>
<span>    axis.text <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"gray25"</span><span class="op">)</span>,</span>
<span>    axis.text.y <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span>,</span>
<span>    legend.text <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-model-diag-colinearity-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-model-diag-colinearity-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-85-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-diag-colinearity-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;22: Variance Inflation Factors (VIF) for each predictor variable. VIFs below 5 are considered acceptable. Between 5 and 10, the variable should be examined. Above 10, the variable must considered highly collinear.
</figcaption></figure>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb82"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_coll_diag.html">ols_vif_tol</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-model-residual-diag-colinearity-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-model-residual-diag-colinearity-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;10: Variance Inflation Factors (VIF) and Tolerance values for each predictor variable.
</figcaption><div aria-describedby="tbl-model-residual-diag-colinearity-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Variables"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Tolerance"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["VIF"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"bill_length_mm","2":"0.8393705","3":"1.191369"},{"1":"bill_depth_mm","2":"0.8393705","3":"1.191369"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</figure>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb83"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine_2</span> <span class="op">|&gt;</span> <span class="fu">performance</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/performance/reference/check_collinearity.html">check_collinearity</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["VIF"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["VIF_CI_low"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["VIF_CI_high"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["SE_factor"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Tolerance"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["Tolerance_CI_low"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["Tolerance_CI_high"],"name":[8],"type":["dbl"],"align":["right"]}],"data":[{"1":"bill_length_mm","2":"1.191369","3":"1.06279","4":"1.583244","5":"1.091498","6":"0.8393705","7":"0.6316146","8":"0.9409194"},{"1":"bill_depth_mm","2":"1.191369","3":"1.06279","4":"1.583244","5":"1.091498","6":"0.8393705","7":"0.6316146","8":"0.9409194"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section></section><section id="condition-index" class="level3"><h3 class="anchored" data-anchor-id="condition-index">Condition Index</h3>
<p>The <a href="https://en.wikipedia.org/wiki/Condition_number">condition index</a> is a measure of multicollinearity in a regression model. It is based on the <a href="https://en.wikipedia.org/wiki/Eigenvalues_and_eigenvectors">eigenvalues</a> of the correlation matrix of the predictors. A condition index of 30 or higher is generally considered indicative of significant collinearity <span class="citation" data-cites="belsley2004">(<a href="#ref-belsley2004" role="doc-biblioref">Belsley et al., 2004, pp. 112–114</a>)</span>.</p>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb84"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_coll_diag.html">ols_eigen_cindex</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-model-residual-diag-colinearity-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-model-residual-diag-colinearity-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;11: Condition indexes and eigenvalues for each predictor variable.
</figcaption><div aria-describedby="tbl-model-residual-diag-colinearity-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Eigenvalue"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Condition Index"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["intercept"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["bill_length_mm"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["bill_depth_mm"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"2.995224920","2":"1.00000","3":"0.0003491414","4":"0.0004273801","5":"0.0004086547"},{"1":"0.002687865","2":"33.38190","3":"0.0073431911","4":"0.7897837262","5":"0.6025167582"},{"1":"0.002087215","2":"37.88185","3":"0.9923076674","4":"0.2097888937","5":"0.3970745870"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</figure>
</div>
</section><section id="measures-of-influence" class="level3"><h3 class="anchored" data-anchor-id="measures-of-influence">Measures of influence</h3>
<p>In this section, we will check several measures of influence that can be used to assess the impact of individual observations on the model estimates.</p>
<dl>
<dt>Leverage points</dt>
<dd>
<strong>Leverage</strong> is a measure of the distance between individual values of a predictor and other values of the predictor. In other words, a point with high leverage has an x-value far away from the other x-values. Points with high leverage have the potential to influence our model estimates <span class="citation" data-cites="struck2024 hair2019">(<a href="#ref-hair2019" role="doc-biblioref">Hair, 2019, p. 262</a>; <a href="#ref-struck2024" role="doc-biblioref">Struck, 2024</a>)</span>.
</dd>
<dt>Influence points</dt>
<dd>
<strong>Influence</strong> is a measure of how much an observation affects the model estimates. If an observation with large influence were removed from the dataset, we would expect a large change in the predictive equation <span class="citation" data-cites="struck2024">(<a href="#ref-struck2024" role="doc-biblioref">Struck, 2024</a>)</span>.
</dd>
</dl>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb85"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">hatvalues</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;           1           2           3           4           5           6 </span></span>
<span><span class="co">#&gt; 0.007224717 0.013540911 0.011133950 0.020284125 0.031778182 0.008464034</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="cooks-distance-1" class="level4"><h4 class="anchored" data-anchor-id="cooks-distance-1">Cook’s distance</h4>
<p>The <a href="https://en.wikipedia.org/wiki/Cook%27s_distance">Cook’s D</a> measures each observation’s influence on the model’s fitted values. It is considered one of the most representative metrics for assessing overall influence <span class="citation" data-cites="hair2019">(<a href="#ref-hair2019" role="doc-biblioref">Hair, 2019</a>)</span>.</p>
<p>A common practice is to flag observations with a Cook’s distance of 1.0 or greater. However, a more conservative threshold of <span class="math inline">\(4 / (n - k - 1)\)</span>, where <span class="math inline">\(n\)</span> is the sample size and <span class="math inline">\(k\)</span> is the number of independent variables, is suggested as a more conservative measure in small samples or for use with larger datasets <span class="citation" data-cites="hair2019">(<a href="#ref-hair2019" role="doc-biblioref">Hair, 2019</a>)</span>.</p>
<p>Learn more about Cook’s D in: <span class="citation" data-cites="cook1977">Cook (<a href="#ref-cook1977" role="doc-biblioref">1977</a>)</span>; <span class="citation" data-cites="cook1979">Cook (<a href="#ref-cook1979" role="doc-biblioref">1979</a>)</span>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb86"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">cooks.distance</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;           1           2           3           4           5           6 </span></span>
<span><span class="co">#&gt; 0.006172316 0.001167497 0.002562303 0.001761909 0.002766625 0.005471884</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb87"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot</span> <span class="op">&lt;-</span> <span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_plot_cooksd_bar.html">ols_plot_cooksd_bar</a></span><span class="op">(</span>print_plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">q</span> <span class="op">&lt;-</span> <span class="va">plot</span><span class="op">$</span><span class="va">plot</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">q</span> <span class="op">&lt;-</span> <span class="va">q</span> <span class="op">|&gt;</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot_build.html">ggplot_build</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">q</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">label</span> <span class="op">&lt;-</span> <span class="st">""</span></span>
<span></span>
<span><span class="va">q</span> <span class="op">|&gt;</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot_gtable.html">ggplot_gtable</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">ggplotify</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggplotify/man/as.ggplot.html">as.ggplot</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-91-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb88"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">diag_sum_plots</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">fit_engine_2</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">performance</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/performance/reference/check_model.html">check_model</a></span><span class="op">(</span></span>
<span>    panel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"black"</span>, <span class="st">"black"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">rutils</span><span class="fu">:::</span><span class="fu">shush</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">diag_sum_plots</span><span class="op">$</span><span class="va">OUTLIERS</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="st">"right"</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">11</span>, colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>,</span>
<span>    axis.text <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"gray25"</span><span class="op">)</span>,</span>
<span>    axis.text.y <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_gray</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot</span> <span class="op">&lt;-</span> <span class="va">plot</span> <span class="op">|&gt;</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot_build.html">ggplot_build</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># "#1b6ca8" "#3aaf85"</span></span>
<span>  <span class="va">plot</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">colour</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>    <span class="va">plot</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">colour</span> <span class="op">==</span> <span class="st">"blue"</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">i</span> <span class="op">==</span> <span class="fl">4</span>, <span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span>,</span>
<span>    <span class="va">plot</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">colour</span> <span class="op">==</span> <span class="st">"#1b6ca8"</span> <span class="op">~</span> <span class="st">"black"</span>,</span>
<span>    <span class="va">plot</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">colour</span> <span class="op">==</span> <span class="st">"darkgray"</span> <span class="op">~</span> <span class="st">"black"</span>,</span>
<span>    <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">plot</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">colour</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">plot</span> <span class="op">|&gt;</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot_gtable.html">ggplot_gtable</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">ggplotify</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggplotify/man/as.ggplot.html">as.ggplot</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-model-diag-influence-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-model-diag-influence-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-92-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-diag-influence-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;23: Influential observations. The blue line represents the <a href="https://en.wikipedia.org/wiki/Cook%27s_distance">Cook’s distance</a>. Any points outside the contour lines are influential observations.
</figcaption></figure>
</div>
</section><section id="influence-on-prediction-dffits" class="level4"><h4 class="anchored" data-anchor-id="influence-on-prediction-dffits">Influence on prediction (DFFITS)</h4>
<p><a href="https://en.wikipedia.org/wiki/DFFITS">DFFITS</a> (difference in fits) is a standardized measure of how much the prediction for a given observation would change if it were deleted from the model. Each observation’s DFFITS is standardized by the standard deviation of fit at that point <span class="citation" data-cites="struck2024">(<a href="#ref-struck2024" role="doc-biblioref">Struck, 2024</a>)</span>.</p>
<p>Learn more about DDFITS in: <span class="citation" data-cites="welsch1977">Welsch &amp; Kuh (<a href="#ref-welsch1977" role="doc-biblioref">1977</a>)</span> and <span class="citation" data-cites="belsley2004">Belsley et al. (<a href="#ref-belsley2004" role="doc-biblioref">2004</a>)</span>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb89"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">dffits</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;           1           2           3           4           5           6 </span></span>
<span><span class="co">#&gt; -0.13680251 -0.05903146  0.08757991  0.07251828 -0.09087143 -0.12853052</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb90"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_plot_dffits.html">ols_plot_dffits</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-94-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="influence-on-parameter-estimates-dfbetas" class="level4"><h4 class="anchored" data-anchor-id="influence-on-parameter-estimates-dfbetas">Influence on parameter estimates (DFBETAS)</h4>
<p><a href="https://en.wikipedia.org/wiki/Influential_observation#:~:text=measures%20of%20influence">DFBETAS</a> are standardized differences between regression coefficients in a model with a given observation, and a model without that observation. DFBETAS are standardized by the standard error of the coefficient.</p>
<p>Learn more about DFBETAS in: <span class="citation" data-cites="welsch1977">Welsch &amp; Kuh (<a href="#ref-welsch1977" role="doc-biblioref">1977</a>)</span> and <span class="citation" data-cites="belsley2004">Belsley et al. (<a href="#ref-belsley2004" role="doc-biblioref">2004</a>)</span>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb91"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">dfbeta</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;   (Intercept) bill_length_mm bill_depth_mm</span></span>
<span><span class="co">#&gt; 1  0.22258769  -0.0004349836   -0.01466395</span></span>
<span><span class="co">#&gt; 2 -0.13256789  -0.0054345035    0.01760713</span></span>
<span><span class="co">#&gt; 3 -0.06441232   0.0104695960   -0.01681191</span></span>
<span><span class="co">#&gt; 4  0.01139718  -0.0100344675    0.02167424</span></span>
<span><span class="co">#&gt; 5  0.43219781   0.0049023858   -0.03501141</span></span>
<span><span class="co">#&gt; 6 -0.29541826  -0.0058849442    0.02552779</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb92"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plots</span> <span class="op">&lt;-</span> <span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_plot_dfbetas.html">ols_plot_dfbetas</a></span><span class="op">(</span>print_plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb93"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plots</span><span class="op">$</span><span class="va">plots</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-97-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb94"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plots</span><span class="op">$</span><span class="va">plots</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-98-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb95"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plots</span><span class="op">$</span><span class="va">plots</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-99-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb96"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">dffits</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;           1           2           3           4           5           6 </span></span>
<span><span class="co">#&gt; -0.13680251 -0.05903146  0.08757991  0.07251828 -0.09087143 -0.12853052</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="studentized-residuals" class="level4"><h4 class="anchored" data-anchor-id="studentized-residuals">Studentized residuals</h4>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb97"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">rstandard</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;          1          2          3          4          5          6 </span></span>
<span><span class="co">#&gt; -1.5951436 -0.5051311  0.8262662  0.5052708 -0.5028734 -1.3867386</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb98"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">rstudent</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;          1          2          3          4          5          6 </span></span>
<span><span class="co">#&gt; -1.6036484 -0.5038475  0.8253699  0.5039871 -0.5015916 -1.3911431</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><a href="https://olsrr.rsquaredacademy.com/articles/influence_measures#studentized-residual-plot">Studentized Residual Plot</a></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb99"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_plot_resid_stud.html">ols_plot_resid_stud</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-103-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><a href="https://olsrr.rsquaredacademy.com/articles/influence_measures#standardized-residual-chart">Standardized Residual Chart</a></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb100"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_plot_resid_stand.html">ols_plot_resid_stand</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-104-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><a href="https://olsrr.rsquaredacademy.com/articles/influence_measures#standardized-residual-chart">Studentized Residuals vs Leverage Plot</a></p>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb101"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_plot_resid_lev.html">ols_plot_resid_lev</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-model-residual-diag-leverage" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-model-residual-diag-leverage-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-105-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-residual-diag-leverage-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;24: Relation between the model studentized residuals and their leverage/influence points.
</figcaption></figure>
</div>
<p><a href="https://olsrr.rsquaredacademy.com/articles/influence_measures#standardized-residual-chart">Deleted Studentized Residual vs Fitted Values Plot</a></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb102"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_plot_resid_stud_fit.html">ols_plot_resid_stud_fit</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-106-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="hadi-plot" class="level4"><h4 class="anchored" data-anchor-id="hadi-plot">Hadi plot</h4>
<p><a href="https://olsrr.rsquaredacademy.com/articles/influence_measures#hadi-plot">Hadi Plot</a></p>
<p>Learn more about Hadi’s influence measure in: <span class="citation" data-cites="chatterjee2012">Chatterjee &amp; Hadi (<a href="#ref-chatterjee2012" role="doc-biblioref">2012</a>)</span>.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb103"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_plot_hadi.html">ols_plot_hadi</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-107-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><a href="https://olsrr.rsquaredacademy.com/articles/influence_measures#hadi-plot">Potential Residual Plot</a></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb104"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_plot_resid_pot.html">ols_plot_resid_pot</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-108-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section></section><section id="testing-the-hypothesis" class="level2"><h2 class="anchored" data-anchor-id="testing-the-hypothesis">Testing the hypothesis</h2>
<p>Let’s now come back to our initial hypothesis:</p>
<dl>
<dt><strong>Statement</strong></dt>
<dd>
The predictors <code>bill_length_mm</code> and <code>bill_depth_mm</code> effectively predict <code>flipper_length_mm</code>.
</dd>
</dl>
<p><span class="math display">\[
\begin{cases}
\text{H}_{0}: \text{R}^{2}_{\text{adj}} \leq 0.5 \\
\text{H}_{a}: \text{R}^{2}_{\text{adj}} &gt; 0.5
\end{cases}
\]</span></p>
<p>Beyond a <span class="math inline">\(\text{R}^{2}_{\text{adj}}\)</span> over 0.5, predictor effects must be statistically significant, and model assumptions should be met.</p>
<p>In the sections above, we have shown that the model meets the assumptions of linearity, normality, homoscedasticity, and independence. (<strong>Model validity requirement</strong>: True)</p>
<p>The table below shows that the predictors <code>bill_length_mm</code> and <code>bill_depth_mm</code> are statistically significant in predicting <code>flipper_length_mm</code>. (<strong>Predictor significance requirement</strong>: True)</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb105"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/adorn_rounding.html">adorn_rounding</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"(Intercept)","2":"147.83577","3":"8.65123","4":"17.08841","5":"0.00000"},{"1":"bill_length_mm","2":"0.48324","3":"0.20126","4":"2.40102","5":"0.01760"},{"1":"bill_depth_mm","2":"1.26744","3":"0.43480","4":"2.91502","5":"0.00411"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Now let’s check the adjusted <span class="math inline">\(R^{2}\)</span> value to see if it is greater than 0.5. We can see in the table below that the adjusted <span class="math inline">\(R^{2}\)</span> is lower than 0.5 (0.127, which means that the model does not explain more than 50% of the variance in the dependent variable. So <strong>we must reject the alternative hypothesis in favor of the null hypothesis</strong>. (<strong>Adjusted R squared requirement</strong>: False)</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb106"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html">glance</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/adorn_rounding.html">adorn_rounding</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["value"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"r.squared","2":"0.1387159862"},{"1":"adj.r.squared","2":"0.1269978363"},{"1":"sigma","2":"5.9341267735"},{"1":"statistic","2":"11.8377037290"},{"1":"p.value","2":"0.0000171104"},{"1":"df","2":"2.0000000000"},{"1":"logLik","2":"-478.4335597668"},{"1":"AIC","2":"964.8671195337"},{"1":"BIC","2":"976.9096607101"},{"1":"deviance","2":"5176.4375029678"},{"1":"df.residual","2":"147.0000000000"},{"1":"nobs","2":"150.0000000000"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb107"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># LCL = Lower Confidence Limit</span></span>
<span><span class="co"># UCL = Upper Confidence Limit</span></span>
<span></span>
<span><span class="fu">psychometric</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/psychometric/man/CI.Rsq.html">CI.Rsq</a></span><span class="op">(</span></span>
<span>  rsq <span class="op">=</span> <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html">glance</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">$</span><span class="va">adj.r.squared</span>,</span>
<span>  n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>,</span>
<span>  k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">fit_engine</span><span class="op">$</span><span class="va">coefficients</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>,</span>
<span>  level <span class="op">=</span> <span class="fl">0.95</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Rsq"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["SErsq"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["LCL"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["UCL"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"0.1269978","2":"0.04929848","3":"0.0303746","4":"0.2236211"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>If we would like to interpret the adjusted <span class="math inline">\(R^{2}\)</span> value in terms of effect size, we can use the following code:</p>
<!-- @cohen1988 -->
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb108"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html">glance</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html">extract2</a></span><span class="op">(</span><span class="st">"adj.r.squared"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">effectsize</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/effectsize/reference/interpret_r2.html">interpret_r2</a></span><span class="op">(</span><span class="st">"cohen1988"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "weak"</span></span>
<span><span class="co">#&gt; (Rules: cohen1988)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<!-- @falk1992 -->
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb109"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html">glance</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html">extract2</a></span><span class="op">(</span><span class="st">"adj.r.squared"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">effectsize</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/effectsize/reference/interpret_r2.html">interpret_r2</a></span><span class="op">(</span><span class="st">"falk1992"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "adequate"</span></span>
<span><span class="co">#&gt; (Rules: falk1992)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="conclusion" class="level2"><h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>Following our criteria we can now answer our question:</p>
<p><strong>Can bill length and bill depth alone effectively predict flipper length in Adélie penguins?</strong></p>
<p>The answer is <strong>No</strong>. The model does not explain more than 50% of the variance in the dependent variable, which means that the predictors <code>bill_length_mm</code> and <code>bill_depth_mm</code> are not effective in predicting <code>flipper_length_mm</code>.</p>
</section><section id="notes" class="level2"><h2 class="anchored" data-anchor-id="notes">Notes</h2>
<p>Before using objective assumption tests (e.g., Anderson–Darling test), it’s important to note that they may be not advisable in some contexts. In larger samples, these tests can be overly sensitive to minor deviations, while in smaller samples, they may not detect significant deviations. Additionally, they might overlook visual patterns that are not captured by a single metric. Therefore, visual assessment of diagnostic plots may be a better way <span class="citation" data-cites="shatz2024 kozak2018 schucany2006">(<a href="#ref-kozak2018" role="doc-biblioref">Kozak &amp; Piepho, 2018</a>; <a href="#ref-schucany2006" role="doc-biblioref">Schucany &amp; Ng, 2006</a>; <a href="#ref-shatz2024" role="doc-biblioref">Shatz, 2024</a>)</span>. For a straightforward critique of normality tests specifically, refer to <a href="https://towardsdatascience.com/stop-testing-for-normality-dba96bb73f90">this</a> article by <span class="citation" data-cites="greener2020">Greener (<a href="#ref-greener2020" role="doc-biblioref">2020</a>)</span>.</p>
<p>I hope you like this report. If you have any questions, please feel free to ask. You can find me on <a href="https://github.com/danielvartan">GitHub</a>.</p>
</section><section id="further-reading" class="level2"><h2 class="anchored" data-anchor-id="further-reading">Further reading</h2>
<p>I recommend the following resources for further reading:</p>
<ul>
<li><span class="citation" data-cites="allen1997">Allen (<a href="#ref-allen1997" role="doc-biblioref">1997</a>)</span></li>
<li>
<span class="citation" data-cites="bussab1988">Bussab (<a href="#ref-bussab1988" role="doc-biblioref">1988</a>)</span> (pt-BR)</li>
<li><span class="citation" data-cites="casella2002">Casella &amp; Berger (<a href="#ref-casella2002" role="doc-biblioref">2002</a>)</span></li>
<li><span class="citation" data-cites="dalpiaz">Dalpiaz (<a href="#ref-dalpiaz" role="doc-biblioref">n.d.</a>)</span></li>
<li><span class="citation" data-cites="degroot2012">DeGroot &amp; Schervish (<a href="#ref-degroot2012" role="doc-biblioref">2012</a>)</span></li>
<li><span class="citation" data-cites="dudek2020">Dudek (<a href="#ref-dudek2020" role="doc-biblioref">2020</a>)</span></li>
<li><span class="citation" data-cites="fox2016">Fox (<a href="#ref-fox2016" role="doc-biblioref">2016</a>)</span></li>
<li><span class="citation" data-cites="hair2019">Hair (<a href="#ref-hair2019" role="doc-biblioref">2019</a>)</span></li>
<li><span class="citation" data-cites="johnson2013">Johnson &amp; Wichern (<a href="#ref-johnson2013" role="doc-biblioref">2013</a>)</span></li>
<li><span class="citation" data-cites="kuhn2022">Kuhn &amp; Silge (<a href="#ref-kuhn2022" role="doc-biblioref">2022</a>)</span></li>
<li><span class="citation" data-cites="struck2024">Struck (<a href="#ref-struck2024" role="doc-biblioref">2024</a>)</span></li>
</ul>
<p>I also highly recommend Josh Starmer’s <a href="https://www.youtube.com/@statquest">StatQuest</a> channel. The following videos are particularly helpful:</p>
<ul>
<li>Starmer, J. (Nov 18, 2022). <em>Multiple Regression, Clearly Explained!!!</em> [YouTube video]. <a href="https://youtu.be/EkAQAi3a4js?si=MfKPGlFcYqfFAM7j">https://youtu.be/EkAQAi3a4js?si=MfKPGlFcYqfFAM7j</a>
</li>
<li>Starmer, J. (Nov 18, 2022). <em>Multiple Regression in R, Step by Step!!!</em> [YouTube video]. <a href="https://youtu.be/mno47Jn4gaU?si=oba5odJm8fjeizs0">https://youtu.be/mno47Jn4gaU?si=oba5odJm8fjeizs0</a>
</li>
</ul></section><section id="references" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="references">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-allen1997" class="csl-entry" role="listitem">
Allen, M. P. (1997). <em>Understanding regression analysis</em>. Plenum Press.
</div>
<div id="ref-anderson1962" class="csl-entry" role="listitem">
Anderson, T. W. (1962). On the distribution of the two-sample <span class="nocase">Cramer-von Mises</span> criterion. <em>The Annals of Mathematical Statistics</em>, <em>33</em>(3), 1148–1159. <a href="https://doi.org/10.1214/aoms/1177704477">https://doi.org/10.1214/aoms/1177704477</a>
</div>
<div id="ref-anderson1952" class="csl-entry" role="listitem">
Anderson, T. W., &amp; Darling, D. A. (1952). Asymptotic theory of certain "goodness of fit" criteria based on stochastic processes. <em>The Annals of Mathematical Statistics</em>, <em>23</em>(2), 193–212. <a href="https://www.jstor.org/stable/2236446">https://www.jstor.org/stable/2236446</a>
</div>
<div id="ref-anderson1954" class="csl-entry" role="listitem">
Anderson, T. W., &amp; Darling, D. A. (1954). A test of goodness of fit. <em>Journal of the American Statistical Association</em>, <em>49</em>(268), 765–769. <a href="https://doi.org/10.1080/01621459.1954.10501232">https://doi.org/10.1080/01621459.1954.10501232</a>
</div>
<div id="ref-arif2022" class="csl-entry" role="listitem">
Arif, S., &amp; MacNeil, M. A. (2022). Predictive models aren’t for causal inference. <em>Ecology Letters</em>, <em>25</em>(8), 1741–1745. <a href="https://doi.org/10.1111/ele.14033">https://doi.org/10.1111/ele.14033</a>
</div>
<div id="ref-belsley2004" class="csl-entry" role="listitem">
Belsley, D. A., Kuh, E., &amp; Welsch, R. E. (2004). <em>Regression diagnostics: Identifying influential data and sources of collinearity</em>. John Wiley &amp; Sons. <a href="https://doi.org/10.1002/0471725153">https://doi.org/10.1002/0471725153</a>
</div>
<div id="ref-bera1981" class="csl-entry" role="listitem">
Bera, A. K., &amp; Jarque, C. M. (1981). Efficient tests for normality, homoscedasticity and serial independence of regression residuals: <span>Monte Carlo Evidence</span>. <em>Economics Letters</em>, <em>7</em>(4), 313–318. <a href="https://doi.org/10.1016/0165-1765(81)90035-5">https://doi.org/10.1016/0165-1765(81)90035-5</a>
</div>
<div id="ref-bonett2002" class="csl-entry" role="listitem">
Bonett, D. G., &amp; Seier, E. (2002). A test of normality with high uniform power. <em>Computational Statistics &amp; Data Analysis</em>, <em>40</em>(3), 435–445. <a href="https://doi.org/10.1016/S0167-9473(02)00074-9">https://doi.org/10.1016/S0167-9473(02)00074-9</a>
</div>
<div id="ref-box1970" class="csl-entry" role="listitem">
Box, G. E. P., &amp; Pierce, D. A. (1970). Distribution of residual autocorrelations in autoregressive-integrated moving average time series models. <em>Journal of the American Statistical Association</em>, <em>65</em>(332), 1509–1526. <a href="https://doi.org/10.1080/01621459.1970.10481180">https://doi.org/10.1080/01621459.1970.10481180</a>
</div>
<div id="ref-breusch1979" class="csl-entry" role="listitem">
Breusch, T. S., &amp; Pagan, A. R. (1979). A simple test for heteroscedasticity and random coefficient variation. <em>Econometrica</em>, <em>47</em>(5), 1287–1294. <a href="https://doi.org/10.2307/1911963">https://doi.org/10.2307/1911963</a>
</div>
<div id="ref-bussab1988" class="csl-entry" role="listitem">
Bussab, W. de O. (1988). <em>Análise de variância e de regressão: uma introdução</em> (2nd ed.). Atlas.
</div>
<div id="ref-casella2002" class="csl-entry" role="listitem">
Casella, G., &amp; Berger, R. L. (2002). <em>Statistical inference</em> (2nd ed.). Duxbury.
</div>
<div id="ref-chatterjee2012" class="csl-entry" role="listitem">
Chatterjee, S., &amp; Hadi, A. S. (2012). <em>Regression analysis by example</em> (5th ed.). Wiley.
</div>
<div id="ref-cohen2002" class="csl-entry" role="listitem">
Cohen, J., Cohen, P., West, S. G., &amp; Aiken, L. S. (2002). <em>Applied multiple regression/correlation analysis for the behavioral sciences</em> (3rd ed.). Lawrence Erlbaum Associates.
</div>
<div id="ref-cook1977" class="csl-entry" role="listitem">
Cook, R. D. (1977). Detection of influential observation in linear regression. <em>Technometrics</em>, <em>19</em>(1), 15–18. <a href="https://doi.org/10.1080/00401706.1977.10489493">https://doi.org/10.1080/00401706.1977.10489493</a>
</div>
<div id="ref-cook1979" class="csl-entry" role="listitem">
Cook, R. D. (1979). Influential observations in linear regression. <em>Journal of the American Statistical Association</em>, <em>74</em>(365), 169–174. <a href="https://doi.org/10.1080/01621459.1979.10481634">https://doi.org/10.1080/01621459.1979.10481634</a>
</div>
<div id="ref-cramer1928" class="csl-entry" role="listitem">
Cramér, H. (1928). On the composition of elementary errors: <span>First</span> paper: <span>Mathematical</span> deductions. <em>Scandinavian Actuarial Journal</em>, <em>1928</em>(1), 13–74. <a href="https://doi.org/10.1080/03461238.1928.10416862">https://doi.org/10.1080/03461238.1928.10416862</a>
</div>
<div id="ref-dagostino1971" class="csl-entry" role="listitem">
D’Agostino, R. B. (1971). An omnibus test of normality for moderate and large size samples. <em>Biometrika</em>, <em>58</em>(2), 341–348. <a href="https://doi.org/10.1093/biomet/58.2.341">https://doi.org/10.1093/biomet/58.2.341</a>
</div>
<div id="ref-dagostino1990" class="csl-entry" role="listitem">
D’Agostino, R. B., &amp; Belanger, A. (1990). A suggestion for using powerful and informative tests of normality. <em>The American Statistician</em>, <em>44</em>(4), 316–321. <a href="https://doi.org/10.2307/2684359">https://doi.org/10.2307/2684359</a>
</div>
<div id="ref-dagostino1973" class="csl-entry" role="listitem">
D’Agostino, R. B., &amp; Pearson, E. S. (1973). Tests for departure from normality. <span>Empirical</span> results for the distributions of b2 and √b1. <em>Biometrika</em>, <em>60</em>(3), 613–622. <a href="https://doi.org/10.1093/biomet/60.3.613">https://doi.org/10.1093/biomet/60.3.613</a>
</div>
<div id="ref-dallal1986" class="csl-entry" role="listitem">
Dallal, G. E., &amp; Wilkinson, L. (1986). An analytic approximation to the distribution of <span>Lilliefors</span>’s test statistic for normality. <em>The American Statistician</em>, <em>40</em>(4), 294–296. <a href="https://doi.org/10.1080/00031305.1986.10475419">https://doi.org/10.1080/00031305.1986.10475419</a>
</div>
<div id="ref-dalpiaz" class="csl-entry" role="listitem">
Dalpiaz, D. (n.d.). <em>Applied statistics with <span>R</span></em>. <a href="https://book.stat420.org/">https://book.stat420.org/</a>
</div>
<div id="ref-degroot2012" class="csl-entry" role="listitem">
DeGroot, M. H., &amp; Schervish, M. J. (2012). <em>Probability and statistics</em> (4th ed.). Addison-Wesley.
</div>
<div id="ref-dudek2020" class="csl-entry" role="listitem">
Dudek, B. (2020). <em>Linear models with <span>R</span>: Emphasis on 2-<span>IV</span> models: Basics of multiple regression</em>. <a href="https://bcdudek.net/regression1/">https://bcdudek.net/regression1/</a>
</div>
<div id="ref-durbin1950" class="csl-entry" role="listitem">
Durbin, J., &amp; Watson, G. S. (1950). Testing for serial correlation in least squares regression. <span>I</span>. <em>Biometrika</em>, <em>37</em>(3-4), 409–428. <a href="https://doi.org/10.1093/biomet/37.3-4.409">https://doi.org/10.1093/biomet/37.3-4.409</a>
</div>
<div id="ref-durbin1951" class="csl-entry" role="listitem">
Durbin, J., &amp; Watson, G. S. (1951). Testing for serial correlation in least squares regression. <span>II</span>. <em>Biometrika</em>, <em>38</em>(1-2), 159–178. <a href="https://doi.org/10.1093/biomet/38.1-2.159">https://doi.org/10.1093/biomet/38.1-2.159</a>
</div>
<div id="ref-durbin1971" class="csl-entry" role="listitem">
Durbin, J., &amp; Watson, G. S. (1971). Testing for serial correlation in least squares regression. <span>III</span>. <em>Biometrika</em>, <em>58</em>(1), 1–19. <a href="https://doi.org/10.1093/biomet/58.1.1">https://doi.org/10.1093/biomet/58.1.1</a>
</div>
<div id="ref-fox2016" class="csl-entry" role="listitem">
Fox, J. (2016). <em>Applied regression analysis and generalized linear models</em> (3rd ed.). Sage.
</div>
<div id="ref-gorman2014" class="csl-entry" role="listitem">
Gorman, K. B., Williams, T. D., &amp; Fraser, W. R. (2014). Ecological sexual dimorphism and environmental variability within a community of antarctic penguins (genus pygoscelis). <em>PLOS ONE</em>, <em>9</em>(3), e90081. <a href="https://doi.org/10.1371/journal.pone.0090081">https://doi.org/10.1371/journal.pone.0090081</a>
</div>
<div id="ref-greener2020" class="csl-entry" role="listitem">
Greener, R. (2020, August 4). <em>Stop testing for normality</em>. Medium. <a href="https://towardsdatascience.com/stop-testing-for-normality-dba96bb73f90">https://towardsdatascience.com/stop-testing-for-normality-dba96bb73f90</a>
</div>
<div id="ref-hair2019" class="csl-entry" role="listitem">
Hair, J. F. (2019). <em>Multivariate data analysis</em> (8th ed.). Cengage.
</div>
<div id="ref-jarque1980" class="csl-entry" role="listitem">
Jarque, C. M., &amp; Bera, A. K. (1980). Efficient tests for normality, homoscedasticity and serial independence of regression residuals. <em>Economics Letters</em>, <em>6</em>(3), 255–259. <a href="https://doi.org/10.1016/0165-1765(80)90024-5">https://doi.org/10.1016/0165-1765(80)90024-5</a>
</div>
<div id="ref-jarque1987" class="csl-entry" role="listitem">
Jarque, C. M., &amp; Bera, A. K. (1987). A test for normality of observations and regression residuals. <em>International Statistical Review</em>, <em>55</em>(2), 163–172. <a href="https://doi.org/10.2307/1403192">https://doi.org/10.2307/1403192</a>
</div>
<div id="ref-johnson2013" class="csl-entry" role="listitem">
Johnson, R., &amp; Wichern, D. (2013). <em>Applied multivariate statistical analysis: <span>Pearson</span> new international edition</em> (6th ed.). Pearson.
</div>
<div id="ref-koenker1981" class="csl-entry" role="listitem">
Koenker, R. (1981). A note on studentizing a test for heteroscedasticity. <em>Journal of Econometrics</em>, <em>17</em>(1), 107–112. <a href="https://doi.org/10.1016/0304-4076(81)90062-2">https://doi.org/10.1016/0304-4076(81)90062-2</a>
</div>
<div id="ref-kolmogorov1933" class="csl-entry" role="listitem">
Kolmogorov, A. (1933). Sulla determinazione empirica di una legge di distribuzione. <em>Giornale dell’Istituto Italiano degli Attuari</em>, <em>4</em>.
</div>
<div id="ref-kozak2018" class="csl-entry" role="listitem">
Kozak, M., &amp; Piepho, H.-P. (2018). What’s normal anyway? <span>Residual</span> plots are more telling than significance tests when checking <span>ANOVA</span> assumptions. <em>Journal of Agronomy and Crop Science</em>, <em>204</em>(1), 86–98. <a href="https://doi.org/10.1111/jac.12220">https://doi.org/10.1111/jac.12220</a>
</div>
<div id="ref-kuhn2022" class="csl-entry" role="listitem">
Kuhn, M., &amp; Silge, J. (2022). <em>Tidy modeling with <span>R</span>: A framework for modeling in the tidyverse</em>. O’Reilly Media. <a href="https://www.tmwr.org/">https://www.tmwr.org/</a>
</div>
<div id="ref-lilliefors1967" class="csl-entry" role="listitem">
Lilliefors, H. W. (1967). On the <span>Kolmogorov-Smirnov</span> test for normality with mean and variance unknown. <em>Journal of the American Statistical Association</em>, <em>62</em>(318), 399–402. <a href="https://doi.org/10.1080/01621459.1967.10482916">https://doi.org/10.1080/01621459.1967.10482916</a>
</div>
<div id="ref-ljung1978" class="csl-entry" role="listitem">
Ljung, G. M., &amp; Box, G. E. P. (1978). On a measure of lack of fit in time series models. <em>Biometrika</em>, <em>65</em>(2), 297–303. <a href="https://doi.org/10.1093/biomet/65.2.297">https://doi.org/10.1093/biomet/65.2.297</a>
</div>
<div id="ref-massey1951" class="csl-entry" role="listitem">
Massey, F. J. (1951). The <span>Kolmogorov-Smirnov</span> test for goodness of fit. <em>Journal of the American Statistical Association</em>, <em>46</em>(253), 68–78. <a href="https://doi.org/10.1080/01621459.1951.10500769">https://doi.org/10.1080/01621459.1951.10500769</a>
</div>
<div id="ref-newey1987" class="csl-entry" role="listitem">
Newey, W. K., &amp; West, K. D. (1987). A simple, positive semi-definite, heteroskedasticity and autocorrelation consistent covariance matrix. <em>Econometrica</em>, <em>55</em>(3), 703–708. <a href="https://doi.org/10.2307/1913610">https://doi.org/10.2307/1913610</a>
</div>
<div id="ref-newey1994" class="csl-entry" role="listitem">
Newey, W. K., &amp; West, K. D. (1994). Automatic lag selection in covariance matrix estimation. <em>The Review of Economic Studies</em>, <em>61</em>(4), 631–653. <a href="https://doi.org/10.2307/2297912">https://doi.org/10.2307/2297912</a>
</div>
<div id="ref-neyman1928" class="csl-entry" role="listitem">
Neyman, J., &amp; Pearson, E. S. (1928a). On the use and interpretation of certain test criteria for purposes of statistical inference: Part <span>I</span>. <em>Biometrika</em>, <em>20A</em>(1/2), 175–240. <a href="https://doi.org/10.2307/2331945">https://doi.org/10.2307/2331945</a>
</div>
<div id="ref-neyman1928a" class="csl-entry" role="listitem">
Neyman, J., &amp; Pearson, E. S. (1928b). On the use and interpretation of certain test criteria for purposes of statistical inference: Part <span>II</span>. <em>Biometrika</em>, <em>20A</em>(3/4), 263–294. <a href="https://doi.org/10.2307/2332112">https://doi.org/10.2307/2332112</a>
</div>
<div id="ref-pearson1900" class="csl-entry" role="listitem">
Pearson, K. (1900). X. <span>On</span> the criterion that a given system of deviations from the probable in the case of a correlated system of variables is such that it can be reasonably supposed to have arisen from random sampling. <em>The London, Edinburgh, and Dublin Philosophical Magazine and Journal of Science</em>, <em>50</em>(302), 157–175. <a href="https://doi.org/10.1080/14786440009463897">https://doi.org/10.1080/14786440009463897</a>
</div>
<div id="ref-peek2003" class="csl-entry" role="listitem">
Peek, M. S., Leffler, A. J., Flint, S. D., &amp; Ryel, R. J. (2003). How much variance is explained by ecologists? <span>Additional</span> perspectives. <em>Oecologia</em>, <em>137</em>(2), 161–170. <a href="https://www.jstor.org/stable/4223745">https://www.jstor.org/stable/4223745</a>
</div>
<div id="ref-perezgonzalez2015" class="csl-entry" role="listitem">
Perezgonzalez, J. D. (2015). Fisher, <span>Neyman-Pearson</span> or <span>NHST</span>? <span>A</span> tutorial for teaching data testing. <em>Frontiers in Psychology</em>, <em>6</em>. <a href="https://doi.org/10.3389/fpsyg.2015.00223">https://doi.org/10.3389/fpsyg.2015.00223</a>
</div>
<div id="ref-popper1979" class="csl-entry" role="listitem">
Popper, K. R. (1979). <em>Objective knowledge: An evolutionary approach</em>. Oxford University Press.
</div>
<div id="ref-ramsey1969" class="csl-entry" role="listitem">
Ramsey, J. B. (1969). Tests for specification errors in classical linear least-squares regression analysis. <em>Journal of the Royal Statistical Society. Series B (Methodological)</em>, <em>31</em>(2), 350–371. <a href="https://doi.org/10.1111/j.2517-6161.1969.tb00796.x">https://doi.org/10.1111/j.2517-6161.1969.tb00796.x</a>
</div>
<div id="ref-schucany2006" class="csl-entry" role="listitem">
Schucany, W. R., &amp; Ng, H. K. T. (2006). Preliminary goodness-of-fit tests for normality do not validate the one-sample <span>Student</span> t. <em>Communications in Statistics - Theory and Methods</em>, <em>35</em>(12), 2275–2286. <a href="https://doi.org/10.1080/03610920600853308">https://doi.org/10.1080/03610920600853308</a>
</div>
<div id="ref-shapiro1972" class="csl-entry" role="listitem">
Shapiro, S. S., &amp; Francia, R. S. (1972). An approximate analysis of variance test for normality. <em>Journal of the American Statistical Association</em>, <em>67</em>(337), 215–216. <a href="https://doi.org/10.1080/01621459.1972.10481232">https://doi.org/10.1080/01621459.1972.10481232</a>
</div>
<div id="ref-shapiro1965" class="csl-entry" role="listitem">
Shapiro, S. S., &amp; Wilk, M. B. (1965). An analysis of variance test for normality (complete samples)†. <em>Biometrika</em>, <em>52</em>(3-4), 591–611. <a href="https://doi.org/10.1093/biomet/52.3-4.591">https://doi.org/10.1093/biomet/52.3-4.591</a>
</div>
<div id="ref-shatz2024" class="csl-entry" role="listitem">
Shatz, I. (2024). Assumption-checking rather than (just) testing: The importance of visualization and effect size in statistical diagnostics. <em>Behavior Research Methods</em>, <em>56</em>(2), 826–845. <a href="https://doi.org/10.3758/s13428-023-02072-x">https://doi.org/10.3758/s13428-023-02072-x</a>
</div>
<div id="ref-smirnov1948" class="csl-entry" role="listitem">
Smirnov, N. (1948). Table for estimating the goodness of fit of empirical distributions. <em>Annals of Mathematical Statistics</em>, <em>19</em>, 279–281.
</div>
<div id="ref-struck2024" class="csl-entry" role="listitem">
Struck, J. (2024). <em>Regression <span>Diagnostics</span> with <span>R</span></em>. University of Wisconsin-Madison. <a href="https://sscc.wisc.edu/sscc/pubs/RegDiag-R/">https://sscc.wisc.edu/sscc/pubs/RegDiag-R/</a>
</div>
<div id="ref-thode2002" class="csl-entry" role="listitem">
Thode, H. C. (2002). <em>Testing for normality</em>. Marcel Dekker.
</div>
<div id="ref-welsch1977" class="csl-entry" role="listitem">
Welsch, R., &amp; Kuh, E. (1977). <em>Linear regression diagnostics</em> (Working Paper 0173; p. 44). National Bureau of Economic Research. <a href="https://doi.org/10.3386/w0173">https://doi.org/10.3386/w0173</a>
</div>
<div id="ref-white1980" class="csl-entry" role="listitem">
White, H. (1980). A heteroskedasticity-consistent covariance matrix estimator and a direct test for heteroskedasticity. <em>Econometrica</em>, <em>48</em>(4), 817–838. <a href="https://doi.org/10.2307/1912934">https://doi.org/10.2307/1912934</a>
</div>
<div id="ref-zeileis2004" class="csl-entry" role="listitem">
Zeileis, A. (2004). Econometric computing with <span>HC</span> and <span>HAC</span> covariance matrix estimators. <em>Journal of Statistical Software</em>, <em>11</em>(10), 1–17. <a href="https://doi.org/10.18637/jss.v011.i10">https://doi.org/10.18637/jss.v011.i10</a>
</div>
</div>


<!-- -->

</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/danielvartan\.github\.io\/linear-models\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb110" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: setup</span></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="in">#| include: false</span></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a><span class="in">source(here::here("R/quarto-setup.R"))</span></span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- badges: start --&gt;</span></span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="al">![Project Status: Inactive – The project has reached a stable, usable state but is no longer being actively developed; support/maintenance will be provided as time allows.](https://www.repostatus.org/badges/latest/inactive.svg)</span><span class="co">](https://www.repostatus.org/#inactive)</span></span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="al">![License: MIT](https://img.shields.io/badge/license-MIT-green)</span><span class="co">](https://choosealicense.com/licenses/mit/)</span></span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- badges: end --&gt;</span></span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a><span class="fu">## Overview</span></span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-15"><a href="#cb110-15" aria-hidden="true" tabindex="-1"></a>This document demonstrates the application of <span class="co">[</span><span class="ot">general linear models</span><span class="co">](https://en.wikipedia.org/wiki/General_linear_model)</span>, with a focus on multiple regression. It utilizes the  <span class="co">[</span><span class="ot">`penguins`</span><span class="co">](https://allisonhorst.github.io/palmerpenguins/reference/penguins.html)</span> dataset from the <span class="co">[</span><span class="ot">`palmerpenguins`</span><span class="co">](https://github.com/allisonhorst/palmerpenguins/)</span> R package, which contains measurements of penguin species from the <span class="co">[</span><span class="ot">Palmer Archipelago</span><span class="co">](https://en.wikipedia.org/wiki/Palmer_Archipelago)</span>. The dataset was originally introduced by @gorman2014.</span>
<span id="cb110-16"><a href="#cb110-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-17"><a href="#cb110-17" aria-hidden="true" tabindex="-1"></a>::: {#fig-penguins-1}</span>
<span id="cb110-18"><a href="#cb110-18" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/palmer_penguins.png)</span>{fig-align="center" width="75%"}</span>
<span id="cb110-19"><a href="#cb110-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-20"><a href="#cb110-20" aria-hidden="true" tabindex="-1"></a>Artwork by <span class="co">[</span><span class="ot">Allison Horst</span><span class="co">](https://allisonhorst.com/)</span>.</span>
<span id="cb110-21"><a href="#cb110-21" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb110-22"><a href="#cb110-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-23"><a href="#cb110-23" aria-hidden="true" tabindex="-1"></a><span class="fu">## Question</span></span>
<span id="cb110-24"><a href="#cb110-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-25"><a href="#cb110-25" aria-hidden="true" tabindex="-1"></a>**Can bill length and bill depth alone effectively predict flipper length in [Adélie penguins](https://en.wikipedia.org/wiki/Ad%C3%A9lie_penguin)?**</span>
<span id="cb110-26"><a href="#cb110-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-27"><a href="#cb110-27" aria-hidden="true" tabindex="-1"></a>Imagine a debate between two marine biologists: one claims that bill length and depth could be used to predict flipper length, while the other disagrees.</span>
<span id="cb110-28"><a href="#cb110-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-29"><a href="#cb110-29" aria-hidden="true" tabindex="-1"></a>To investigate this question, we will utilize a dataset from the <span class="co">[</span><span class="ot">`palmerpenguins`</span><span class="co">](https://github.com/allisonhorst/palmerpenguins/)</span> R package. The relevant variables are <span class="in">`bill_length_mm`</span>,<span class="in">`bill_depth_mm`</span> and <span class="in">`flipper_length_mm`</span> for Adélie penguins. These variables are <span class="co">[</span><span class="ot">defined</span><span class="co">](https://allisonhorst.github.io/palmerpenguins/reference/penguins.html)</span> as follows:</span>
<span id="cb110-30"><a href="#cb110-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-31"><a href="#cb110-31" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`bill_length_mm`</span>: Numerical value representing the bill's length in millimeters.</span>
<span id="cb110-32"><a href="#cb110-32" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`bill_depth_mm`</span>: Numerical value representing the bill's depth in millimeters.</span>
<span id="cb110-33"><a href="#cb110-33" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`flipper_length_mm`</span>: Integer value representing the flipper's length in millimeters.</span>
<span id="cb110-34"><a href="#cb110-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-35"><a href="#cb110-35" aria-hidden="true" tabindex="-1"></a>::: {#fig-penguins-2}</span>
<span id="cb110-36"><a href="#cb110-36" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/culmen_depth.png)</span>{fig-align="center"width="75%"}</span>
<span id="cb110-37"><a href="#cb110-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-38"><a href="#cb110-38" aria-hidden="true" tabindex="-1"></a>Artwork by <span class="co">[</span><span class="ot">Allison Horst</span><span class="co">](https://allisonhorst.com/)</span>.</span>
<span id="cb110-39"><a href="#cb110-39" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb110-40"><a href="#cb110-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-41"><a href="#cb110-41" aria-hidden="true" tabindex="-1"></a><span class="fu">## Hypothesis</span></span>
<span id="cb110-42"><a href="#cb110-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-43"><a href="#cb110-43" aria-hidden="true" tabindex="-1"></a>To approach this question, we will apply Popper’s hypothetico-deductive method, also known as the *method of conjecture and refutation* <span class="co">[</span><span class="ot">@popper1979, p. 164</span><span class="co">]</span>. The basic structure of this approach can be summarized as follows:</span>
<span id="cb110-44"><a href="#cb110-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-47"><a href="#cb110-47" aria-hidden="true" tabindex="-1"></a><span class="in">```{mermaid}</span></span>
<span id="cb110-48"><a href="#cb110-48" aria-hidden="true" tabindex="-1"></a><span class="in">%%| label: fig-mermaid</span></span>
<span id="cb110-49"><a href="#cb110-49" aria-hidden="true" tabindex="-1"></a><span class="in">%%| fig-cap: Simplified schema of Popper’s hypothetico-deductive method.</span></span>
<span id="cb110-50"><a href="#cb110-50" aria-hidden="true" tabindex="-1"></a><span class="in">%%| fig-align: center</span></span>
<span id="cb110-51"><a href="#cb110-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-52"><a href="#cb110-52" aria-hidden="true" tabindex="-1"></a><span class="in">flowchart LR</span></span>
<span id="cb110-53"><a href="#cb110-53" aria-hidden="true" tabindex="-1"></a><span class="in">  A(P1) --&gt; B(TT)</span></span>
<span id="cb110-54"><a href="#cb110-54" aria-hidden="true" tabindex="-1"></a><span class="in">  B --&gt; C(EE)</span></span>
<span id="cb110-55"><a href="#cb110-55" aria-hidden="true" tabindex="-1"></a><span class="in">  C --&gt; D(P2)</span></span>
<span id="cb110-56"><a href="#cb110-56" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-57"><a href="#cb110-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-58"><a href="#cb110-58" aria-hidden="true" tabindex="-1"></a>"Here $\text{P}_1$, is the **problem** from which we start, $\text{TT}$ (the ‘tentative theory’) is the imaginative conjectural solution which we first reach, for example our first **tentative interpretation**. $\text{EE}$ (‘**error- elimination**’) consists of a severe critical examination of our conjecture, our tentative interpretation: it consists, for example, of the critical use of documentary evidence and, if we have at this early stage more than one conjecture at our disposal, it will also consist of a critical discussion and comparative evaluation of the competing conjectures. $\text{P}_2$ is the problem situation as it emerges from our first critical attempt to solve our problems.</span>
<span id="cb110-59"><a href="#cb110-59" aria-hidden="true" tabindex="-1"></a>It leads up to our second attempt (**and so on**)." <span class="co">[</span><span class="ot">@popper1979, p. 164</span><span class="co">]</span></span>
<span id="cb110-60"><a href="#cb110-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-61"><a href="#cb110-61" aria-hidden="true" tabindex="-1"></a>As our tentative theory or main hypothesis, we propose the following:</span>
<span id="cb110-62"><a href="#cb110-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-63"><a href="#cb110-63" aria-hidden="true" tabindex="-1"></a>**Bill length and bill depth can effectively predict flipper length in Adélie penguins**.</span>
<span id="cb110-64"><a href="#cb110-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-65"><a href="#cb110-65" aria-hidden="true" tabindex="-1"></a>As a procedure method, we will employ a method **inpired** by the Neyman-Pearson approach to data testing <span class="co">[</span><span class="ot">@neyman1928; @neyman1928a; @perezgonzalez2015</span><span class="co">]</span>, evaluating the following hypotheses:</span>
<span id="cb110-66"><a href="#cb110-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-67"><a href="#cb110-67" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb110-68"><a href="#cb110-68" aria-hidden="true" tabindex="-1"></a>\begin{cases}</span>
<span id="cb110-69"><a href="#cb110-69" aria-hidden="true" tabindex="-1"></a>\text{H}_{0}: \text{Bill length and bill depth cannot effectively predict flipper length in Adélie penguins} <span class="sc">\\</span></span>
<span id="cb110-70"><a href="#cb110-70" aria-hidden="true" tabindex="-1"></a>\text{H}_{a}: \text{Bill length and bill depth can effectively predict flipper length in Adélie penguins}</span>
<span id="cb110-71"><a href="#cb110-71" aria-hidden="true" tabindex="-1"></a>\end{cases}</span>
<span id="cb110-72"><a href="#cb110-72" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb110-73"><a href="#cb110-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-74"><a href="#cb110-74" aria-hidden="true" tabindex="-1"></a>::: {.callout-warning}</span>
<span id="cb110-75"><a href="#cb110-75" aria-hidden="true" tabindex="-1"></a> Technically, our procedural method is not a strictly Neyman-Pearson acceptance test; we might refer to it as an improved <span class="co">[</span><span class="ot">NHST</span><span class="co">](https://en.wikipedia.org/wiki/Statistical_hypothesis_test)</span> (Null Hypothesis Significance Testing) approach, based on the original Neyman-Pearson ideas.</span>
<span id="cb110-76"><a href="#cb110-76" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb110-77"><a href="#cb110-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-78"><a href="#cb110-78" aria-hidden="true" tabindex="-1"></a><span class="fu">## Methods</span></span>
<span id="cb110-79"><a href="#cb110-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-80"><a href="#cb110-80" aria-hidden="true" tabindex="-1"></a>To test this hypothesis, we will use a general linear model with multiple regression analysis, evaluating the relationship between multiple predictors and a response variable. Here, the response variable is <span class="in">`flipper_length_mm`</span>, while the predictors are <span class="in">`bill_length_mm`</span> and <span class="in">`bill_depth_mm`</span>.</span>
<span id="cb110-81"><a href="#cb110-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-82"><a href="#cb110-82" aria-hidden="true" tabindex="-1"></a>To define what we mean by "effectively predict," we will establish the following decision criteria:</span>
<span id="cb110-83"><a href="#cb110-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-84"><a href="#cb110-84" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Predictors must exert a statistically significant effect on the response variable.</span>
<span id="cb110-85"><a href="#cb110-85" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The model should satisfy all validity assumptions.</span>
<span id="cb110-86"><a href="#cb110-86" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The variance explained by the predictors ($\text{R}^{2}_{\text{adj}}$) must exceed 0.5, indicating a substantial effect on the response variable ($\text{Cohen's } f^2 = \cfrac{0.5}{1 - 0.5} = 1$.)</span>
<span id="cb110-87"><a href="#cb110-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-88"><a href="#cb110-88" aria-hidden="true" tabindex="-1"></a>This 0.5 threshold is not arbitrary; it represents the average level of variance explained in response variables during observational field studies in ecology, especially when there is limited control over factors influencing variance <span class="co">[</span><span class="ot">@peek2003</span><span class="co">]</span>.</span>
<span id="cb110-89"><a href="#cb110-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-90"><a href="#cb110-90" aria-hidden="true" tabindex="-1"></a>Finally, our hypothesis test can be systematized as follows:</span>
<span id="cb110-91"><a href="#cb110-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-92"><a href="#cb110-92" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb110-93"><a href="#cb110-93" aria-hidden="true" tabindex="-1"></a>\begin{cases}</span>
<span id="cb110-94"><a href="#cb110-94" aria-hidden="true" tabindex="-1"></a>\text{H}_{0}: \text{R}^{2}_{\text{adj}} \leq 0.5 <span class="sc">\\</span></span>
<span id="cb110-95"><a href="#cb110-95" aria-hidden="true" tabindex="-1"></a>\text{H}_{a}: \text{R}^{2}_{\text{adj}} &gt; 0.5</span>
<span id="cb110-96"><a href="#cb110-96" aria-hidden="true" tabindex="-1"></a>\end{cases}</span>
<span id="cb110-97"><a href="#cb110-97" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb110-98"><a href="#cb110-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-99"><a href="#cb110-99" aria-hidden="true" tabindex="-1"></a>In addition to an adjusted R-squared greater than 0.5, we will require predictor effects to be statistically significant and all model assumptions to be met.</span>
<span id="cb110-100"><a href="#cb110-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-101"><a href="#cb110-101" aria-hidden="true" tabindex="-1"></a>We will set the significance level ($\alpha$) at 0.05, allowing a 5% chance of a <span class="co">[</span><span class="ot">Type I error</span><span class="co">](https://en.wikipedia.org/wiki/Type_I_and_type_II_errors)</span>. A power analysis will be performed to determine the necessary sample size for detecting a significant effect, targeting a power ($1 - \beta$) of 0.8.</span>
<span id="cb110-102"><a href="#cb110-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-103"><a href="#cb110-103" aria-hidden="true" tabindex="-1"></a>Assumption checks will include:</span>
<span id="cb110-104"><a href="#cb110-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-105"><a href="#cb110-105" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Assessing the normality of residuals through visual inspections, such as <span class="co">[</span><span class="ot">Q-Q plots</span><span class="co">](https://en.wikipedia.org/wiki/Q%E2%80%93Q_plot)</span>, and statistical tests like the <span class="co">[</span><span class="ot">Shapiro-Wilk test</span><span class="co">](https://en.wikipedia.org/wiki/Shapiro%E2%80%93Wilk_test)</span>.</span>
<span id="cb110-106"><a href="#cb110-106" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Evaluating homoscedasticity using tests like the <span class="co">[</span><span class="ot">Breusch-Pagan test</span><span class="co">](https://en.wikipedia.org/wiki/Breusch%E2%80%93Pagan_test)</span> to ensure constant variance of residuals across predictor levels.</span>
<span id="cb110-107"><a href="#cb110-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-108"><a href="#cb110-108" aria-hidden="true" tabindex="-1"></a>We will assess multicollinearity by calculating variance inflation factors (<span class="co">[</span><span class="ot">VIF</span><span class="co">](https://en.wikipedia.org/wiki/Variance_inflation_factor)</span>), with a VIF above 10 indicating potential issues. Influential points will be examined using <span class="co">[</span><span class="ot">Cook's distance</span><span class="co">](https://en.wikipedia.org/wiki/Cook%27s_distance)</span> and leverage values to identify any points that may disproportionately affect model outcomes.</span>
<span id="cb110-109"><a href="#cb110-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-110"><a href="#cb110-110" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb110-111"><a href="#cb110-111" aria-hidden="true" tabindex="-1"></a>It's important to emphasize that we are assessing predictive power, not establishing causality. Predictive models alone should never be used to infer causal relationships <span class="co">[</span><span class="ot">@arif2022</span><span class="co">]</span>.</span>
<span id="cb110-112"><a href="#cb110-112" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb110-113"><a href="#cb110-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-114"><a href="#cb110-114" aria-hidden="true" tabindex="-1"></a><span class="fu">##  An overview of general linear models</span></span>
<span id="cb110-115"><a href="#cb110-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-116"><a href="#cb110-116" aria-hidden="true" tabindex="-1"></a>Before proceeding, let's briefly overview general linear models, with a focus on multiple regression analysis.</span>
<span id="cb110-117"><a href="#cb110-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-118"><a href="#cb110-118" aria-hidden="true" tabindex="-1"></a>"<span class="co">[</span><span class="ot">...</span><span class="co">]</span> A problem of this type is called a problem of multiple linear regression because we are considering the regression of $Y$ on $k$ variables $X_{1}, \dots, X_{k}$, rather than on just a single variable $X$, and we are assuming also that this regression is a linear function of the parameters $\beta_{0}, \dots, \beta_{k}$. In a problem of multiple linear regressions, we obtain $n$ vectors of observations ($x_{i1}. \dots, x_{ik}, Y_{i}$), for $i = 1, \dots, n$. Here $x_{ij}$ is the observed value of the variable $X_{j}$ for the $i$th observation. The $E(Y)$ is given by the relation</span>
<span id="cb110-119"><a href="#cb110-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-120"><a href="#cb110-120" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb110-121"><a href="#cb110-121" aria-hidden="true" tabindex="-1"></a>E(Y_{i}) = \beta_{0} + \beta_{1} x_{i1} + \dots + \beta_{k} x_{ik}</span>
<span id="cb110-122"><a href="#cb110-122" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb110-123"><a href="#cb110-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-124"><a href="#cb110-124" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">@degroot2012, p. 738</span><span class="co">]</span></span>
<span id="cb110-125"><a href="#cb110-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-126"><a href="#cb110-126" aria-hidden="true" tabindex="-1"></a><span class="fu">### Definitions</span></span>
<span id="cb110-127"><a href="#cb110-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-128"><a href="#cb110-128" aria-hidden="true" tabindex="-1"></a>Residuals/Fitted values</span>
<span id="cb110-129"><a href="#cb110-129" aria-hidden="true" tabindex="-1"></a>: \hspace{20cm} For $i = 1, \dots, n$, the observed values of $\hat{y} = \hat{\beta}_{0} + \hat{\beta}_{1} x_{i}$ are called _fitted values_. For $i = 1, \dots, n$, the observed values of $e_{i} = y_{i} - \hat{y}_{i}$ are called _residuals_ <span class="co">[</span><span class="ot">@degroot2012, p. 717</span><span class="co">]</span>.</span>
<span id="cb110-130"><a href="#cb110-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-131"><a href="#cb110-131" aria-hidden="true" tabindex="-1"></a>"<span class="co">[</span><span class="ot">...</span><span class="co">]</span> regression problems in which the observations $Y_{i}, \dots, Y_{n}$ <span class="co">[</span><span class="ot">...</span><span class="co">]</span> we shall assume that each observation $Y_{i}$ has a normal distribution, that the observations $Y_{1}, \dots, Y_{n}$ are independent, and that the observations $Y_{1}, \dots, Y_{n}$ have the same variance $\sigma^{2}$. Instead of a single predictor being associated with each $Y_{i}$, we assume that a $p$-dimensional vector $z_{i} = (z_{i0}, \dots, z_{ip - 1})$ is associated with each $Y_{i}$"  <span class="co">[</span><span class="ot">@degroot2012, p. 736</span><span class="co">]</span>.</span>
<span id="cb110-132"><a href="#cb110-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-133"><a href="#cb110-133" aria-hidden="true" tabindex="-1"></a>General linear model</span>
<span id="cb110-134"><a href="#cb110-134" aria-hidden="true" tabindex="-1"></a>: The statistical model in which the observations $Y_{1}, \dots, Y_{n}$ satisfy the following assumptions <span class="co">[</span><span class="ot">@degroot2012, p. 738</span><span class="co">]</span>.</span>
<span id="cb110-135"><a href="#cb110-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-136"><a href="#cb110-136" aria-hidden="true" tabindex="-1"></a><span class="fu">### Assumptions</span></span>
<span id="cb110-137"><a href="#cb110-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-138"><a href="#cb110-138" aria-hidden="true" tabindex="-1"></a>Assumption 1</span>
<span id="cb110-139"><a href="#cb110-139" aria-hidden="true" tabindex="-1"></a>: \hspace{20cm} __Predictor is known__. Either the vectors $z_{1}, \dots , z_{n}$ are known ahead of time, or they are the observed values of random vectors $Z_{1}, \dots , Z_{n}$ on whose values we condition before computing the joint distribution of ($Y_{1}, \dots , Y_{n}$) <span class="co">[</span><span class="ot">@degroot2012, p. 736</span><span class="co">]</span>.</span>
<span id="cb110-140"><a href="#cb110-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-141"><a href="#cb110-141" aria-hidden="true" tabindex="-1"></a>Assumption 2</span>
<span id="cb110-142"><a href="#cb110-142" aria-hidden="true" tabindex="-1"></a>: \hspace{20cm} __Normality__. For $i = 1, \dots, n$, the conditional distribution of $Y_{i}$ given the vectors $z_{1}, \dots , z_{n}$ is a normal distribution <span class="co">[</span><span class="ot">@degroot2012, p. 737</span><span class="co">]</span>.</span>
<span id="cb110-143"><a href="#cb110-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-144"><a href="#cb110-144" aria-hidden="true" tabindex="-1"></a>(Normality of the error term distribution <span class="co">[</span><span class="ot">@hair2019, p. 287</span><span class="co">]</span>)</span>
<span id="cb110-145"><a href="#cb110-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-146"><a href="#cb110-146" aria-hidden="true" tabindex="-1"></a>Assumption 3</span>
<span id="cb110-147"><a href="#cb110-147" aria-hidden="true" tabindex="-1"></a>: \hspace{20cm} __Linear mean__. There is a vector of parameters  $\beta = (\beta_{0}, \dots, \beta_{p - 1})$ such that the conditional mean of $Y_{i}$ given the values $z_{1}, \dots , z_{n}$ has the form</span>
<span id="cb110-148"><a href="#cb110-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-149"><a href="#cb110-149" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb110-150"><a href="#cb110-150" aria-hidden="true" tabindex="-1"></a>z_{i0} \beta_{0} + z_{i1} \beta_{1} + \cdots + z_{ip - 1} \beta_{p - 1}</span>
<span id="cb110-151"><a href="#cb110-151" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb110-152"><a href="#cb110-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-153"><a href="#cb110-153" aria-hidden="true" tabindex="-1"></a>for $i = 1, \dots, n$ <span class="co">[</span><span class="ot">@degroot2012, p. 737</span><span class="co">]</span>.</span>
<span id="cb110-154"><a href="#cb110-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-155"><a href="#cb110-155" aria-hidden="true" tabindex="-1"></a>(Linearity of the phenomenon measured <span class="co">[</span><span class="ot">@hair2019, p. 287</span><span class="co">]</span>)</span>
<span id="cb110-156"><a href="#cb110-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-157"><a href="#cb110-157" aria-hidden="true" tabindex="-1"></a>::: {.callout-warning}</span>
<span id="cb110-158"><a href="#cb110-158" aria-hidden="true" tabindex="-1"></a>It is important to clarify that the linear assumption pertains to **linearity in the parameters** or equivalently, linearity in the coefficients. This means that each predictor is multiplied by its corresponding regression coefficient. However, this does not imply that the relationship between the predictors and the response variable is linear. In fact, a linear model can still effectively capture non-linear relationships between predictors and the response variable by utilizing transformations of the predictors <span class="co">[</span><span class="ot">@cohen2002</span><span class="co">]</span>.</span>
<span id="cb110-159"><a href="#cb110-159" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb110-160"><a href="#cb110-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-161"><a href="#cb110-161" aria-hidden="true" tabindex="-1"></a>Assumption 4</span>
<span id="cb110-162"><a href="#cb110-162" aria-hidden="true" tabindex="-1"></a>: \hspace{20cm} __Common variance__ (homoscedasticity). There is as parameter $\sigma^{2}$ such the conditional variance of $Y_{i}$ given the values $z_{1}, \dots , z_{n}$ is $\sigma^{2}$ for $i = 1, \dots\, n$.</span>
<span id="cb110-163"><a href="#cb110-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-164"><a href="#cb110-164" aria-hidden="true" tabindex="-1"></a>(Constant variance of the error terms <span class="co">[</span><span class="ot">@hair2019, p. 287</span><span class="co">]</span>)</span>
<span id="cb110-165"><a href="#cb110-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-166"><a href="#cb110-166" aria-hidden="true" tabindex="-1"></a>Assumption 5</span>
<span id="cb110-167"><a href="#cb110-167" aria-hidden="true" tabindex="-1"></a>: \hspace{20cm} __Independence__. The random variables $Y_{1}, \dots , Y_{n}$ are independent given the observed $z_{1}, \dots , z_{n}$ <span class="co">[</span><span class="ot">@degroot2012, p. 737</span><span class="co">]</span>.</span>
<span id="cb110-168"><a href="#cb110-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-169"><a href="#cb110-169" aria-hidden="true" tabindex="-1"></a>(Independence of the error terms <span class="co">[</span><span class="ot">@hair2019, p. 287</span><span class="co">]</span>)</span>
<span id="cb110-170"><a href="#cb110-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-171"><a href="#cb110-171" aria-hidden="true" tabindex="-1"></a><span class="fu">## Setting up the environment</span></span>
<span id="cb110-172"><a href="#cb110-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-175"><a href="#cb110-175" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-176"><a href="#cb110-176" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb110-177"><a href="#cb110-177" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb110-178"><a href="#cb110-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-179"><a href="#cb110-179" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb110-180"><a href="#cb110-180" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb110-181"><a href="#cb110-181" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(checkmate)</span>
<span id="cb110-182"><a href="#cb110-182" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb110-183"><a href="#cb110-183" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb110-184"><a href="#cb110-184" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(effectsize)</span>
<span id="cb110-185"><a href="#cb110-185" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fBasics)</span>
<span id="cb110-186"><a href="#cb110-186" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb110-187"><a href="#cb110-187" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeffects)</span>
<span id="cb110-188"><a href="#cb110-188" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb110-189"><a href="#cb110-189" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb110-190"><a href="#cb110-190" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpmisc)</span>
<span id="cb110-191"><a href="#cb110-191" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplotify)</span>
<span id="cb110-192"><a href="#cb110-192" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(qqplotr)</span>
<span id="cb110-193"><a href="#cb110-193" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggPredict)</span>
<span id="cb110-194"><a href="#cb110-194" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glue)</span>
<span id="cb110-195"><a href="#cb110-195" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(insight)</span>
<span id="cb110-196"><a href="#cb110-196" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb110-197"><a href="#cb110-197" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(latex2exp)</span>
<span id="cb110-198"><a href="#cb110-198" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb110-199"><a href="#cb110-199" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(moments)</span>
<span id="cb110-200"><a href="#cb110-200" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nortest)</span>
<span id="cb110-201"><a href="#cb110-201" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(olsrr)</span>
<span id="cb110-202"><a href="#cb110-202" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(palmerpenguins)</span>
<span id="cb110-203"><a href="#cb110-203" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parameters)</span>
<span id="cb110-204"><a href="#cb110-204" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parsnip)</span>
<span id="cb110-205"><a href="#cb110-205" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb110-206"><a href="#cb110-206" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(predict3d)</span>
<span id="cb110-207"><a href="#cb110-207" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psychometric)</span>
<span id="cb110-208"><a href="#cb110-208" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pwrss)</span>
<span id="cb110-209"><a href="#cb110-209" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(recipes)</span>
<span id="cb110-210"><a href="#cb110-210" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(report)</span>
<span id="cb110-211"><a href="#cb110-211" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rgl)</span>
<span id="cb110-212"><a href="#cb110-212" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rutils)</span>
<span id="cb110-213"><a href="#cb110-213" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sandwich)</span>
<span id="cb110-214"><a href="#cb110-214" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb110-215"><a href="#cb110-215" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb110-216"><a href="#cb110-216" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb110-217"><a href="#cb110-217" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tseries)</span>
<span id="cb110-218"><a href="#cb110-218" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb110-219"><a href="#cb110-219" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(workflows)</span>
<span id="cb110-220"><a href="#cb110-220" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-221"><a href="#cb110-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-224"><a href="#cb110-224" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-225"><a href="#cb110-225" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb110-226"><a href="#cb110-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-227"><a href="#cb110-227" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb110-228"><a href="#cb110-228" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-229"><a href="#cb110-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-232"><a href="#cb110-232" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-233"><a href="#cb110-233" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb110-234"><a href="#cb110-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-235"><a href="#cb110-235" aria-hidden="true" tabindex="-1"></a>gg_color_hue <span class="ot">&lt;-</span> <span class="cf">function</span>(n) {</span>
<span id="cb110-236"><a href="#cb110-236" aria-hidden="true" tabindex="-1"></a>  hues <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">15</span>, <span class="dv">375</span>, <span class="at">length =</span> n <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb110-237"><a href="#cb110-237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hcl</span>(<span class="at">h =</span> hues, <span class="at">l =</span> <span class="dv">65</span>, <span class="at">c =</span> <span class="dv">100</span>)[<span class="dv">1</span><span class="sc">:</span>n]</span>
<span id="cb110-238"><a href="#cb110-238" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb110-239"><a href="#cb110-239" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-240"><a href="#cb110-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-243"><a href="#cb110-243" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-244"><a href="#cb110-244" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb110-245"><a href="#cb110-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-246"><a href="#cb110-246" aria-hidden="true" tabindex="-1"></a>lm_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(model, <span class="at">fix_all_but =</span> <span class="cn">NULL</span>, <span class="at">data =</span> <span class="cn">NULL</span>) {</span>
<span id="cb110-247"><a href="#cb110-247" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_class</span>(model, <span class="st">"lm"</span>)</span>
<span id="cb110-248"><a href="#cb110-248" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-249"><a href="#cb110-249" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_number</span>(</span>
<span id="cb110-250"><a href="#cb110-250" aria-hidden="true" tabindex="-1"></a>    fix_all_but, </span>
<span id="cb110-251"><a href="#cb110-251" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower =</span> <span class="dv">1</span>,</span>
<span id="cb110-252"><a href="#cb110-252" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper =</span> <span class="fu">length</span>(stats<span class="sc">::</span><span class="fu">coef</span>(model)) <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb110-253"><a href="#cb110-253" aria-hidden="true" tabindex="-1"></a>    <span class="at">null.ok =</span> <span class="cn">TRUE</span></span>
<span id="cb110-254"><a href="#cb110-254" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb110-255"><a href="#cb110-255" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-256"><a href="#cb110-256" aria-hidden="true" tabindex="-1"></a>  coef <span class="ot">&lt;-</span> broom<span class="sc">::</span><span class="fu">tidy</span>(fit)</span>
<span id="cb110-257"><a href="#cb110-257" aria-hidden="true" tabindex="-1"></a>  vars <span class="ot">&lt;-</span> letters[<span class="fu">seq_len</span>((<span class="fu">nrow</span>(coef) <span class="sc">-</span> <span class="dv">1</span>))]</span>
<span id="cb110-258"><a href="#cb110-258" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-259"><a href="#cb110-259" aria-hidden="true" tabindex="-1"></a>  fixed_vars <span class="ot">&lt;-</span> vars</span>
<span id="cb110-260"><a href="#cb110-260" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-261"><a href="#cb110-261" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(fix_all_but)) {</span>
<span id="cb110-262"><a href="#cb110-262" aria-hidden="true" tabindex="-1"></a>    checkmate<span class="sc">::</span><span class="fu">assert_data_frame</span>(data)</span>
<span id="cb110-263"><a href="#cb110-263" aria-hidden="true" tabindex="-1"></a>    checkmate<span class="sc">::</span><span class="fu">assert_subset</span>(coef<span class="sc">$</span>term[<span class="sc">-</span><span class="dv">1</span>], <span class="fu">names</span>(data))</span>
<span id="cb110-264"><a href="#cb110-264" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb110-265"><a href="#cb110-265" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(fixed_vars)[<span class="sc">-</span>fix_all_but]) {</span>
<span id="cb110-266"><a href="#cb110-266" aria-hidden="true" tabindex="-1"></a>      fixed_vars[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(data[[coef<span class="sc">$</span>term[i <span class="sc">+</span> <span class="dv">1</span>]]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb110-267"><a href="#cb110-267" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb110-268"><a href="#cb110-268" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb110-269"><a href="#cb110-269" aria-hidden="true" tabindex="-1"></a>    vars <span class="ot">&lt;-</span> vars[fix_all_but]</span>
<span id="cb110-270"><a href="#cb110-270" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb110-271"><a href="#cb110-271" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-272"><a href="#cb110-272" aria-hidden="true" tabindex="-1"></a>  fun_exp <span class="ot">&lt;-</span> <span class="fu">str2expression</span>(</span>
<span id="cb110-273"><a href="#cb110-273" aria-hidden="true" tabindex="-1"></a>      glue<span class="sc">::</span><span class="fu">glue</span>(</span>
<span id="cb110-274"><a href="#cb110-274" aria-hidden="true" tabindex="-1"></a>        <span class="st">"function({paste0(vars, collapse = ', ')}) {{"</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb110-275"><a href="#cb110-275" aria-hidden="true" tabindex="-1"></a>        <span class="st">"  {paste0('checkmate::assert_numeric(', vars, ')', collapse = '</span><span class="sc">\n</span><span class="st">')}"</span>,</span>
<span id="cb110-276"><a href="#cb110-276" aria-hidden="true" tabindex="-1"></a>        <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>,</span>
<span id="cb110-277"><a href="#cb110-277" aria-hidden="true" tabindex="-1"></a>        <span class="st">"  {coef$estimate[1]} +"</span>,</span>
<span id="cb110-278"><a href="#cb110-278" aria-hidden="true" tabindex="-1"></a>        <span class="st">"{paste0(coef$estimate[-1], ' * ', fixed_vars, collapse = ' + ')}"</span>,</span>
<span id="cb110-279"><a href="#cb110-279" aria-hidden="true" tabindex="-1"></a>        <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb110-280"><a href="#cb110-280" aria-hidden="true" tabindex="-1"></a>        <span class="st">"}}"</span></span>
<span id="cb110-281"><a href="#cb110-281" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb110-282"><a href="#cb110-282" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb110-283"><a href="#cb110-283" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-284"><a href="#cb110-284" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">eval</span>(fun_exp)</span>
<span id="cb110-285"><a href="#cb110-285" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-286"><a href="#cb110-286" aria-hidden="true" tabindex="-1"></a>  out</span>
<span id="cb110-287"><a href="#cb110-287" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb110-288"><a href="#cb110-288" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-289"><a href="#cb110-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-292"><a href="#cb110-292" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-293"><a href="#cb110-293" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb110-294"><a href="#cb110-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-295"><a href="#cb110-295" aria-hidden="true" tabindex="-1"></a>lm_str_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb110-296"><a href="#cb110-296" aria-hidden="true" tabindex="-1"></a>    model, </span>
<span id="cb110-297"><a href="#cb110-297" aria-hidden="true" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb110-298"><a href="#cb110-298" aria-hidden="true" tabindex="-1"></a>    <span class="at">latex2exp =</span> <span class="cn">TRUE</span>,</span>
<span id="cb110-299"><a href="#cb110-299" aria-hidden="true" tabindex="-1"></a>    <span class="at">fix_all_but =</span> <span class="cn">NULL</span>, <span class="co"># Ignore the intercept coefficient.</span></span>
<span id="cb110-300"><a href="#cb110-300" aria-hidden="true" tabindex="-1"></a>    <span class="at">fix_fun =</span> <span class="st">"Mean"</span>,</span>
<span id="cb110-301"><a href="#cb110-301" aria-hidden="true" tabindex="-1"></a>    <span class="at">coef_names =</span> <span class="cn">NULL</span> <span class="co"># Ignore the intercept coefficient.</span></span>
<span id="cb110-302"><a href="#cb110-302" aria-hidden="true" tabindex="-1"></a>  ) {</span>
<span id="cb110-303"><a href="#cb110-303" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_class</span>(model, <span class="st">"lm"</span>)</span>
<span id="cb110-304"><a href="#cb110-304" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_number</span>(digits)</span>
<span id="cb110-305"><a href="#cb110-305" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_flag</span>(latex2exp)</span>
<span id="cb110-306"><a href="#cb110-306" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-307"><a href="#cb110-307" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_number</span>(</span>
<span id="cb110-308"><a href="#cb110-308" aria-hidden="true" tabindex="-1"></a>    fix_all_but, </span>
<span id="cb110-309"><a href="#cb110-309" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower =</span> <span class="dv">1</span>,</span>
<span id="cb110-310"><a href="#cb110-310" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper =</span> <span class="fu">length</span>(stats<span class="sc">::</span><span class="fu">coef</span>(model)) <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb110-311"><a href="#cb110-311" aria-hidden="true" tabindex="-1"></a>    <span class="at">null.ok =</span> <span class="cn">TRUE</span></span>
<span id="cb110-312"><a href="#cb110-312" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb110-313"><a href="#cb110-313" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-314"><a href="#cb110-314" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_string</span>(fix_fun)</span>
<span id="cb110-315"><a href="#cb110-315" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-316"><a href="#cb110-316" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_character</span>(</span>
<span id="cb110-317"><a href="#cb110-317" aria-hidden="true" tabindex="-1"></a>    coef_names, </span>
<span id="cb110-318"><a href="#cb110-318" aria-hidden="true" tabindex="-1"></a>    <span class="at">any.missing =</span> <span class="cn">FALSE</span>, </span>
<span id="cb110-319"><a href="#cb110-319" aria-hidden="true" tabindex="-1"></a>    <span class="at">len =</span> <span class="fu">length</span>(<span class="fu">names</span>(stats<span class="sc">::</span><span class="fu">coef</span>(model))) <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb110-320"><a href="#cb110-320" aria-hidden="true" tabindex="-1"></a>    <span class="at">null.ok =</span> <span class="cn">TRUE</span></span>
<span id="cb110-321"><a href="#cb110-321" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb110-322"><a href="#cb110-322" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-323"><a href="#cb110-323" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(coef_names)) coef_names <span class="ot">&lt;-</span> <span class="fu">names</span>(stats<span class="sc">::</span><span class="fu">coef</span>(model))[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb110-324"><a href="#cb110-324" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-325"><a href="#cb110-325" aria-hidden="true" tabindex="-1"></a>  coef <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb110-326"><a href="#cb110-326" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-327"><a href="#cb110-327" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(coef_names)) {</span>
<span id="cb110-328"><a href="#cb110-328" aria-hidden="true" tabindex="-1"></a>    coef[[coef_names[i]]] <span class="ot">&lt;-</span> </span>
<span id="cb110-329"><a href="#cb110-329" aria-hidden="true" tabindex="-1"></a>      stats<span class="sc">::</span><span class="fu">coef</span>(model) <span class="sc">|&gt;</span> </span>
<span id="cb110-330"><a href="#cb110-330" aria-hidden="true" tabindex="-1"></a>      magrittr<span class="sc">::</span><span class="fu">extract</span>(i <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb110-331"><a href="#cb110-331" aria-hidden="true" tabindex="-1"></a>      rutils<span class="sc">:::</span><span class="fu">clear_names</span>() <span class="sc">|&gt;</span></span>
<span id="cb110-332"><a href="#cb110-332" aria-hidden="true" tabindex="-1"></a>      <span class="fu">round</span>(digits)</span>
<span id="cb110-333"><a href="#cb110-333" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb110-334"><a href="#cb110-334" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-335"><a href="#cb110-335" aria-hidden="true" tabindex="-1"></a>  coef_names <span class="ot">&lt;-</span></span>
<span id="cb110-336"><a href="#cb110-336" aria-hidden="true" tabindex="-1"></a>    coef_names <span class="sc">|&gt;</span></span>
<span id="cb110-337"><a href="#cb110-337" aria-hidden="true" tabindex="-1"></a>    stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">_|</span><span class="sc">\\</span><span class="st">."</span>, <span class="st">" "</span>) <span class="sc">|&gt;</span></span>
<span id="cb110-338"><a href="#cb110-338" aria-hidden="true" tabindex="-1"></a>    stringr<span class="sc">::</span><span class="fu">str_to_title</span>() <span class="sc">|&gt;</span></span>
<span id="cb110-339"><a href="#cb110-339" aria-hidden="true" tabindex="-1"></a>    stringr<span class="sc">::</span><span class="fu">str_replace</span>(<span class="st">" "</span>, <span class="st">""</span>)</span>
<span id="cb110-340"><a href="#cb110-340" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-341"><a href="#cb110-341" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(fix_all_but)) {</span>
<span id="cb110-342"><a href="#cb110-342" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(coef_names)[<span class="sc">-</span>fix_all_but]) {</span>
<span id="cb110-343"><a href="#cb110-343" aria-hidden="true" tabindex="-1"></a>      coef_names[i] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(fix_fun, <span class="st">"("</span>, coef_names[i], <span class="st">")"</span>)</span>
<span id="cb110-344"><a href="#cb110-344" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb110-345"><a href="#cb110-345" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb110-346"><a href="#cb110-346" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-347"><a href="#cb110-347" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">paste0</span>(</span>
<span id="cb110-348"><a href="#cb110-348" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$"</span>, <span class="st">"y ="</span>, <span class="st">" "</span>, </span>
<span id="cb110-349"><a href="#cb110-349" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(stats<span class="sc">::</span><span class="fu">coef</span>(model)[<span class="dv">1</span>], digits), <span class="st">" + "</span>,</span>
<span id="cb110-350"><a href="#cb110-350" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(coef, <span class="st">" </span><span class="sc">\\</span><span class="st">times "</span>, coef_names, <span class="at">collapse =</span> <span class="st">" + "</span>),</span>
<span id="cb110-351"><a href="#cb110-351" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$"</span></span>
<span id="cb110-352"><a href="#cb110-352" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb110-353"><a href="#cb110-353" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-354"><a href="#cb110-354" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> out <span class="sc">|&gt;</span> stringr<span class="sc">::</span><span class="fu">str_replace</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">+ </span><span class="sc">\\</span><span class="st">-"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">- "</span>) </span>
<span id="cb110-355"><a href="#cb110-355" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-356"><a href="#cb110-356" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">isTRUE</span>(latex2exp)) {</span>
<span id="cb110-357"><a href="#cb110-357" aria-hidden="true" tabindex="-1"></a>    out <span class="sc">|&gt;</span>latex2exp<span class="sc">::</span><span class="fu">TeX</span>()</span>
<span id="cb110-358"><a href="#cb110-358" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb110-359"><a href="#cb110-359" aria-hidden="true" tabindex="-1"></a>    out</span>
<span id="cb110-360"><a href="#cb110-360" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb110-361"><a href="#cb110-361" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb110-362"><a href="#cb110-362" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-363"><a href="#cb110-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-366"><a href="#cb110-366" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-367"><a href="#cb110-367" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb110-368"><a href="#cb110-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-369"><a href="#cb110-369" aria-hidden="true" tabindex="-1"></a>test_outlier <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb110-370"><a href="#cb110-370" aria-hidden="true" tabindex="-1"></a>    x, </span>
<span id="cb110-371"><a href="#cb110-371" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"iqr"</span>, </span>
<span id="cb110-372"><a href="#cb110-372" aria-hidden="true" tabindex="-1"></a>    <span class="at">iqr_mult =</span> <span class="fl">1.5</span>, </span>
<span id="cb110-373"><a href="#cb110-373" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_mult =</span> <span class="dv">3</span></span>
<span id="cb110-374"><a href="#cb110-374" aria-hidden="true" tabindex="-1"></a>  ) {</span>
<span id="cb110-375"><a href="#cb110-375" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_numeric</span>(x)</span>
<span id="cb110-376"><a href="#cb110-376" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_choice</span>(method, <span class="fu">c</span>(<span class="st">"iqr"</span>, <span class="st">"sd"</span>))</span>
<span id="cb110-377"><a href="#cb110-377" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_number</span>(iqr_mult)</span>
<span id="cb110-378"><a href="#cb110-378" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_number</span>(sd_mult)</span>
<span id="cb110-379"><a href="#cb110-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-380"><a href="#cb110-380" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (method <span class="sc">==</span> <span class="st">"iqr"</span>) {</span>
<span id="cb110-381"><a href="#cb110-381" aria-hidden="true" tabindex="-1"></a>    iqr <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">IQR</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb110-382"><a href="#cb110-382" aria-hidden="true" tabindex="-1"></a>    min <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">quantile</span>(x, <span class="fl">0.25</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> (iqr_mult <span class="sc">*</span> iqr)</span>
<span id="cb110-383"><a href="#cb110-383" aria-hidden="true" tabindex="-1"></a>    max <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">quantile</span>(x, <span class="fl">0.75</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> (iqr_mult <span class="sc">*</span> iqr)</span>
<span id="cb110-384"><a href="#cb110-384" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (method <span class="sc">==</span> <span class="st">"sd"</span>) {</span>
<span id="cb110-385"><a href="#cb110-385" aria-hidden="true" tabindex="-1"></a>    min <span class="ot">&lt;-</span> <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> (sd_mult <span class="sc">*</span> stats<span class="sc">::</span><span class="fu">sd</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb110-386"><a href="#cb110-386" aria-hidden="true" tabindex="-1"></a>    max <span class="ot">&lt;-</span> <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> (sd_mult <span class="sc">*</span> stats<span class="sc">::</span><span class="fu">sd</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb110-387"><a href="#cb110-387" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb110-388"><a href="#cb110-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-389"><a href="#cb110-389" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">if_else</span>(x <span class="sc">&gt;=</span> min <span class="sc">&amp;</span> x <span class="sc">&lt;=</span> max, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="at">missing =</span> <span class="cn">FALSE</span>)</span>
<span id="cb110-390"><a href="#cb110-390" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb110-391"><a href="#cb110-391" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-392"><a href="#cb110-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-395"><a href="#cb110-395" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-396"><a href="#cb110-396" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb110-397"><a href="#cb110-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-398"><a href="#cb110-398" aria-hidden="true" tabindex="-1"></a>remove_outliers <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb110-399"><a href="#cb110-399" aria-hidden="true" tabindex="-1"></a>    x, </span>
<span id="cb110-400"><a href="#cb110-400" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"iqr"</span>, </span>
<span id="cb110-401"><a href="#cb110-401" aria-hidden="true" tabindex="-1"></a>    <span class="at">iqr_mult =</span> <span class="fl">1.5</span>, </span>
<span id="cb110-402"><a href="#cb110-402" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_mult =</span> <span class="dv">3</span></span>
<span id="cb110-403"><a href="#cb110-403" aria-hidden="true" tabindex="-1"></a>  ) {</span>
<span id="cb110-404"><a href="#cb110-404" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_numeric</span>(x)</span>
<span id="cb110-405"><a href="#cb110-405" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_choice</span>(method, <span class="fu">c</span>(<span class="st">"iqr"</span>, <span class="st">"sd"</span>))</span>
<span id="cb110-406"><a href="#cb110-406" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_number</span>(iqr_mult, <span class="at">lower =</span> <span class="dv">1</span>)</span>
<span id="cb110-407"><a href="#cb110-407" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_number</span>(sd_mult, <span class="at">lower =</span> <span class="dv">0</span>)</span>
<span id="cb110-408"><a href="#cb110-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-409"><a href="#cb110-409" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">|&gt;</span></span>
<span id="cb110-410"><a href="#cb110-410" aria-hidden="true" tabindex="-1"></a>    <span class="fu">test_outlier</span>(</span>
<span id="cb110-411"><a href="#cb110-411" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> method, </span>
<span id="cb110-412"><a href="#cb110-412" aria-hidden="true" tabindex="-1"></a>      <span class="at">iqr_mult =</span> iqr_mult, </span>
<span id="cb110-413"><a href="#cb110-413" aria-hidden="true" tabindex="-1"></a>      <span class="at">sd_mult =</span> sd_mult</span>
<span id="cb110-414"><a href="#cb110-414" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb110-415"><a href="#cb110-415" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">!</span><span class="st">`</span>() <span class="sc">%&gt;%</span></span>
<span id="cb110-416"><a href="#cb110-416" aria-hidden="true" tabindex="-1"></a>    magrittr<span class="sc">::</span><span class="fu">extract</span>(x, .)</span>
<span id="cb110-417"><a href="#cb110-417" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb110-418"><a href="#cb110-418" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-419"><a href="#cb110-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-422"><a href="#cb110-422" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-423"><a href="#cb110-423" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb110-424"><a href="#cb110-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-425"><a href="#cb110-425" aria-hidden="true" tabindex="-1"></a>list_as_tibble <span class="ot">&lt;-</span> <span class="cf">function</span>(list) {</span>
<span id="cb110-426"><a href="#cb110-426" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_list</span>(list)</span>
<span id="cb110-427"><a href="#cb110-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-428"><a href="#cb110-428" aria-hidden="true" tabindex="-1"></a>  list <span class="sc">|&gt;</span></span>
<span id="cb110-429"><a href="#cb110-429" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">as_tibble</span>() <span class="sc">|&gt;</span></span>
<span id="cb110-430"><a href="#cb110-430" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb110-431"><a href="#cb110-431" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">across</span>(</span>
<span id="cb110-432"><a href="#cb110-432" aria-hidden="true" tabindex="-1"></a>        <span class="at">.cols =</span> dplyr<span class="sc">::</span><span class="fu">everything</span>(),</span>
<span id="cb110-433"><a href="#cb110-433" aria-hidden="true" tabindex="-1"></a>        <span class="at">.fns =</span> as.character</span>
<span id="cb110-434"><a href="#cb110-434" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb110-435"><a href="#cb110-435" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb110-436"><a href="#cb110-436" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">cols =</span> dplyr<span class="sc">::</span><span class="fu">everything</span>())</span>
<span id="cb110-437"><a href="#cb110-437" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb110-438"><a href="#cb110-438" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-439"><a href="#cb110-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-442"><a href="#cb110-442" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-443"><a href="#cb110-443" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb110-444"><a href="#cb110-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-445"><a href="#cb110-445" aria-hidden="true" tabindex="-1"></a>stats_sum <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb110-446"><a href="#cb110-446" aria-hidden="true" tabindex="-1"></a>    x,</span>
<span id="cb110-447"><a href="#cb110-447" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="cn">NULL</span>,</span>
<span id="cb110-448"><a href="#cb110-448" aria-hidden="true" tabindex="-1"></a>    <span class="at">na_rm =</span> <span class="cn">TRUE</span>,</span>
<span id="cb110-449"><a href="#cb110-449" aria-hidden="true" tabindex="-1"></a>    <span class="at">remove_outliers =</span> <span class="cn">FALSE</span>,</span>
<span id="cb110-450"><a href="#cb110-450" aria-hidden="true" tabindex="-1"></a>    <span class="at">iqr_mult =</span> <span class="fl">1.5</span>,</span>
<span id="cb110-451"><a href="#cb110-451" aria-hidden="true" tabindex="-1"></a>    <span class="at">as_list =</span> <span class="cn">FALSE</span></span>
<span id="cb110-452"><a href="#cb110-452" aria-hidden="true" tabindex="-1"></a>  ) {</span>
<span id="cb110-453"><a href="#cb110-453" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_numeric</span>(x)</span>
<span id="cb110-454"><a href="#cb110-454" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_string</span>(name, <span class="at">null.ok =</span> <span class="cn">TRUE</span>)</span>
<span id="cb110-455"><a href="#cb110-455" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_flag</span>(na_rm)</span>
<span id="cb110-456"><a href="#cb110-456" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_flag</span>(remove_outliers)</span>
<span id="cb110-457"><a href="#cb110-457" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_number</span>(iqr_mult, <span class="at">lower =</span> <span class="dv">1</span>)</span>
<span id="cb110-458"><a href="#cb110-458" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_flag</span>(as_list)</span>
<span id="cb110-459"><a href="#cb110-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-460"><a href="#cb110-460" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">isTRUE</span>(remove_outliers)) {</span>
<span id="cb110-461"><a href="#cb110-461" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> x <span class="sc">|&gt;</span> <span class="fu">remove_outliers</span>(<span class="at">method =</span> <span class="st">"iqr"</span>, <span class="at">iqr_mult =</span> iqr_mult)</span>
<span id="cb110-462"><a href="#cb110-462" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb110-463"><a href="#cb110-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-464"><a href="#cb110-464" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb110-465"><a href="#cb110-465" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">length</span>(x),</span>
<span id="cb110-466"><a href="#cb110-466" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_rm_na =</span> <span class="fu">length</span>(x[<span class="sc">!</span><span class="fu">is.na</span>(x)]),</span>
<span id="cb110-467"><a href="#cb110-467" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_na =</span> <span class="fu">length</span>(x[<span class="fu">is.na</span>(x)]),</span>
<span id="cb110-468"><a href="#cb110-468" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">mean</span>(x, <span class="at">na.rm =</span> na_rm),</span>
<span id="cb110-469"><a href="#cb110-469" aria-hidden="true" tabindex="-1"></a>    <span class="at">var =</span> stats<span class="sc">::</span><span class="fu">var</span>(x, <span class="at">na.rm =</span> na_rm),</span>
<span id="cb110-470"><a href="#cb110-470" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd =</span> stats<span class="sc">::</span><span class="fu">sd</span>(x, <span class="at">na.rm =</span> na_rm),</span>
<span id="cb110-471"><a href="#cb110-471" aria-hidden="true" tabindex="-1"></a>    <span class="at">min =</span> rutils<span class="sc">:::</span><span class="fu">clear_names</span>(stats<span class="sc">::</span><span class="fu">quantile</span>(x, <span class="dv">0</span>, <span class="at">na.rm =</span> na_rm)),</span>
<span id="cb110-472"><a href="#cb110-472" aria-hidden="true" tabindex="-1"></a>    <span class="at">q_1 =</span> rutils<span class="sc">:::</span><span class="fu">clear_names</span>(stats<span class="sc">::</span><span class="fu">quantile</span>(x, <span class="fl">0.25</span>, <span class="at">na.rm =</span> na_rm)),</span>
<span id="cb110-473"><a href="#cb110-473" aria-hidden="true" tabindex="-1"></a>    <span class="at">median =</span> rutils<span class="sc">:::</span><span class="fu">clear_names</span>(stats<span class="sc">::</span><span class="fu">quantile</span>(x, <span class="fl">0.5</span>, <span class="at">na.rm =</span> na_rm)),</span>
<span id="cb110-474"><a href="#cb110-474" aria-hidden="true" tabindex="-1"></a>    <span class="at">q_3 =</span> rutils<span class="sc">:::</span><span class="fu">clear_names</span>(stats<span class="sc">::</span><span class="fu">quantile</span>(x, <span class="fl">0.75</span>, <span class="at">na.rm =</span> na_rm)),</span>
<span id="cb110-475"><a href="#cb110-475" aria-hidden="true" tabindex="-1"></a>    <span class="at">max =</span> rutils<span class="sc">:::</span><span class="fu">clear_names</span>(stats<span class="sc">::</span><span class="fu">quantile</span>(x, <span class="dv">1</span>, <span class="at">na.rm =</span> na_rm)),</span>
<span id="cb110-476"><a href="#cb110-476" aria-hidden="true" tabindex="-1"></a>    <span class="at">iqr =</span> <span class="fu">IQR</span>(x, <span class="at">na.rm =</span> na_rm),</span>
<span id="cb110-477"><a href="#cb110-477" aria-hidden="true" tabindex="-1"></a>    <span class="at">skewness =</span> moments<span class="sc">::</span><span class="fu">skewness</span>(x, <span class="at">na.rm =</span> na_rm),</span>
<span id="cb110-478"><a href="#cb110-478" aria-hidden="true" tabindex="-1"></a>    <span class="at">kurtosis =</span> moments<span class="sc">::</span><span class="fu">kurtosis</span>(x, <span class="at">na.rm =</span> na_rm)</span>
<span id="cb110-479"><a href="#cb110-479" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb110-480"><a href="#cb110-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-481"><a href="#cb110-481" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(name)) out <span class="ot">&lt;-</span> <span class="fu">append</span>(out, <span class="fu">list</span>(<span class="at">name =</span> name), <span class="at">after =</span> <span class="dv">0</span>)</span>
<span id="cb110-482"><a href="#cb110-482" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-483"><a href="#cb110-483" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">isTRUE</span>(as_list)) {</span>
<span id="cb110-484"><a href="#cb110-484" aria-hidden="true" tabindex="-1"></a>    out</span>
<span id="cb110-485"><a href="#cb110-485" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb110-486"><a href="#cb110-486" aria-hidden="true" tabindex="-1"></a>    out <span class="sc">|&gt;</span> <span class="fu">list_as_tibble</span>()</span>
<span id="cb110-487"><a href="#cb110-487" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb110-488"><a href="#cb110-488" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb110-489"><a href="#cb110-489" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-490"><a href="#cb110-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-493"><a href="#cb110-493" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-494"><a href="#cb110-494" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb110-495"><a href="#cb110-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-496"><a href="#cb110-496" aria-hidden="true" tabindex="-1"></a>plot_qq <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb110-497"><a href="#cb110-497" aria-hidden="true" tabindex="-1"></a>    x,</span>
<span id="cb110-498"><a href="#cb110-498" aria-hidden="true" tabindex="-1"></a>    <span class="at">text_size =</span> <span class="cn">NULL</span>,</span>
<span id="cb110-499"><a href="#cb110-499" aria-hidden="true" tabindex="-1"></a>    <span class="at">na_rm =</span> <span class="cn">TRUE</span>,</span>
<span id="cb110-500"><a href="#cb110-500" aria-hidden="true" tabindex="-1"></a>    <span class="at">print =</span> <span class="cn">TRUE</span></span>
<span id="cb110-501"><a href="#cb110-501" aria-hidden="true" tabindex="-1"></a>  ) {</span>
<span id="cb110-502"><a href="#cb110-502" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_numeric</span>(x)</span>
<span id="cb110-503"><a href="#cb110-503" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_number</span>(text_size, <span class="at">null.ok =</span> <span class="cn">TRUE</span>)</span>
<span id="cb110-504"><a href="#cb110-504" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_flag</span>(na_rm)</span>
<span id="cb110-505"><a href="#cb110-505" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_flag</span>(print)</span>
<span id="cb110-506"><a href="#cb110-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-507"><a href="#cb110-507" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">isTRUE</span>(na_rm)) x <span class="ot">&lt;-</span> x <span class="sc">|&gt;</span> rutils<span class="sc">:::</span><span class="fu">drop_na</span>()</span>
<span id="cb110-508"><a href="#cb110-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-509"><a href="#cb110-509" aria-hidden="true" tabindex="-1"></a>  plot <span class="ot">&lt;-</span></span>
<span id="cb110-510"><a href="#cb110-510" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">y =</span> x) <span class="sc">|&gt;</span></span>
<span id="cb110-511"><a href="#cb110-511" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">sample =</span> y)) <span class="sc">+</span></span>
<span id="cb110-512"><a href="#cb110-512" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">stat_qq</span>() <span class="sc">+</span></span>
<span id="cb110-513"><a href="#cb110-513" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">stat_qq_line</span>(<span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb110-514"><a href="#cb110-514" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb110-515"><a href="#cb110-515" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Theoretical quantiles (Std. normal)"</span>,</span>
<span id="cb110-516"><a href="#cb110-516" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Sample quantiles"</span></span>
<span id="cb110-517"><a href="#cb110-517" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb110-518"><a href="#cb110-518" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">text =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">size =</span> text_size))</span>
<span id="cb110-519"><a href="#cb110-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-520"><a href="#cb110-520" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">isTRUE</span>(print)) <span class="fu">print</span>(plot)</span>
<span id="cb110-521"><a href="#cb110-521" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-522"><a href="#cb110-522" aria-hidden="true" tabindex="-1"></a>  <span class="fu">invisible</span>(plot)</span>
<span id="cb110-523"><a href="#cb110-523" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb110-524"><a href="#cb110-524" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-525"><a href="#cb110-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-528"><a href="#cb110-528" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-529"><a href="#cb110-529" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb110-530"><a href="#cb110-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-531"><a href="#cb110-531" aria-hidden="true" tabindex="-1"></a>plot_hist <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb110-532"><a href="#cb110-532" aria-hidden="true" tabindex="-1"></a>    x,</span>
<span id="cb110-533"><a href="#cb110-533" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"x"</span>,</span>
<span id="cb110-534"><a href="#cb110-534" aria-hidden="true" tabindex="-1"></a>    <span class="at">bins =</span> <span class="dv">30</span>,</span>
<span id="cb110-535"><a href="#cb110-535" aria-hidden="true" tabindex="-1"></a>    <span class="at">stat =</span> <span class="st">"density"</span>,</span>
<span id="cb110-536"><a href="#cb110-536" aria-hidden="true" tabindex="-1"></a>    <span class="at">text_size =</span> <span class="cn">NULL</span>,</span>
<span id="cb110-537"><a href="#cb110-537" aria-hidden="true" tabindex="-1"></a>    <span class="at">density_line =</span> <span class="cn">TRUE</span>,</span>
<span id="cb110-538"><a href="#cb110-538" aria-hidden="true" tabindex="-1"></a>    <span class="at">na_rm =</span> <span class="cn">TRUE</span>,</span>
<span id="cb110-539"><a href="#cb110-539" aria-hidden="true" tabindex="-1"></a>    <span class="at">print =</span> <span class="cn">TRUE</span></span>
<span id="cb110-540"><a href="#cb110-540" aria-hidden="true" tabindex="-1"></a>  ) {</span>
<span id="cb110-541"><a href="#cb110-541" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_numeric</span>(x)</span>
<span id="cb110-542"><a href="#cb110-542" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_string</span>(name)</span>
<span id="cb110-543"><a href="#cb110-543" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_number</span>(bins, <span class="at">lower =</span> <span class="dv">1</span>)</span>
<span id="cb110-544"><a href="#cb110-544" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_choice</span>(stat, <span class="fu">c</span>(<span class="st">"count"</span>, <span class="st">"density"</span>))</span>
<span id="cb110-545"><a href="#cb110-545" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_number</span>(text_size, <span class="at">null.ok =</span> <span class="cn">TRUE</span>)</span>
<span id="cb110-546"><a href="#cb110-546" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_flag</span>(density_line)</span>
<span id="cb110-547"><a href="#cb110-547" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_flag</span>(na_rm)</span>
<span id="cb110-548"><a href="#cb110-548" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_flag</span>(print)</span>
<span id="cb110-549"><a href="#cb110-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-550"><a href="#cb110-550" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">isTRUE</span>(na_rm)) x <span class="ot">&lt;-</span> x <span class="sc">|&gt;</span> rutils<span class="sc">:::</span><span class="fu">drop_na</span>()</span>
<span id="cb110-551"><a href="#cb110-551" aria-hidden="true" tabindex="-1"></a>  y_lab <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(stat <span class="sc">==</span> <span class="st">"count"</span>, <span class="st">"Frequency"</span>, <span class="st">"Density"</span>)</span>
<span id="cb110-552"><a href="#cb110-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-553"><a href="#cb110-553" aria-hidden="true" tabindex="-1"></a>  plot <span class="ot">&lt;-</span></span>
<span id="cb110-554"><a href="#cb110-554" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">y =</span> x) <span class="sc">|&gt;</span></span>
<span id="cb110-555"><a href="#cb110-555" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> y)) <span class="sc">+</span></span>
<span id="cb110-556"><a href="#cb110-556" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_histogram</span>(</span>
<span id="cb110-557"><a href="#cb110-557" aria-hidden="true" tabindex="-1"></a>      ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">y =</span> ggplot2<span class="sc">::</span><span class="fu">after_stat</span>(<span class="sc">!!</span><span class="fu">as.symbol</span>(stat))),</span>
<span id="cb110-558"><a href="#cb110-558" aria-hidden="true" tabindex="-1"></a>      <span class="at">bins =</span> <span class="dv">30</span>, </span>
<span id="cb110-559"><a href="#cb110-559" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"white"</span></span>
<span id="cb110-560"><a href="#cb110-560" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb110-561"><a href="#cb110-561" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> name, <span class="at">y =</span> y_lab) <span class="sc">+</span></span>
<span id="cb110-562"><a href="#cb110-562" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">text =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">size =</span> text_size))</span>
<span id="cb110-563"><a href="#cb110-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-564"><a href="#cb110-564" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (stat <span class="sc">==</span> <span class="st">"density"</span> <span class="sc">&amp;&amp;</span> <span class="fu">isTRUE</span>(density_line)) {</span>
<span id="cb110-565"><a href="#cb110-565" aria-hidden="true" tabindex="-1"></a>    plot <span class="ot">&lt;-</span> plot <span class="sc">+</span> ggplot2<span class="sc">::</span><span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>)</span>
<span id="cb110-566"><a href="#cb110-566" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb110-567"><a href="#cb110-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-568"><a href="#cb110-568" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">isTRUE</span>(print)) <span class="fu">print</span>(plot)</span>
<span id="cb110-569"><a href="#cb110-569" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-570"><a href="#cb110-570" aria-hidden="true" tabindex="-1"></a>  <span class="fu">invisible</span>(plot)</span>
<span id="cb110-571"><a href="#cb110-571" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb110-572"><a href="#cb110-572" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-573"><a href="#cb110-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-576"><a href="#cb110-576" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-577"><a href="#cb110-577" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb110-578"><a href="#cb110-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-579"><a href="#cb110-579" aria-hidden="true" tabindex="-1"></a>plot_ggally <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb110-580"><a href="#cb110-580" aria-hidden="true" tabindex="-1"></a>    data,</span>
<span id="cb110-581"><a href="#cb110-581" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">names</span>(data),</span>
<span id="cb110-582"><a href="#cb110-582" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="cn">NULL</span>,</span>
<span id="cb110-583"><a href="#cb110-583" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis_labels =</span> <span class="st">"none"</span>,</span>
<span id="cb110-584"><a href="#cb110-584" aria-hidden="true" tabindex="-1"></a>    <span class="at">na_rm =</span> <span class="cn">TRUE</span>,</span>
<span id="cb110-585"><a href="#cb110-585" aria-hidden="true" tabindex="-1"></a>    <span class="at">text_size =</span> <span class="cn">NULL</span></span>
<span id="cb110-586"><a href="#cb110-586" aria-hidden="true" tabindex="-1"></a>  ) {</span>
<span id="cb110-587"><a href="#cb110-587" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_tibble</span>(data)</span>
<span id="cb110-588"><a href="#cb110-588" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_character</span>(cols)</span>
<span id="cb110-589"><a href="#cb110-589" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_subset</span>(cols, <span class="fu">names</span>(data))</span>
<span id="cb110-590"><a href="#cb110-590" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_class</span>(mapping, <span class="st">"uneval"</span>, <span class="at">null.ok =</span> <span class="cn">TRUE</span>)</span>
<span id="cb110-591"><a href="#cb110-591" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_choice</span>(axis_labels, <span class="fu">c</span>(<span class="st">"show"</span>, <span class="st">"internal"</span>, <span class="st">"none"</span>))</span>
<span id="cb110-592"><a href="#cb110-592" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_flag</span>(na_rm)</span>
<span id="cb110-593"><a href="#cb110-593" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_number</span>(text_size, <span class="at">null.ok =</span> <span class="cn">TRUE</span>)</span>
<span id="cb110-594"><a href="#cb110-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-595"><a href="#cb110-595" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span></span>
<span id="cb110-596"><a href="#cb110-596" aria-hidden="true" tabindex="-1"></a>    data<span class="sc">|&gt;</span></span>
<span id="cb110-597"><a href="#cb110-597" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(dplyr<span class="sc">::</span><span class="fu">all_of</span>(cols))<span class="sc">|&gt;</span></span>
<span id="cb110-598"><a href="#cb110-598" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb110-599"><a href="#cb110-599" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">across</span>(</span>
<span id="cb110-600"><a href="#cb110-600" aria-hidden="true" tabindex="-1"></a>      <span class="at">.cols =</span> dplyr<span class="sc">::</span><span class="fu">where</span>(hms<span class="sc">::</span>is_hms),</span>
<span id="cb110-601"><a href="#cb110-601" aria-hidden="true" tabindex="-1"></a>      <span class="at">.fns =</span> <span class="sc">~</span> <span class="fu">midday_trigger</span>(.x)</span>
<span id="cb110-602"><a href="#cb110-602" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb110-603"><a href="#cb110-603" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">across</span>(</span>
<span id="cb110-604"><a href="#cb110-604" aria-hidden="true" tabindex="-1"></a>        <span class="at">.cols =</span> dplyr<span class="sc">::</span><span class="fu">where</span>(</span>
<span id="cb110-605"><a href="#cb110-605" aria-hidden="true" tabindex="-1"></a>          <span class="sc">~</span> <span class="sc">!</span><span class="fu">is.character</span>(.x) <span class="sc">&amp;&amp;</span> <span class="sc">!</span><span class="fu">is.factor</span>(.x) <span class="sc">&amp;&amp;</span> <span class="sc">!</span><span class="fu">is.numeric</span>(.x)</span>
<span id="cb110-606"><a href="#cb110-606" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb110-607"><a href="#cb110-607" aria-hidden="true" tabindex="-1"></a>        <span class="at">.fns =</span> <span class="sc">~</span> <span class="fu">as.numeric</span>(.x)</span>
<span id="cb110-608"><a href="#cb110-608" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb110-609"><a href="#cb110-609" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb110-610"><a href="#cb110-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-611"><a href="#cb110-611" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">isTRUE</span>(na_rm)) out <span class="ot">&lt;-</span> out<span class="sc">|&gt;</span> tidyr<span class="sc">::</span><span class="fu">drop_na</span>(dplyr<span class="sc">::</span><span class="fu">all_of</span>(cols))</span>
<span id="cb110-612"><a href="#cb110-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-613"><a href="#cb110-613" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(mapping)) {</span>
<span id="cb110-614"><a href="#cb110-614" aria-hidden="true" tabindex="-1"></a>    plot <span class="ot">&lt;-</span></span>
<span id="cb110-615"><a href="#cb110-615" aria-hidden="true" tabindex="-1"></a>      out<span class="sc">|&gt;</span></span>
<span id="cb110-616"><a href="#cb110-616" aria-hidden="true" tabindex="-1"></a>      GGally<span class="sc">::</span><span class="fu">ggpairs</span>(</span>
<span id="cb110-617"><a href="#cb110-617" aria-hidden="true" tabindex="-1"></a>        <span class="at">lower =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="st">"smooth"</span>),</span>
<span id="cb110-618"><a href="#cb110-618" aria-hidden="true" tabindex="-1"></a>        <span class="at">axisLabels =</span> axis_labels</span>
<span id="cb110-619"><a href="#cb110-619" aria-hidden="true" tabindex="-1"></a>      ) </span>
<span id="cb110-620"><a href="#cb110-620" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb110-621"><a href="#cb110-621" aria-hidden="true" tabindex="-1"></a>    plot <span class="ot">&lt;-</span></span>
<span id="cb110-622"><a href="#cb110-622" aria-hidden="true" tabindex="-1"></a>      out<span class="sc">|&gt;</span></span>
<span id="cb110-623"><a href="#cb110-623" aria-hidden="true" tabindex="-1"></a>      GGally<span class="sc">::</span><span class="fu">ggpairs</span>(</span>
<span id="cb110-624"><a href="#cb110-624" aria-hidden="true" tabindex="-1"></a>        <span class="at">mapping =</span> mapping,</span>
<span id="cb110-625"><a href="#cb110-625" aria-hidden="true" tabindex="-1"></a>        <span class="at">axisLabels =</span> axis_labels</span>
<span id="cb110-626"><a href="#cb110-626" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb110-627"><a href="#cb110-627" aria-hidden="true" tabindex="-1"></a>      viridis<span class="sc">::</span><span class="fu">scale_color_viridis</span>(</span>
<span id="cb110-628"><a href="#cb110-628" aria-hidden="true" tabindex="-1"></a>        <span class="at">begin =</span> <span class="fl">0.25</span>,</span>
<span id="cb110-629"><a href="#cb110-629" aria-hidden="true" tabindex="-1"></a>        <span class="at">end =</span> <span class="fl">0.75</span>,</span>
<span id="cb110-630"><a href="#cb110-630" aria-hidden="true" tabindex="-1"></a>        <span class="at">discrete =</span> <span class="cn">TRUE</span>,</span>
<span id="cb110-631"><a href="#cb110-631" aria-hidden="true" tabindex="-1"></a>        <span class="at">option =</span> <span class="st">"viridis"</span></span>
<span id="cb110-632"><a href="#cb110-632" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb110-633"><a href="#cb110-633" aria-hidden="true" tabindex="-1"></a>      viridis<span class="sc">::</span><span class="fu">scale_fill_viridis</span>(</span>
<span id="cb110-634"><a href="#cb110-634" aria-hidden="true" tabindex="-1"></a>        <span class="at">begin =</span> <span class="fl">0.25</span>,</span>
<span id="cb110-635"><a href="#cb110-635" aria-hidden="true" tabindex="-1"></a>        <span class="at">end =</span> <span class="fl">0.75</span>,</span>
<span id="cb110-636"><a href="#cb110-636" aria-hidden="true" tabindex="-1"></a>        <span class="at">discrete =</span> <span class="cn">TRUE</span>,</span>
<span id="cb110-637"><a href="#cb110-637" aria-hidden="true" tabindex="-1"></a>        <span class="at">option =</span> <span class="st">"viridis"</span></span>
<span id="cb110-638"><a href="#cb110-638" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb110-639"><a href="#cb110-639" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb110-640"><a href="#cb110-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-641"><a href="#cb110-641" aria-hidden="true" tabindex="-1"></a>  plot <span class="ot">&lt;-</span> </span>
<span id="cb110-642"><a href="#cb110-642" aria-hidden="true" tabindex="-1"></a>    plot <span class="sc">+</span></span>
<span id="cb110-643"><a href="#cb110-643" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">text =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">size =</span> text_size))</span>
<span id="cb110-644"><a href="#cb110-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-645"><a href="#cb110-645" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(plot)</span>
<span id="cb110-646"><a href="#cb110-646" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-647"><a href="#cb110-647" aria-hidden="true" tabindex="-1"></a>  <span class="fu">invisible</span>(plot)</span>
<span id="cb110-648"><a href="#cb110-648" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb110-649"><a href="#cb110-649" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-650"><a href="#cb110-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-653"><a href="#cb110-653" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-654"><a href="#cb110-654" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb110-655"><a href="#cb110-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-656"><a href="#cb110-656" aria-hidden="true" tabindex="-1"></a>test_normality <span class="ot">&lt;-</span> <span class="cf">function</span>(x,</span>
<span id="cb110-657"><a href="#cb110-657" aria-hidden="true" tabindex="-1"></a>                           <span class="at">name =</span> <span class="st">"x"</span>,</span>
<span id="cb110-658"><a href="#cb110-658" aria-hidden="true" tabindex="-1"></a>                           <span class="at">remove_outliers =</span> <span class="cn">FALSE</span>,</span>
<span id="cb110-659"><a href="#cb110-659" aria-hidden="true" tabindex="-1"></a>                           <span class="at">iqr_mult =</span> <span class="fl">1.5</span>,</span>
<span id="cb110-660"><a href="#cb110-660" aria-hidden="true" tabindex="-1"></a>                           <span class="at">log_transform =</span> <span class="cn">FALSE</span>,</span>
<span id="cb110-661"><a href="#cb110-661" aria-hidden="true" tabindex="-1"></a>                           <span class="at">density_line =</span> <span class="cn">TRUE</span>,</span>
<span id="cb110-662"><a href="#cb110-662" aria-hidden="true" tabindex="-1"></a>                           <span class="at">text_size =</span> <span class="cn">NULL</span>,</span>
<span id="cb110-663"><a href="#cb110-663" aria-hidden="true" tabindex="-1"></a>                           <span class="at">print =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb110-664"><a href="#cb110-664" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_numeric</span>(x)</span>
<span id="cb110-665"><a href="#cb110-665" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_string</span>(name)</span>
<span id="cb110-666"><a href="#cb110-666" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_flag</span>(remove_outliers)</span>
<span id="cb110-667"><a href="#cb110-667" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_number</span>(iqr_mult, <span class="at">lower =</span> <span class="dv">1</span>)</span>
<span id="cb110-668"><a href="#cb110-668" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_flag</span>(log_transform)</span>
<span id="cb110-669"><a href="#cb110-669" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_flag</span>(density_line)</span>
<span id="cb110-670"><a href="#cb110-670" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_number</span>(text_size, <span class="at">null.ok =</span> <span class="cn">TRUE</span>)</span>
<span id="cb110-671"><a href="#cb110-671" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_flag</span>(print)</span>
<span id="cb110-672"><a href="#cb110-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-673"><a href="#cb110-673" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> x <span class="sc">|&gt;</span> <span class="fu">length</span>()</span>
<span id="cb110-674"><a href="#cb110-674" aria-hidden="true" tabindex="-1"></a>  n_rm_na <span class="ot">&lt;-</span> x <span class="sc">|&gt;</span> rutils<span class="sc">:::</span><span class="fu">drop_na</span>() <span class="sc">|&gt;</span> <span class="fu">length</span>()</span>
<span id="cb110-675"><a href="#cb110-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-676"><a href="#cb110-676" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">isTRUE</span>(remove_outliers)) {</span>
<span id="cb110-677"><a href="#cb110-677" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> x <span class="sc">|&gt;</span> <span class="fu">remove_outliers</span>(<span class="at">method =</span> <span class="st">"iqr"</span>, <span class="at">iqr_mult =</span> iqr_mult)</span>
<span id="cb110-678"><a href="#cb110-678" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb110-679"><a href="#cb110-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-680"><a href="#cb110-680" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">isTRUE</span>(log_transform)) {</span>
<span id="cb110-681"><a href="#cb110-681" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span></span>
<span id="cb110-682"><a href="#cb110-682" aria-hidden="true" tabindex="-1"></a>      x <span class="sc">|&gt;</span></span>
<span id="cb110-683"><a href="#cb110-683" aria-hidden="true" tabindex="-1"></a>      <span class="fu">log</span>() <span class="sc">|&gt;</span></span>
<span id="cb110-684"><a href="#cb110-684" aria-hidden="true" tabindex="-1"></a>      <span class="fu">drop_inf</span>()</span>
<span id="cb110-685"><a href="#cb110-685" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb110-686"><a href="#cb110-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-687"><a href="#cb110-687" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (n_rm_na <span class="sc">&gt;=</span> <span class="dv">7</span>) {</span>
<span id="cb110-688"><a href="#cb110-688" aria-hidden="true" tabindex="-1"></a>    ad <span class="ot">&lt;-</span> x <span class="sc">|&gt;</span> nortest<span class="sc">::</span><span class="fu">ad.test</span>()</span>
<span id="cb110-689"><a href="#cb110-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-690"><a href="#cb110-690" aria-hidden="true" tabindex="-1"></a>    cvm <span class="ot">&lt;-</span></span>
<span id="cb110-691"><a href="#cb110-691" aria-hidden="true" tabindex="-1"></a>      x <span class="sc">|&gt;</span></span>
<span id="cb110-692"><a href="#cb110-692" aria-hidden="true" tabindex="-1"></a>      nortest<span class="sc">::</span><span class="fu">cvm.test</span>() <span class="sc">|&gt;</span></span>
<span id="cb110-693"><a href="#cb110-693" aria-hidden="true" tabindex="-1"></a>      rutils<span class="sc">:::</span><span class="fu">shush</span>()</span>
<span id="cb110-694"><a href="#cb110-694" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb110-695"><a href="#cb110-695" aria-hidden="true" tabindex="-1"></a>    ad <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb110-696"><a href="#cb110-696" aria-hidden="true" tabindex="-1"></a>    cmv <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb110-697"><a href="#cb110-697" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb110-698"><a href="#cb110-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-699"><a href="#cb110-699" aria-hidden="true" tabindex="-1"></a>  bonett <span class="ot">&lt;-</span> x <span class="sc">|&gt;</span> moments<span class="sc">::</span><span class="fu">bonett.test</span>()</span>
<span id="cb110-700"><a href="#cb110-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-701"><a href="#cb110-701" aria-hidden="true" tabindex="-1"></a>  <span class="co"># See also `Rita::DPTest()` (just for Omnibus (K) tests).</span></span>
<span id="cb110-702"><a href="#cb110-702" aria-hidden="true" tabindex="-1"></a>  dagostino <span class="ot">&lt;-</span></span>
<span id="cb110-703"><a href="#cb110-703" aria-hidden="true" tabindex="-1"></a>    x <span class="sc">|&gt;</span></span>
<span id="cb110-704"><a href="#cb110-704" aria-hidden="true" tabindex="-1"></a>    fBasics<span class="sc">::</span><span class="fu">dagoTest</span>() <span class="sc">|&gt;</span></span>
<span id="cb110-705"><a href="#cb110-705" aria-hidden="true" tabindex="-1"></a>    rutils<span class="sc">:::</span><span class="fu">shush</span>()</span>
<span id="cb110-706"><a href="#cb110-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-707"><a href="#cb110-707" aria-hidden="true" tabindex="-1"></a>  jarque_bera <span class="ot">&lt;-</span></span>
<span id="cb110-708"><a href="#cb110-708" aria-hidden="true" tabindex="-1"></a>    rutils<span class="sc">:::</span><span class="fu">drop_na</span>(x) <span class="sc">|&gt;</span></span>
<span id="cb110-709"><a href="#cb110-709" aria-hidden="true" tabindex="-1"></a>    tseries<span class="sc">::</span><span class="fu">jarque.bera.test</span>()</span>
<span id="cb110-710"><a href="#cb110-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-711"><a href="#cb110-711" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (n_rm_na <span class="sc">&gt;=</span> <span class="dv">4</span>) {</span>
<span id="cb110-712"><a href="#cb110-712" aria-hidden="true" tabindex="-1"></a>    lillie_ks <span class="ot">&lt;-</span> x <span class="sc">|&gt;</span> nortest<span class="sc">::</span><span class="fu">lillie.test</span>()</span>
<span id="cb110-713"><a href="#cb110-713" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb110-714"><a href="#cb110-714" aria-hidden="true" tabindex="-1"></a>    lillie_ks <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb110-715"><a href="#cb110-715" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb110-716"><a href="#cb110-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-717"><a href="#cb110-717" aria-hidden="true" tabindex="-1"></a>  pearson <span class="ot">&lt;-</span> x <span class="sc">|&gt;</span> nortest<span class="sc">::</span><span class="fu">pearson.test</span>()</span>
<span id="cb110-718"><a href="#cb110-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-719"><a href="#cb110-719" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (n_rm_na <span class="sc">&gt;=</span> <span class="dv">5</span> <span class="sc">&amp;&amp;</span> n_rm_na <span class="sc">&lt;=</span> <span class="dv">5000</span>) {</span>
<span id="cb110-720"><a href="#cb110-720" aria-hidden="true" tabindex="-1"></a>    sf <span class="ot">&lt;-</span> x <span class="sc">|&gt;</span> nortest<span class="sc">::</span><span class="fu">sf.test</span>()</span>
<span id="cb110-721"><a href="#cb110-721" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb110-722"><a href="#cb110-722" aria-hidden="true" tabindex="-1"></a>    sf <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb110-723"><a href="#cb110-723" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb110-724"><a href="#cb110-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-725"><a href="#cb110-725" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (n_rm_na <span class="sc">&gt;=</span> <span class="dv">3</span> <span class="sc">&amp;&amp;</span> n_rm_na <span class="sc">&lt;=</span> <span class="dv">3000</span>) {</span>
<span id="cb110-726"><a href="#cb110-726" aria-hidden="true" tabindex="-1"></a>    shapiro <span class="ot">&lt;-</span> x <span class="sc">|&gt;</span> stats<span class="sc">::</span><span class="fu">shapiro.test</span>()</span>
<span id="cb110-727"><a href="#cb110-727" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb110-728"><a href="#cb110-728" aria-hidden="true" tabindex="-1"></a>    shapiro <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb110-729"><a href="#cb110-729" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb110-730"><a href="#cb110-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-731"><a href="#cb110-731" aria-hidden="true" tabindex="-1"></a>  qq_plot <span class="ot">&lt;-</span> x <span class="sc">|&gt;</span> <span class="fu">plot_qq</span>(<span class="at">text_size =</span> text_size, <span class="at">print =</span> <span class="cn">FALSE</span>)</span>
<span id="cb110-732"><a href="#cb110-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-733"><a href="#cb110-733" aria-hidden="true" tabindex="-1"></a>  hist_plot <span class="ot">&lt;-</span></span>
<span id="cb110-734"><a href="#cb110-734" aria-hidden="true" tabindex="-1"></a>    x <span class="sc">|&gt;</span></span>
<span id="cb110-735"><a href="#cb110-735" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot_hist</span>(</span>
<span id="cb110-736"><a href="#cb110-736" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> name,</span>
<span id="cb110-737"><a href="#cb110-737" aria-hidden="true" tabindex="-1"></a>      <span class="at">text_size =</span> text_size,</span>
<span id="cb110-738"><a href="#cb110-738" aria-hidden="true" tabindex="-1"></a>      <span class="at">density_line =</span> density_line,</span>
<span id="cb110-739"><a href="#cb110-739" aria-hidden="true" tabindex="-1"></a>      <span class="at">print =</span> <span class="cn">FALSE</span></span>
<span id="cb110-740"><a href="#cb110-740" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb110-741"><a href="#cb110-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-742"><a href="#cb110-742" aria-hidden="true" tabindex="-1"></a>  grid_plot <span class="ot">&lt;-</span> cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(hist_plot, qq_plot, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb110-743"><a href="#cb110-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-744"><a href="#cb110-744" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb110-745"><a href="#cb110-745" aria-hidden="true" tabindex="-1"></a>    <span class="at">stats =</span> <span class="fu">stats_sum</span>(</span>
<span id="cb110-746"><a href="#cb110-746" aria-hidden="true" tabindex="-1"></a>      x,</span>
<span id="cb110-747"><a href="#cb110-747" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> name,</span>
<span id="cb110-748"><a href="#cb110-748" aria-hidden="true" tabindex="-1"></a>      <span class="at">na_rm =</span> <span class="cn">TRUE</span>,</span>
<span id="cb110-749"><a href="#cb110-749" aria-hidden="true" tabindex="-1"></a>      <span class="at">remove_outliers =</span> <span class="cn">FALSE</span>,</span>
<span id="cb110-750"><a href="#cb110-750" aria-hidden="true" tabindex="-1"></a>      <span class="at">as_list =</span> <span class="cn">TRUE</span></span>
<span id="cb110-751"><a href="#cb110-751" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb110-752"><a href="#cb110-752" aria-hidden="true" tabindex="-1"></a>    <span class="at">params =</span> <span class="fu">list</span>(</span>
<span id="cb110-753"><a href="#cb110-753" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> name,</span>
<span id="cb110-754"><a href="#cb110-754" aria-hidden="true" tabindex="-1"></a>      <span class="at">remove_outliers =</span> remove_outliers,</span>
<span id="cb110-755"><a href="#cb110-755" aria-hidden="true" tabindex="-1"></a>      <span class="at">log_transform =</span> log_transform,</span>
<span id="cb110-756"><a href="#cb110-756" aria-hidden="true" tabindex="-1"></a>      <span class="at">density_line =</span> density_line</span>
<span id="cb110-757"><a href="#cb110-757" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb110-758"><a href="#cb110-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-759"><a href="#cb110-759" aria-hidden="true" tabindex="-1"></a>    <span class="at">ad =</span> ad,</span>
<span id="cb110-760"><a href="#cb110-760" aria-hidden="true" tabindex="-1"></a>    <span class="at">bonett =</span> bonett,</span>
<span id="cb110-761"><a href="#cb110-761" aria-hidden="true" tabindex="-1"></a>    <span class="at">cvm =</span> cvm,</span>
<span id="cb110-762"><a href="#cb110-762" aria-hidden="true" tabindex="-1"></a>    <span class="at">dagostino =</span> dagostino,</span>
<span id="cb110-763"><a href="#cb110-763" aria-hidden="true" tabindex="-1"></a>    <span class="at">jarque_bera =</span> jarque_bera,</span>
<span id="cb110-764"><a href="#cb110-764" aria-hidden="true" tabindex="-1"></a>    <span class="at">lillie_ks =</span> lillie_ks,</span>
<span id="cb110-765"><a href="#cb110-765" aria-hidden="true" tabindex="-1"></a>    <span class="at">pearson =</span> pearson,</span>
<span id="cb110-766"><a href="#cb110-766" aria-hidden="true" tabindex="-1"></a>    <span class="at">sf =</span> sf,</span>
<span id="cb110-767"><a href="#cb110-767" aria-hidden="true" tabindex="-1"></a>    <span class="at">shapiro =</span> shapiro,</span>
<span id="cb110-768"><a href="#cb110-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-769"><a href="#cb110-769" aria-hidden="true" tabindex="-1"></a>    <span class="at">hist_plot =</span> hist_plot,</span>
<span id="cb110-770"><a href="#cb110-770" aria-hidden="true" tabindex="-1"></a>    <span class="at">qq_plot =</span> qq_plot,</span>
<span id="cb110-771"><a href="#cb110-771" aria-hidden="true" tabindex="-1"></a>    <span class="at">grid_plot =</span> grid_plot</span>
<span id="cb110-772"><a href="#cb110-772" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb110-773"><a href="#cb110-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-774"><a href="#cb110-774" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">isTRUE</span>(print)) <span class="fu">print</span>(grid_plot)</span>
<span id="cb110-775"><a href="#cb110-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-776"><a href="#cb110-776" aria-hidden="true" tabindex="-1"></a>  <span class="fu">invisible</span>(out)</span>
<span id="cb110-777"><a href="#cb110-777" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb110-778"><a href="#cb110-778" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-779"><a href="#cb110-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-782"><a href="#cb110-782" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-783"><a href="#cb110-783" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb110-784"><a href="#cb110-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-785"><a href="#cb110-785" aria-hidden="true" tabindex="-1"></a>normality_sum <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb110-786"><a href="#cb110-786" aria-hidden="true" tabindex="-1"></a>    x, </span>
<span id="cb110-787"><a href="#cb110-787" aria-hidden="true" tabindex="-1"></a>    <span class="at">round =</span> <span class="cn">FALSE</span>, </span>
<span id="cb110-788"><a href="#cb110-788" aria-hidden="true" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">5</span>, </span>
<span id="cb110-789"><a href="#cb110-789" aria-hidden="true" tabindex="-1"></a>    <span class="at">only_p_value =</span> <span class="cn">FALSE</span>, </span>
<span id="cb110-790"><a href="#cb110-790" aria-hidden="true" tabindex="-1"></a>    ...</span>
<span id="cb110-791"><a href="#cb110-791" aria-hidden="true" tabindex="-1"></a>  ) {</span>
<span id="cb110-792"><a href="#cb110-792" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_numeric</span>(x)</span>
<span id="cb110-793"><a href="#cb110-793" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_flag</span>(round)</span>
<span id="cb110-794"><a href="#cb110-794" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_number</span>(digits)</span>
<span id="cb110-795"><a href="#cb110-795" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_flag</span>(only_p_value)</span>
<span id="cb110-796"><a href="#cb110-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-797"><a href="#cb110-797" aria-hidden="true" tabindex="-1"></a>  stats <span class="ot">&lt;-</span> <span class="fu">test_normality</span>(x, <span class="at">print =</span> <span class="cn">FALSE</span>, ...)</span>
<span id="cb110-798"><a href="#cb110-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-799"><a href="#cb110-799" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb110-800"><a href="#cb110-800" aria-hidden="true" tabindex="-1"></a>    <span class="at">test =</span> <span class="fu">c</span>(</span>
<span id="cb110-801"><a href="#cb110-801" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Anderson-Darling"</span>,</span>
<span id="cb110-802"><a href="#cb110-802" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Bonett-Seier"</span>,</span>
<span id="cb110-803"><a href="#cb110-803" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Cramér-von Mises"</span>,</span>
<span id="cb110-804"><a href="#cb110-804" aria-hidden="true" tabindex="-1"></a>      <span class="st">"D'Agostino Omnibus Test"</span>,</span>
<span id="cb110-805"><a href="#cb110-805" aria-hidden="true" tabindex="-1"></a>      <span class="st">"D'Agostino Skewness Test"</span>,</span>
<span id="cb110-806"><a href="#cb110-806" aria-hidden="true" tabindex="-1"></a>      <span class="st">"D'Agostino Kurtosis Test"</span>,</span>
<span id="cb110-807"><a href="#cb110-807" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Jarque–Bera"</span>,</span>
<span id="cb110-808"><a href="#cb110-808" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Lilliefors (K-S)"</span>,</span>
<span id="cb110-809"><a href="#cb110-809" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Pearson chi-square"</span>,</span>
<span id="cb110-810"><a href="#cb110-810" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Shapiro-Francia"</span>,</span>
<span id="cb110-811"><a href="#cb110-811" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Shapiro-Wilk"</span></span>
<span id="cb110-812"><a href="#cb110-812" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb110-813"><a href="#cb110-813" aria-hidden="true" tabindex="-1"></a>    <span class="at">statistic_1 =</span> <span class="fu">c</span>(</span>
<span id="cb110-814"><a href="#cb110-814" aria-hidden="true" tabindex="-1"></a>      stats<span class="sc">$</span>ad<span class="sc">$</span>statistic,</span>
<span id="cb110-815"><a href="#cb110-815" aria-hidden="true" tabindex="-1"></a>      stats<span class="sc">$</span>bonett<span class="sc">$</span>statistic[<span class="dv">1</span>],</span>
<span id="cb110-816"><a href="#cb110-816" aria-hidden="true" tabindex="-1"></a>      stats<span class="sc">$</span>cvm<span class="sc">$</span>statistic,</span>
<span id="cb110-817"><a href="#cb110-817" aria-hidden="true" tabindex="-1"></a>      <span class="fu">attr</span>(stats<span class="sc">$</span>dagostino, <span class="st">"test"</span>)<span class="sc">$</span>statistic[<span class="dv">1</span>],</span>
<span id="cb110-818"><a href="#cb110-818" aria-hidden="true" tabindex="-1"></a>      <span class="fu">attr</span>(stats<span class="sc">$</span>dagostino, <span class="st">"test"</span>)<span class="sc">$</span>statistic[<span class="dv">2</span>],</span>
<span id="cb110-819"><a href="#cb110-819" aria-hidden="true" tabindex="-1"></a>      <span class="fu">attr</span>(stats<span class="sc">$</span>dagostino, <span class="st">"test"</span>)<span class="sc">$</span>statistic[<span class="dv">3</span>],</span>
<span id="cb110-820"><a href="#cb110-820" aria-hidden="true" tabindex="-1"></a>      stats<span class="sc">$</span>jarque_bera<span class="sc">$</span>statistic,</span>
<span id="cb110-821"><a href="#cb110-821" aria-hidden="true" tabindex="-1"></a>      stats<span class="sc">$</span>lillie_ks<span class="sc">$</span>statistic,</span>
<span id="cb110-822"><a href="#cb110-822" aria-hidden="true" tabindex="-1"></a>      stats<span class="sc">$</span>pearson<span class="sc">$</span>statistic,</span>
<span id="cb110-823"><a href="#cb110-823" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ifelse</span>(<span class="fu">is.null</span>(stats<span class="sc">$</span>shapiro), <span class="cn">NA</span>, stats<span class="sc">$</span>shapiro<span class="sc">$</span>statistic),</span>
<span id="cb110-824"><a href="#cb110-824" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ifelse</span>(<span class="fu">is.null</span>(stats<span class="sc">$</span>sf), <span class="cn">NA</span>, stats<span class="sc">$</span>sf<span class="sc">$</span>statistic)</span>
<span id="cb110-825"><a href="#cb110-825" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb110-826"><a href="#cb110-826" aria-hidden="true" tabindex="-1"></a>    <span class="at">statistic_2 =</span> <span class="fu">c</span>(</span>
<span id="cb110-827"><a href="#cb110-827" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.numeric</span>(<span class="cn">NA</span>),</span>
<span id="cb110-828"><a href="#cb110-828" aria-hidden="true" tabindex="-1"></a>      stats<span class="sc">$</span>bonett<span class="sc">$</span>statistic[<span class="dv">2</span>],</span>
<span id="cb110-829"><a href="#cb110-829" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.numeric</span>(<span class="cn">NA</span>),</span>
<span id="cb110-830"><a href="#cb110-830" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.numeric</span>(<span class="cn">NA</span>),</span>
<span id="cb110-831"><a href="#cb110-831" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.numeric</span>(<span class="cn">NA</span>),</span>
<span id="cb110-832"><a href="#cb110-832" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.numeric</span>(<span class="cn">NA</span>),</span>
<span id="cb110-833"><a href="#cb110-833" aria-hidden="true" tabindex="-1"></a>      stats<span class="sc">$</span>jarque_bera<span class="sc">$</span>parameter,</span>
<span id="cb110-834"><a href="#cb110-834" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.numeric</span>(<span class="cn">NA</span>),</span>
<span id="cb110-835"><a href="#cb110-835" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.numeric</span>(<span class="cn">NA</span>),</span>
<span id="cb110-836"><a href="#cb110-836" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.numeric</span>(<span class="cn">NA</span>),</span>
<span id="cb110-837"><a href="#cb110-837" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.numeric</span>(<span class="cn">NA</span>)</span>
<span id="cb110-838"><a href="#cb110-838" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb110-839"><a href="#cb110-839" aria-hidden="true" tabindex="-1"></a>    <span class="at">p_value =</span> <span class="fu">c</span>(</span>
<span id="cb110-840"><a href="#cb110-840" aria-hidden="true" tabindex="-1"></a>      stats<span class="sc">$</span>ad<span class="sc">$</span>p.value,</span>
<span id="cb110-841"><a href="#cb110-841" aria-hidden="true" tabindex="-1"></a>      stats<span class="sc">$</span>bonett<span class="sc">$</span>p.value,</span>
<span id="cb110-842"><a href="#cb110-842" aria-hidden="true" tabindex="-1"></a>      stats<span class="sc">$</span>cvm<span class="sc">$</span>p.value,</span>
<span id="cb110-843"><a href="#cb110-843" aria-hidden="true" tabindex="-1"></a>      <span class="fu">attr</span>(stats<span class="sc">$</span>dagostino, <span class="st">"test"</span>)<span class="sc">$</span>p.value[<span class="dv">1</span>],</span>
<span id="cb110-844"><a href="#cb110-844" aria-hidden="true" tabindex="-1"></a>      <span class="fu">attr</span>(stats<span class="sc">$</span>dagostino, <span class="st">"test"</span>)<span class="sc">$</span>p.value[<span class="dv">2</span>],</span>
<span id="cb110-845"><a href="#cb110-845" aria-hidden="true" tabindex="-1"></a>      <span class="fu">attr</span>(stats<span class="sc">$</span>dagostino, <span class="st">"test"</span>)<span class="sc">$</span>p.value[<span class="dv">3</span>],</span>
<span id="cb110-846"><a href="#cb110-846" aria-hidden="true" tabindex="-1"></a>      stats<span class="sc">$</span>jarque_bera<span class="sc">$</span>p.value,</span>
<span id="cb110-847"><a href="#cb110-847" aria-hidden="true" tabindex="-1"></a>      stats<span class="sc">$</span>lillie_ks<span class="sc">$</span>p.value,</span>
<span id="cb110-848"><a href="#cb110-848" aria-hidden="true" tabindex="-1"></a>      stats<span class="sc">$</span>pearson<span class="sc">$</span>p.value,</span>
<span id="cb110-849"><a href="#cb110-849" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ifelse</span>(<span class="fu">is.null</span>(stats<span class="sc">$</span>shapiro), <span class="cn">NA</span>, stats<span class="sc">$</span>shapiro<span class="sc">$</span>p.value),</span>
<span id="cb110-850"><a href="#cb110-850" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ifelse</span>(<span class="fu">is.null</span>(stats<span class="sc">$</span>sf), <span class="cn">NA</span>, stats<span class="sc">$</span>sf<span class="sc">$</span>p.value)</span>
<span id="cb110-851"><a href="#cb110-851" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb110-852"><a href="#cb110-852" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb110-853"><a href="#cb110-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-854"><a href="#cb110-854" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">isTRUE</span>(only_p_value)) out <span class="ot">&lt;-</span> out <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(test, p_value)</span>
<span id="cb110-855"><a href="#cb110-855" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-856"><a href="#cb110-856" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">isTRUE</span>(round)) {</span>
<span id="cb110-857"><a href="#cb110-857" aria-hidden="true" tabindex="-1"></a>    out <span class="sc">|&gt;</span></span>
<span id="cb110-858"><a href="#cb110-858" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb110-859"><a href="#cb110-859" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">across</span>(</span>
<span id="cb110-860"><a href="#cb110-860" aria-hidden="true" tabindex="-1"></a>          <span class="at">.cols =</span> dplyr<span class="sc">::</span><span class="fu">where</span>(is.numeric),</span>
<span id="cb110-861"><a href="#cb110-861" aria-hidden="true" tabindex="-1"></a>          <span class="at">.fns =</span> <span class="sc">~</span> <span class="fu">round</span>(.x, digits)</span>
<span id="cb110-862"><a href="#cb110-862" aria-hidden="true" tabindex="-1"></a>        ))</span>
<span id="cb110-863"><a href="#cb110-863" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb110-864"><a href="#cb110-864" aria-hidden="true" tabindex="-1"></a>    out</span>
<span id="cb110-865"><a href="#cb110-865" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb110-866"><a href="#cb110-866" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb110-867"><a href="#cb110-867" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-868"><a href="#cb110-868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-869"><a href="#cb110-869" aria-hidden="true" tabindex="-1"></a><span class="fu">## Preparing the data</span></span>
<span id="cb110-870"><a href="#cb110-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-871"><a href="#cb110-871" aria-hidden="true" tabindex="-1"></a>**Assumption 1** is satisfied, as the predictors are known.</span>
<span id="cb110-872"><a href="#cb110-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-875"><a href="#cb110-875" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-876"><a href="#cb110-876" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> </span>
<span id="cb110-877"><a href="#cb110-877" aria-hidden="true" tabindex="-1"></a>  palmerpenguins<span class="sc">::</span>penguins <span class="sc">|&gt;</span> </span>
<span id="cb110-878"><a href="#cb110-878" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(species <span class="sc">==</span> <span class="st">"Adelie"</span>) <span class="sc">|&gt;</span></span>
<span id="cb110-879"><a href="#cb110-879" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(bill_length_mm, bill_depth_mm, flipper_length_mm) <span class="sc">|&gt;</span></span>
<span id="cb110-880"><a href="#cb110-880" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">drop_na</span>()</span>
<span id="cb110-881"><a href="#cb110-881" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-882"><a href="#cb110-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-883"><a href="#cb110-883" aria-hidden="true" tabindex="-1"></a>::: {#tbl-data-prep-1}</span>
<span id="cb110-886"><a href="#cb110-886" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-887"><a href="#cb110-887" aria-hidden="true" tabindex="-1"></a>data</span>
<span id="cb110-888"><a href="#cb110-888" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-889"><a href="#cb110-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-890"><a href="#cb110-890" aria-hidden="true" tabindex="-1"></a>Data frame with morphological measurements of penguin species from the <span class="co">[</span><span class="ot">Palmer Archipelago</span><span class="co">](https://en.wikipedia.org/wiki/Palmer_Archipelago)</span>.</span>
<span id="cb110-891"><a href="#cb110-891" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb110-892"><a href="#cb110-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-895"><a href="#cb110-895" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-896"><a href="#cb110-896" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">report</span>(data)</span>
<span id="cb110-897"><a href="#cb110-897" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-898"><a href="#cb110-898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-899"><a href="#cb110-899" aria-hidden="true" tabindex="-1"></a><span class="fu">## Performing the power analysis</span></span>
<span id="cb110-900"><a href="#cb110-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-901"><a href="#cb110-901" aria-hidden="true" tabindex="-1"></a>First we will perform a *a posteriori* power analysis to determine the sample size needed to achieve a power ($1 - \beta$) of 0.8, given an $R^2$ of 0.5, a significance level ($\alpha$) of 0.05, and 2 predictors. It's a *a posterior* analysis because we already have the data in hand. It's a good practice to perform a power analysis before running the model to ensure that the sample size is adequate.</span>
<span id="cb110-902"><a href="#cb110-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-903"><a href="#cb110-903" aria-hidden="true" tabindex="-1"></a>The results show that we need at least 14 observations to achieve the desired power. We have 151 observations, which is more than enough.</span>
<span id="cb110-904"><a href="#cb110-904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-907"><a href="#cb110-907" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-908"><a href="#cb110-908" aria-hidden="true" tabindex="-1"></a>pre_pwr <span class="ot">&lt;-</span> pwrss<span class="sc">::</span><span class="fu">pwrss.f.reg</span>(</span>
<span id="cb110-909"><a href="#cb110-909" aria-hidden="true" tabindex="-1"></a>  <span class="at">r2 =</span> <span class="fl">0.5</span>, </span>
<span id="cb110-910"><a href="#cb110-910" aria-hidden="true" tabindex="-1"></a>  <span class="at">k =</span> <span class="dv">2</span>,</span>
<span id="cb110-911"><a href="#cb110-911" aria-hidden="true" tabindex="-1"></a>  <span class="at">power =</span> <span class="fl">0.80</span>,</span>
<span id="cb110-912"><a href="#cb110-912" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fl">0.05</span></span>
<span id="cb110-913"><a href="#cb110-913" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb110-914"><a href="#cb110-914" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-915"><a href="#cb110-915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-918"><a href="#cb110-918" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-919"><a href="#cb110-919" aria-hidden="true" tabindex="-1"></a>pwrss<span class="sc">::</span><span class="fu">power.f.test</span>(</span>
<span id="cb110-920"><a href="#cb110-920" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncp =</span> pre_pwr<span class="sc">$</span>ncp,</span>
<span id="cb110-921"><a href="#cb110-921" aria-hidden="true" tabindex="-1"></a>  <span class="at">df1 =</span> pre_pwr<span class="sc">$</span>df1,</span>
<span id="cb110-922"><a href="#cb110-922" aria-hidden="true" tabindex="-1"></a>  <span class="at">df2 =</span> pre_pwr<span class="sc">$</span>df2,</span>
<span id="cb110-923"><a href="#cb110-923" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> pre_pwr<span class="sc">$</span>parms<span class="sc">$</span>alpha,</span>
<span id="cb110-924"><a href="#cb110-924" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot =</span> <span class="cn">TRUE</span></span>
<span id="cb110-925"><a href="#cb110-925" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb110-926"><a href="#cb110-926" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-927"><a href="#cb110-927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-930"><a href="#cb110-930" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-931"><a href="#cb110-931" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(data) <span class="sc">&gt;=</span> pre_pwr<span class="sc">$</span>n</span>
<span id="cb110-932"><a href="#cb110-932" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-933"><a href="#cb110-933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-934"><a href="#cb110-934" aria-hidden="true" tabindex="-1"></a><span class="fu">## Checking distributions</span></span>
<span id="cb110-935"><a href="#cb110-935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-936"><a href="#cb110-936" aria-hidden="true" tabindex="-1"></a>The data show fairly normal distributions. It seems that the <span class="in">`bill_length_mm`</span> and <span class="in">`bill_depth_mm`</span> variables appear slightly skewed, while the <span class="in">`flipper_length_mm`</span> variable is more symmetric.</span>
<span id="cb110-937"><a href="#cb110-937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-938"><a href="#cb110-938" aria-hidden="true" tabindex="-1"></a>:::: {.panel-tabset}</span>
<span id="cb110-939"><a href="#cb110-939" aria-hidden="true" tabindex="-1"></a><span class="fu">### Bill length (mm)</span></span>
<span id="cb110-940"><a href="#cb110-940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-941"><a href="#cb110-941" aria-hidden="true" tabindex="-1"></a>::: {#tbl-var-dist-stats-sum-bill_length_mm}</span>
<span id="cb110-944"><a href="#cb110-944" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-945"><a href="#cb110-945" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb110-946"><a href="#cb110-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-947"><a href="#cb110-947" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span></span>
<span id="cb110-948"><a href="#cb110-948" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(bill_length_mm) <span class="sc">|&gt;</span> </span>
<span id="cb110-949"><a href="#cb110-949" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stats_sum</span>(<span class="at">name =</span> <span class="st">"Bill length (mm)"</span>)</span>
<span id="cb110-950"><a href="#cb110-950" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-951"><a href="#cb110-951" aria-hidden="true" tabindex="-1"></a>Statistics for the <span class="in">`bill_length_mm`</span> variable.</span>
<span id="cb110-952"><a href="#cb110-952" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb110-953"><a href="#cb110-953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-954"><a href="#cb110-954" aria-hidden="true" tabindex="-1"></a>::: {#fig-var-dist-hist-bill_length_mm}</span>
<span id="cb110-957"><a href="#cb110-957" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-958"><a href="#cb110-958" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb110-959"><a href="#cb110-959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-960"><a href="#cb110-960" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb110-961"><a href="#cb110-961" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(bill_length_mm) <span class="sc">|&gt;</span> </span>
<span id="cb110-962"><a href="#cb110-962" aria-hidden="true" tabindex="-1"></a>  <span class="fu">test_normality</span>(<span class="at">name =</span> <span class="st">"Bill length (mm)"</span>)</span>
<span id="cb110-963"><a href="#cb110-963" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-964"><a href="#cb110-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-965"><a href="#cb110-965" aria-hidden="true" tabindex="-1"></a>Histogram of the <span class="in">`bill_length_mm`</span> variable with a kernel density estimate, along with a quantile-quantile (Q-Q) plot between the variable and the theoretical quantiles of the normal distribution.</span>
<span id="cb110-966"><a href="#cb110-966" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb110-967"><a href="#cb110-967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-968"><a href="#cb110-968" aria-hidden="true" tabindex="-1"></a><span class="fu">### Bill depth (mm)</span></span>
<span id="cb110-969"><a href="#cb110-969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-970"><a href="#cb110-970" aria-hidden="true" tabindex="-1"></a>::: {#tbl-var-dist-stats-sum-bill_depth_mm}</span>
<span id="cb110-973"><a href="#cb110-973" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-974"><a href="#cb110-974" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb110-975"><a href="#cb110-975" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-976"><a href="#cb110-976" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb110-977"><a href="#cb110-977" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(bill_depth_mm) <span class="sc">|&gt;</span> </span>
<span id="cb110-978"><a href="#cb110-978" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stats_sum</span>(<span class="at">name =</span> <span class="st">"Bill depth (mm)"</span>)</span>
<span id="cb110-979"><a href="#cb110-979" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-980"><a href="#cb110-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-981"><a href="#cb110-981" aria-hidden="true" tabindex="-1"></a>Summary statistics for the <span class="in">`bill_depth_mm`</span> variable.</span>
<span id="cb110-982"><a href="#cb110-982" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb110-983"><a href="#cb110-983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-984"><a href="#cb110-984" aria-hidden="true" tabindex="-1"></a>::: {#fig-var-dist-hist-bill_depth_mm}</span>
<span id="cb110-987"><a href="#cb110-987" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-988"><a href="#cb110-988" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb110-989"><a href="#cb110-989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-990"><a href="#cb110-990" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb110-991"><a href="#cb110-991" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(bill_depth_mm) <span class="sc">|&gt;</span> </span>
<span id="cb110-992"><a href="#cb110-992" aria-hidden="true" tabindex="-1"></a>  <span class="fu">test_normality</span>(<span class="at">name =</span> <span class="st">"Bill depth (mm)"</span>)</span>
<span id="cb110-993"><a href="#cb110-993" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-994"><a href="#cb110-994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-995"><a href="#cb110-995" aria-hidden="true" tabindex="-1"></a>Histogram of the <span class="in">`bill_depth_mm`</span> variable with a kernel density estimate, along with a quantile-quantile (Q-Q) plot between the variable and the theoretical quantiles of the normal distribution.</span>
<span id="cb110-996"><a href="#cb110-996" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb110-997"><a href="#cb110-997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-998"><a href="#cb110-998" aria-hidden="true" tabindex="-1"></a><span class="fu">### Flipper length (mm)</span></span>
<span id="cb110-999"><a href="#cb110-999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1000"><a href="#cb110-1000" aria-hidden="true" tabindex="-1"></a>::: {#tbl-var-dist-stats-sum-flipper_length_mm}</span>
<span id="cb110-1003"><a href="#cb110-1003" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1004"><a href="#cb110-1004" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb110-1005"><a href="#cb110-1005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1006"><a href="#cb110-1006" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb110-1007"><a href="#cb110-1007" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(flipper_length_mm) <span class="sc">|&gt;</span> </span>
<span id="cb110-1008"><a href="#cb110-1008" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stats_sum</span>(<span class="at">name =</span> <span class="st">"Flipper length (mm)"</span>)</span>
<span id="cb110-1009"><a href="#cb110-1009" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1010"><a href="#cb110-1010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1011"><a href="#cb110-1011" aria-hidden="true" tabindex="-1"></a>Summary statistics for the <span class="in">`flipper_length_mm`</span> variable.</span>
<span id="cb110-1012"><a href="#cb110-1012" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb110-1013"><a href="#cb110-1013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1014"><a href="#cb110-1014" aria-hidden="true" tabindex="-1"></a>::: {#fig-var-dist-hist-flipper_length_mm}</span>
<span id="cb110-1017"><a href="#cb110-1017" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1018"><a href="#cb110-1018" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb110-1019"><a href="#cb110-1019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1020"><a href="#cb110-1020" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb110-1021"><a href="#cb110-1021" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(flipper_length_mm) <span class="sc">|&gt;</span> </span>
<span id="cb110-1022"><a href="#cb110-1022" aria-hidden="true" tabindex="-1"></a>  <span class="fu">test_normality</span>(<span class="at">name =</span> <span class="st">"Flipper length (mm)"</span>)</span>
<span id="cb110-1023"><a href="#cb110-1023" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1024"><a href="#cb110-1024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1025"><a href="#cb110-1025" aria-hidden="true" tabindex="-1"></a>Histogram of the <span class="in">`flipper_length_mm`</span> variable with a kernel density estimate, along with a quantile-quantile (Q-Q) plot between the variable and the theoretical quantiles of the normal distribution.</span>
<span id="cb110-1026"><a href="#cb110-1026" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb110-1027"><a href="#cb110-1027" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb110-1028"><a href="#cb110-1028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1029"><a href="#cb110-1029" aria-hidden="true" tabindex="-1"></a><span class="fu">## Checking correlations</span></span>
<span id="cb110-1030"><a href="#cb110-1030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1031"><a href="#cb110-1031" aria-hidden="true" tabindex="-1"></a>Both <span class="in">`bill_length_mm`</span> and <span class="in">`bill_depth_mm`</span> are positively correlated with <span class="in">`flipper_length_mm`</span> in a significant manner. No non-linear relationships are observed.</span>
<span id="cb110-1032"><a href="#cb110-1032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1033"><a href="#cb110-1033" aria-hidden="true" tabindex="-1"></a>::: {#fig-correlations-correlation-matrix}</span>
<span id="cb110-1036"><a href="#cb110-1036" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1037"><a href="#cb110-1037" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> <span class="fu">plot_ggally</span>() <span class="sc">|&gt;</span> rutils<span class="sc">:::</span><span class="fu">shush</span>()</span>
<span id="cb110-1038"><a href="#cb110-1038" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1039"><a href="#cb110-1039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1040"><a href="#cb110-1040" aria-hidden="true" tabindex="-1"></a>Correlation matrix of <span class="in">`bill_length_mm`</span>, <span class="in">`bill_depth_mm`</span>, and <span class="in">`flipper_length_mm`</span> variables.</span>
<span id="cb110-1041"><a href="#cb110-1041" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb110-1042"><a href="#cb110-1042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1043"><a href="#cb110-1043" aria-hidden="true" tabindex="-1"></a><span class="fu">## Checking for outliers</span></span>
<span id="cb110-1044"><a href="#cb110-1044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1045"><a href="#cb110-1045" aria-hidden="true" tabindex="-1"></a>A few minor outliers are present in the <span class="in">`bill_length_mm`</span> and <span class="in">`flipper_length_mm`</span> variables. We could remove these outliers, but they are not extreme and do not appear to be errors.</span>
<span id="cb110-1046"><a href="#cb110-1046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1047"><a href="#cb110-1047" aria-hidden="true" tabindex="-1"></a>A few observations were flagged with Cook’s D values greater than the threshold. One of them (129th) was particularly influential, so it was removed from the dataset.</span>
<span id="cb110-1048"><a href="#cb110-1048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1049"><a href="#cb110-1049" aria-hidden="true" tabindex="-1"></a><span class="fu">### Boxplots</span></span>
<span id="cb110-1050"><a href="#cb110-1050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1053"><a href="#cb110-1053" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1054"><a href="#cb110-1054" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">gg_color_hue</span>(<span class="dv">3</span>)</span>
<span id="cb110-1055"><a href="#cb110-1055" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1056"><a href="#cb110-1056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1057"><a href="#cb110-1057" aria-hidden="true" tabindex="-1"></a>::: {#fig-outliers-1}</span>
<span id="cb110-1060"><a href="#cb110-1060" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1061"><a href="#cb110-1061" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb110-1062"><a href="#cb110-1062" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="sc">-</span>flipper_length_mm) <span class="sc">|&gt;</span></span>
<span id="cb110-1063"><a href="#cb110-1063" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> name, <span class="at">y =</span> value, <span class="at">fill =</span> name)) <span class="sc">+</span></span>
<span id="cb110-1064"><a href="#cb110-1064" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_boxplot</span>(</span>
<span id="cb110-1065"><a href="#cb110-1065" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.colour =</span> <span class="st">"red"</span>, </span>
<span id="cb110-1066"><a href="#cb110-1066" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.shape =</span> <span class="dv">1</span>,</span>
<span id="cb110-1067"><a href="#cb110-1067" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="fl">0.75</span></span>
<span id="cb110-1068"><a href="#cb110-1068" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb110-1069"><a href="#cb110-1069" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.3</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb110-1070"><a href="#cb110-1070" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Variable"</span>, <span class="at">y =</span> <span class="st">"Value"</span>, <span class="at">fill =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb110-1071"><a href="#cb110-1071" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_fill_manual</span>(</span>
<span id="cb110-1072"><a href="#cb110-1072" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Bill length (mm)"</span>, <span class="st">"Bill depth (mm)"</span>),</span>
<span id="cb110-1073"><a href="#cb110-1073" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">"bill_length_mm"</span>, <span class="st">"bill_depth_mm"</span>),</span>
<span id="cb110-1074"><a href="#cb110-1074" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">gg_color_hue</span>(<span class="dv">3</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb110-1075"><a href="#cb110-1075" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb110-1076"><a href="#cb110-1076" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb110-1077"><a href="#cb110-1077" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(</span>
<span id="cb110-1078"><a href="#cb110-1078" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>(),</span>
<span id="cb110-1079"><a href="#cb110-1079" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>(),</span>
<span id="cb110-1080"><a href="#cb110-1080" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.y =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>()</span>
<span id="cb110-1081"><a href="#cb110-1081" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb110-1082"><a href="#cb110-1082" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1083"><a href="#cb110-1083" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1084"><a href="#cb110-1084" aria-hidden="true" tabindex="-1"></a>Boxplots of the <span class="in">`bill_length_mm`</span> and <span class="in">`bill_depth_mm`</span> variables, with outliers highlighted in red and other data indicated by jittered points.</span>
<span id="cb110-1085"><a href="#cb110-1085" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb110-1086"><a href="#cb110-1086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1087"><a href="#cb110-1087" aria-hidden="true" tabindex="-1"></a>::: {#fig-outliers-2}</span>
<span id="cb110-1090"><a href="#cb110-1090" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1091"><a href="#cb110-1091" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb110-1092"><a href="#cb110-1092" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(flipper_length_mm) <span class="sc">|&gt;</span></span>
<span id="cb110-1093"><a href="#cb110-1093" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> name, <span class="at">y =</span> value, <span class="at">fill =</span> name)) <span class="sc">+</span></span>
<span id="cb110-1094"><a href="#cb110-1094" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_boxplot</span>(</span>
<span id="cb110-1095"><a href="#cb110-1095" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.colour =</span> <span class="st">"red"</span>, </span>
<span id="cb110-1096"><a href="#cb110-1096" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.shape =</span> <span class="dv">1</span>,</span>
<span id="cb110-1097"><a href="#cb110-1097" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="fl">0.5</span></span>
<span id="cb110-1098"><a href="#cb110-1098" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb110-1099"><a href="#cb110-1099" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb110-1100"><a href="#cb110-1100" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_fill_manual</span>(</span>
<span id="cb110-1101"><a href="#cb110-1101" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="st">"Flipper length (mm)"</span>,</span>
<span id="cb110-1102"><a href="#cb110-1102" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">gg_color_hue</span>(<span class="dv">3</span>) <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">last</span>()</span>
<span id="cb110-1103"><a href="#cb110-1103" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb110-1104"><a href="#cb110-1104" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Variable"</span>, <span class="at">y =</span> <span class="st">"Value"</span>, <span class="at">fill =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb110-1105"><a href="#cb110-1105" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb110-1106"><a href="#cb110-1106" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(</span>
<span id="cb110-1107"><a href="#cb110-1107" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>(),</span>
<span id="cb110-1108"><a href="#cb110-1108" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>(),</span>
<span id="cb110-1109"><a href="#cb110-1109" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.y =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>()</span>
<span id="cb110-1110"><a href="#cb110-1110" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb110-1111"><a href="#cb110-1111" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1112"><a href="#cb110-1112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1113"><a href="#cb110-1113" aria-hidden="true" tabindex="-1"></a>Boxplot of the <span class="in">`flipper_length_mm`</span> variable, with outliers highlighted in red and other data indicated by jittered points.</span>
<span id="cb110-1114"><a href="#cb110-1114" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb110-1115"><a href="#cb110-1115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1116"><a href="#cb110-1116" aria-hidden="true" tabindex="-1"></a><span class="fu">### Cook's distance</span></span>
<span id="cb110-1117"><a href="#cb110-1117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1118"><a href="#cb110-1118" aria-hidden="true" tabindex="-1"></a>The <span class="co">[</span><span class="ot">Cook's distance</span><span class="co">](https://en.wikipedia.org/wiki/Cook%27s_distance)</span> measures each observation's influence on the model's fitted values. It is considered one of the most representative metrics for assessing overall influence <span class="co">[</span><span class="ot">@hair2019</span><span class="co">]</span>.</span>
<span id="cb110-1119"><a href="#cb110-1119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1120"><a href="#cb110-1120" aria-hidden="true" tabindex="-1"></a>A common practice is to flag observations with a Cook's distance of 1.0 or greater. However, a more conservative threshold of $4 / (n - k - 1)$, where $n$ is the sample size and $k$ is the number of independent variables, is suggested as a more conservative measure in small samples or for use with larger datasets <span class="co">[</span><span class="ot">@hair2019</span><span class="co">]</span>.</span>
<span id="cb110-1121"><a href="#cb110-1121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1122"><a href="#cb110-1122" aria-hidden="true" tabindex="-1"></a>Learn more about Cook's D in: @cook1977; @cook1979.</span>
<span id="cb110-1123"><a href="#cb110-1123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1126"><a href="#cb110-1126" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1127"><a href="#cb110-1127" aria-hidden="true" tabindex="-1"></a>cooks_d_cut_off <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="sc">/</span> (<span class="fu">nrow</span>(data) <span class="sc">-</span> <span class="dv">2</span> <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb110-1128"><a href="#cb110-1128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1129"><a href="#cb110-1129" aria-hidden="true" tabindex="-1"></a>cooks_d_cut_off</span>
<span id="cb110-1130"><a href="#cb110-1130" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1131"><a href="#cb110-1131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1134"><a href="#cb110-1134" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1135"><a href="#cb110-1135" aria-hidden="true" tabindex="-1"></a>form <span class="ot">&lt;-</span> <span class="fu">formula</span>(flipper_length_mm <span class="sc">~</span> bill_length_mm <span class="sc">+</span> bill_depth_mm)</span>
<span id="cb110-1136"><a href="#cb110-1136" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1137"><a href="#cb110-1137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1140"><a href="#cb110-1140" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1141"><a href="#cb110-1141" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(form, <span class="at">data =</span> data)</span>
<span id="cb110-1142"><a href="#cb110-1142" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1143"><a href="#cb110-1143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1146"><a href="#cb110-1146" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1147"><a href="#cb110-1147" aria-hidden="true" tabindex="-1"></a>cooks_obs <span class="ot">&lt;-</span> </span>
<span id="cb110-1148"><a href="#cb110-1148" aria-hidden="true" tabindex="-1"></a>  fit <span class="sc">|&gt;</span> </span>
<span id="cb110-1149"><a href="#cb110-1149" aria-hidden="true" tabindex="-1"></a>  stats<span class="sc">::</span><span class="fu">cooks.distance</span>() <span class="sc">%&gt;%</span></span>
<span id="cb110-1150"><a href="#cb110-1150" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">is_greater_than</span>(cooks_d_cut_off) <span class="sc">|&gt;</span></span>
<span id="cb110-1151"><a href="#cb110-1151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">which</span>() <span class="sc">|&gt;</span></span>
<span id="cb110-1152"><a href="#cb110-1152" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">names&lt;-</span><span class="st">`</span>(<span class="cn">NULL</span>)</span>
<span id="cb110-1153"><a href="#cb110-1153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1154"><a href="#cb110-1154" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">|&gt;</span></span>
<span id="cb110-1155"><a href="#cb110-1155" aria-hidden="true" tabindex="-1"></a>  stats<span class="sc">::</span><span class="fu">cooks.distance</span>() <span class="sc">|&gt;</span></span>
<span id="cb110-1156"><a href="#cb110-1156" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract</span>(cooks_obs)</span>
<span id="cb110-1157"><a href="#cb110-1157" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1158"><a href="#cb110-1158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1161"><a href="#cb110-1161" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1162"><a href="#cb110-1162" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> fit <span class="sc">|&gt;</span> olsrr<span class="sc">::</span><span class="fu">ols_plot_cooksd_bar</span>(<span class="at">print_plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb110-1163"><a href="#cb110-1163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1164"><a href="#cb110-1164" aria-hidden="true" tabindex="-1"></a>q <span class="ot">&lt;-</span> plot<span class="sc">$</span>plot <span class="sc">+</span> ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>())</span>
<span id="cb110-1165"><a href="#cb110-1165" aria-hidden="true" tabindex="-1"></a>q <span class="ot">&lt;-</span> q <span class="sc">|&gt;</span> ggplot2<span class="sc">::</span><span class="fu">ggplot_build</span>()</span>
<span id="cb110-1166"><a href="#cb110-1166" aria-hidden="true" tabindex="-1"></a>q<span class="sc">$</span>data[[<span class="dv">5</span>]]<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="st">""</span></span>
<span id="cb110-1167"><a href="#cb110-1167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1168"><a href="#cb110-1168" aria-hidden="true" tabindex="-1"></a>q <span class="sc">|&gt;</span> ggplot2<span class="sc">::</span><span class="fu">ggplot_gtable</span>() <span class="sc">|&gt;</span> ggplotify<span class="sc">::</span><span class="fu">as.ggplot</span>()</span>
<span id="cb110-1169"><a href="#cb110-1169" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1170"><a href="#cb110-1170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1171"><a href="#cb110-1171" aria-hidden="true" tabindex="-1"></a><span class="fu">### Outlier removal</span></span>
<span id="cb110-1172"><a href="#cb110-1172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1173"><a href="#cb110-1173" aria-hidden="true" tabindex="-1"></a>Outlier detection methods indicate which observations are unusual or influential, and it's our job to determine why certain observations stand out <span class="co">[</span><span class="ot">@struck2024</span><span class="co">]</span>. In this scenario, a <span class="co">[</span><span class="ot">observational error</span><span class="co">](https://en.wikipedia.org/wiki/Observational_error)</span> or a unique characteristic of the penguin species might be causing some distortions.</span>
<span id="cb110-1174"><a href="#cb110-1174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1175"><a href="#cb110-1175" aria-hidden="true" tabindex="-1"></a>For practical reasons, we will remove the 129th observation for now. However, it's crucial to review the model assumptions before making this decision. Violating an assumption might cause many observations to be incorrectly labeled as outliers.</span>
<span id="cb110-1176"><a href="#cb110-1176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1179"><a href="#cb110-1179" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1180"><a href="#cb110-1180" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">slice</span>(<span class="sc">-</span><span class="dv">129</span>)</span>
<span id="cb110-1181"><a href="#cb110-1181" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1182"><a href="#cb110-1182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1183"><a href="#cb110-1183" aria-hidden="true" tabindex="-1"></a><span class="fu">## Fitting the model</span></span>
<span id="cb110-1184"><a href="#cb110-1184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1187"><a href="#cb110-1187" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1188"><a href="#cb110-1188" aria-hidden="true" tabindex="-1"></a>recipe <span class="ot">&lt;-</span> </span>
<span id="cb110-1189"><a href="#cb110-1189" aria-hidden="true" tabindex="-1"></a>  data <span class="sc">|&gt;</span></span>
<span id="cb110-1190"><a href="#cb110-1190" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">recipe</span>(form) <span class="sc">|&gt;</span></span>
<span id="cb110-1191"><a href="#cb110-1191" aria-hidden="true" tabindex="-1"></a>  rutils<span class="sc">:::</span><span class="fu">shush</span>()</span>
<span id="cb110-1192"><a href="#cb110-1192" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1193"><a href="#cb110-1193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1196"><a href="#cb110-1196" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1197"><a href="#cb110-1197" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> </span>
<span id="cb110-1198"><a href="#cb110-1198" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">linear_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb110-1199"><a href="#cb110-1199" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">set_engine</span>(<span class="st">"lm"</span>) <span class="sc">|&gt;</span></span>
<span id="cb110-1200"><a href="#cb110-1200" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">set_mode</span>(<span class="st">"regression"</span>)</span>
<span id="cb110-1201"><a href="#cb110-1201" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1202"><a href="#cb110-1202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1205"><a href="#cb110-1205" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1206"><a href="#cb110-1206" aria-hidden="true" tabindex="-1"></a>workflow <span class="ot">&lt;-</span> </span>
<span id="cb110-1207"><a href="#cb110-1207" aria-hidden="true" tabindex="-1"></a>  workflows<span class="sc">::</span><span class="fu">workflow</span>() <span class="sc">|&gt;</span></span>
<span id="cb110-1208"><a href="#cb110-1208" aria-hidden="true" tabindex="-1"></a>  workflows<span class="sc">::</span><span class="fu">add_recipe</span>(recipe) <span class="sc">|&gt;</span></span>
<span id="cb110-1209"><a href="#cb110-1209" aria-hidden="true" tabindex="-1"></a>  workflows<span class="sc">::</span><span class="fu">add_model</span>(model)</span>
<span id="cb110-1210"><a href="#cb110-1210" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1211"><a href="#cb110-1211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1214"><a href="#cb110-1214" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1215"><a href="#cb110-1215" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> workflow <span class="sc">|&gt;</span> parsnip<span class="sc">::</span><span class="fu">fit</span>(data)</span>
<span id="cb110-1216"><a href="#cb110-1216" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1217"><a href="#cb110-1217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1218"><a href="#cb110-1218" aria-hidden="true" tabindex="-1"></a>::: {#tbl-model-fit-1}</span>
<span id="cb110-1221"><a href="#cb110-1221" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1222"><a href="#cb110-1222" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">|&gt;</span></span>
<span id="cb110-1223"><a href="#cb110-1223" aria-hidden="true" tabindex="-1"></a>  broom<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb110-1224"><a href="#cb110-1224" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">adorn_rounding</span>(<span class="dv">5</span>)</span>
<span id="cb110-1225"><a href="#cb110-1225" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1226"><a href="#cb110-1226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1227"><a href="#cb110-1227" aria-hidden="true" tabindex="-1"></a>Output from the model fitting process showing the estimated coefficients, standard errors, test statistics, and p-values for the terms in the linear regression model.</span>
<span id="cb110-1228"><a href="#cb110-1228" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb110-1229"><a href="#cb110-1229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1230"><a href="#cb110-1230" aria-hidden="true" tabindex="-1"></a>::: {#tbl-model-fit-2}</span>
<span id="cb110-1233"><a href="#cb110-1233" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1234"><a href="#cb110-1234" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">|&gt;</span> </span>
<span id="cb110-1235"><a href="#cb110-1235" aria-hidden="true" tabindex="-1"></a>  broom<span class="sc">::</span><span class="fu">augment</span>(data) <span class="sc">|&gt;</span></span>
<span id="cb110-1236"><a href="#cb110-1236" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">adorn_rounding</span>(<span class="dv">5</span>)</span>
<span id="cb110-1237"><a href="#cb110-1237" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1238"><a href="#cb110-1238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1239"><a href="#cb110-1239" aria-hidden="true" tabindex="-1"></a>Model summary table displaying predictions and residuals, along with the variables used in the model.</span>
<span id="cb110-1240"><a href="#cb110-1240" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb110-1241"><a href="#cb110-1241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1242"><a href="#cb110-1242" aria-hidden="true" tabindex="-1"></a>::: {#tbl-model-fit-3}</span>
<span id="cb110-1245"><a href="#cb110-1245" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1246"><a href="#cb110-1246" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">|&gt;</span> </span>
<span id="cb110-1247"><a href="#cb110-1247" aria-hidden="true" tabindex="-1"></a>  broom<span class="sc">::</span><span class="fu">glance</span>() <span class="sc">|&gt;</span> </span>
<span id="cb110-1248"><a href="#cb110-1248" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">cols =</span> dplyr<span class="sc">::</span><span class="fu">everything</span>()) <span class="sc">|&gt;</span></span>
<span id="cb110-1249"><a href="#cb110-1249" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">adorn_rounding</span>(<span class="dv">10</span>)</span>
<span id="cb110-1250"><a href="#cb110-1250" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1251"><a href="#cb110-1251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1252"><a href="#cb110-1252" aria-hidden="true" tabindex="-1"></a>Summary of model fit statistics showing key metrics including R-squared, adjusted R-squared, sigma, statistic, p-value, degrees of freedom, log-likelihood, AIC, BIC, and deviance.</span>
<span id="cb110-1253"><a href="#cb110-1253" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb110-1254"><a href="#cb110-1254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1257"><a href="#cb110-1257" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1258"><a href="#cb110-1258" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="ot">&lt;-</span> fit <span class="sc">|&gt;</span> parsnip<span class="sc">::</span><span class="fu">extract_fit_engine</span>()</span>
<span id="cb110-1259"><a href="#cb110-1259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1260"><a href="#cb110-1260" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span>
<span id="cb110-1261"><a href="#cb110-1261" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1262"><a href="#cb110-1262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1265"><a href="#cb110-1265" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1266"><a href="#cb110-1266" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> parameters<span class="sc">::</span><span class="fu">standardize_parameters</span>()</span>
<span id="cb110-1267"><a href="#cb110-1267" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1268"><a href="#cb110-1268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1271"><a href="#cb110-1271" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1272"><a href="#cb110-1272" aria-hidden="true" tabindex="-1"></a><span class="co"># A jerry-rigged solution to fix issues related to modeling using the pipe.</span></span>
<span id="cb110-1273"><a href="#cb110-1273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1274"><a href="#cb110-1274" aria-hidden="true" tabindex="-1"></a><span class="co"># fit_2 &lt;- fit</span></span>
<span id="cb110-1275"><a href="#cb110-1275" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb110-1276"><a href="#cb110-1276" aria-hidden="true" tabindex="-1"></a><span class="co"># fit_2$fit$fit$fit$call &lt;- call(</span></span>
<span id="cb110-1277"><a href="#cb110-1277" aria-hidden="true" tabindex="-1"></a><span class="co">#   "lm", </span></span>
<span id="cb110-1278"><a href="#cb110-1278" aria-hidden="true" tabindex="-1"></a><span class="co">#   flipper_length_mm ~ bill_length_mm + bill_depth_mm, </span></span>
<span id="cb110-1279"><a href="#cb110-1279" aria-hidden="true" tabindex="-1"></a><span class="co">#   data = quote("data")</span></span>
<span id="cb110-1280"><a href="#cb110-1280" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb110-1281"><a href="#cb110-1281" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb110-1282"><a href="#cb110-1282" aria-hidden="true" tabindex="-1"></a><span class="co"># fit_engine_2 &lt;- fit_2 |&gt; parsnip::extract_fit_engine()</span></span>
<span id="cb110-1283"><a href="#cb110-1283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1284"><a href="#cb110-1284" aria-hidden="true" tabindex="-1"></a>fit_engine_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(form, <span class="at">data =</span> data)</span>
<span id="cb110-1285"><a href="#cb110-1285" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1286"><a href="#cb110-1286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1289"><a href="#cb110-1289" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1290"><a href="#cb110-1290" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">report</span>(fit_engine_2)</span>
<span id="cb110-1291"><a href="#cb110-1291" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1292"><a href="#cb110-1292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1293"><a href="#cb110-1293" aria-hidden="true" tabindex="-1"></a><span class="fu">## Inspecting the model fit</span></span>
<span id="cb110-1294"><a href="#cb110-1294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1295"><a href="#cb110-1295" aria-hidden="true" tabindex="-1"></a><span class="fu">### General model</span></span>
<span id="cb110-1296"><a href="#cb110-1296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1297"><a href="#cb110-1297" aria-hidden="true" tabindex="-1"></a>In a multiple linear regression with two predictors, the model is fit by adjusting a plane to the data points.</span>
<span id="cb110-1298"><a href="#cb110-1298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1301"><a href="#cb110-1301" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1302"><a href="#cb110-1302" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb110-1303"><a href="#cb110-1303" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb110-1304"><a href="#cb110-1304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1305"><a href="#cb110-1305" aria-hidden="true" tabindex="-1"></a><span class="co"># Source: https://stackoverflow.com/a/70979149/8258804</span></span>
<span id="cb110-1306"><a href="#cb110-1306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1307"><a href="#cb110-1307" aria-hidden="true" tabindex="-1"></a><span class="co"># To find the `theta` and `phi` angles, do the following:</span></span>
<span id="cb110-1308"><a href="#cb110-1308" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb110-1309"><a href="#cb110-1309" aria-hidden="true" tabindex="-1"></a><span class="co"># * Install the `orientlib` package before doing this.</span></span>
<span id="cb110-1310"><a href="#cb110-1310" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb110-1311"><a href="#cb110-1311" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Run the chunk below to get a viewport open.</span></span>
<span id="cb110-1312"><a href="#cb110-1312" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Adjust the size of the viewport to the size of the Quarto chart rendering.</span></span>
<span id="cb110-1313"><a href="#cb110-1313" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Run `user_matrix &lt;- rgl::par3d()$userMatrix` to get the user matrix.</span></span>
<span id="cb110-1314"><a href="#cb110-1314" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Run `zoom &lt;- rgl::par3d()$zoom` to get the zoom.</span></span>
<span id="cb110-1315"><a href="#cb110-1315" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Add `user_matrix` and `zoom` to the `rgl::view3d()` function.</span></span>
<span id="cb110-1316"><a href="#cb110-1316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1317"><a href="#cb110-1317" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("orientlib")</span></span>
<span id="cb110-1318"><a href="#cb110-1318" aria-hidden="true" tabindex="-1"></a><span class="co"># user_matrix &lt;- rgl::par3d()$userMatrix</span></span>
<span id="cb110-1319"><a href="#cb110-1319" aria-hidden="true" tabindex="-1"></a><span class="co"># zoom &lt;- rgl::par3d()$zoom</span></span>
<span id="cb110-1320"><a href="#cb110-1320" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1321"><a href="#cb110-1321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1322"><a href="#cb110-1322" aria-hidden="true" tabindex="-1"></a>::: {#fig-model-fit-comparison-1}</span>
<span id="cb110-1325"><a href="#cb110-1325" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1326"><a href="#cb110-1326" aria-hidden="true" tabindex="-1"></a>user_matrix <span class="ot">&lt;-</span></span>
<span id="cb110-1327"><a href="#cb110-1327" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">tribble</span>(</span>
<span id="cb110-1328"><a href="#cb110-1328" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span>a,         <span class="sc">~</span>b,         <span class="sc">~</span>c,          <span class="sc">~</span>d,</span>
<span id="cb110-1329"><a href="#cb110-1329" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.6233152</span>,  <span class="sc">-</span><span class="fl">0.7817951</span>, <span class="sc">-</span><span class="fl">0.01657271</span>, <span class="dv">0</span>,</span>
<span id="cb110-1330"><a href="#cb110-1330" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.1739255</span>,  <span class="fl">0.1179437</span>,  <span class="fl">0.97767037</span>,  <span class="dv">0</span>,</span>
<span id="cb110-1331"><a href="#cb110-1331" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="fl">0.7623830</span>, <span class="sc">-</span><span class="fl">0.6122792</span>, <span class="fl">0.20949011</span>,  <span class="dv">0</span>,</span>
<span id="cb110-1332"><a href="#cb110-1332" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>,          <span class="dv">0</span>,          <span class="dv">0</span>,           <span class="dv">1</span></span>
<span id="cb110-1333"><a href="#cb110-1333" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb110-1334"><a href="#cb110-1334" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>() <span class="sc">|&gt;</span></span>
<span id="cb110-1335"><a href="#cb110-1335" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">colnames&lt;-</span><span class="st">`</span>(<span class="cn">NULL</span>)</span>
<span id="cb110-1336"><a href="#cb110-1336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1337"><a href="#cb110-1337" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span></span>
<span id="cb110-1338"><a href="#cb110-1338" aria-hidden="true" tabindex="-1"></a>  predict3d<span class="sc">::</span><span class="fu">predict3d</span>(</span>
<span id="cb110-1339"><a href="#cb110-1339" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">"Bill length (mm)"</span>,</span>
<span id="cb110-1340"><a href="#cb110-1340" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">"Bill depth (mm)"</span>,</span>
<span id="cb110-1341"><a href="#cb110-1341" aria-hidden="true" tabindex="-1"></a>    <span class="at">zlab =</span> <span class="st">"Flipper length (mm)"</span>,</span>
<span id="cb110-1342"><a href="#cb110-1342" aria-hidden="true" tabindex="-1"></a>    <span class="at">radius =</span> <span class="fl">0.75</span>,</span>
<span id="cb110-1343"><a href="#cb110-1343" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"s"</span>,</span>
<span id="cb110-1344"><a href="#cb110-1344" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"red"</span>,</span>
<span id="cb110-1345"><a href="#cb110-1345" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.subtitle =</span> <span class="cn">FALSE</span>,</span>
<span id="cb110-1346"><a href="#cb110-1346" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.error =</span> <span class="cn">FALSE</span></span>
<span id="cb110-1347"><a href="#cb110-1347" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb110-1348"><a href="#cb110-1348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1349"><a href="#cb110-1349" aria-hidden="true" tabindex="-1"></a>rgl<span class="sc">::</span><span class="fu">view3d</span>(<span class="at">userMatrix =</span> user_matrix, <span class="at">zoom =</span> <span class="fl">0.9</span>)</span>
<span id="cb110-1350"><a href="#cb110-1350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1351"><a href="#cb110-1351" aria-hidden="true" tabindex="-1"></a>rgl<span class="sc">::</span><span class="fu">rglwidget</span>(<span class="at">elementId =</span> <span class="st">"1st"</span>) <span class="sc">|&gt;</span> rutils<span class="sc">:::</span><span class="fu">shush</span>()</span>
<span id="cb110-1352"><a href="#cb110-1352" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1353"><a href="#cb110-1353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1354"><a href="#cb110-1354" aria-hidden="true" tabindex="-1"></a>A 3D visualization of the fitted model: the plane represents the fitted model, while the points represent the observed data. **Use the mouse to explore**.</span>
<span id="cb110-1355"><a href="#cb110-1355" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb110-1356"><a href="#cb110-1356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1357"><a href="#cb110-1357" aria-hidden="true" tabindex="-1"></a>::: {#fig-model-fit}</span>
<span id="cb110-1360"><a href="#cb110-1360" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1361"><a href="#cb110-1361" aria-hidden="true" tabindex="-1"></a>limits <span class="ot">&lt;-</span> </span>
<span id="cb110-1362"><a href="#cb110-1362" aria-hidden="true" tabindex="-1"></a>  stats<span class="sc">::</span><span class="fu">predict</span>(fit_engine, <span class="at">interval =</span> <span class="st">"prediction"</span>) <span class="sc">|&gt;</span></span>
<span id="cb110-1363"><a href="#cb110-1363" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">as_tibble</span>() <span class="sc">|&gt;</span></span>
<span id="cb110-1364"><a href="#cb110-1364" aria-hidden="true" tabindex="-1"></a>  rutils<span class="sc">:::</span><span class="fu">shush</span>()</span>
<span id="cb110-1365"><a href="#cb110-1365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1366"><a href="#cb110-1366" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">|&gt;</span></span>
<span id="cb110-1367"><a href="#cb110-1367" aria-hidden="true" tabindex="-1"></a>  broom<span class="sc">::</span><span class="fu">augment</span>(data) <span class="sc">|&gt;</span></span>
<span id="cb110-1368"><a href="#cb110-1368" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(limits) <span class="sc">|&gt;</span></span>
<span id="cb110-1369"><a href="#cb110-1369" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(flipper_length_mm, .pred)) <span class="sc">+</span></span>
<span id="cb110-1370"><a href="#cb110-1370" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ggplot2::geom_ribbon(</span></span>
<span id="cb110-1371"><a href="#cb110-1371" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   mapping = ggplot2::aes(ymin = lwr, ymax = upr),</span></span>
<span id="cb110-1372"><a href="#cb110-1372" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   alpha = 0.2</span></span>
<span id="cb110-1373"><a href="#cb110-1373" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ) +</span></span>
<span id="cb110-1374"><a href="#cb110-1374" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_ribbon</span>(</span>
<span id="cb110-1375"><a href="#cb110-1375" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> ggplot2<span class="sc">::</span><span class="fu">aes</span>(</span>
<span id="cb110-1376"><a href="#cb110-1376" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymin =</span> stats<span class="sc">::</span><span class="fu">predict</span>(stats<span class="sc">::</span><span class="fu">loess</span>(lwr <span class="sc">~</span> flipper_length_mm)),</span>
<span id="cb110-1377"><a href="#cb110-1377" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymax =</span> stats<span class="sc">::</span><span class="fu">predict</span>(stats<span class="sc">::</span><span class="fu">loess</span>(upr <span class="sc">~</span> flipper_length_mm)),</span>
<span id="cb110-1378"><a href="#cb110-1378" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb110-1379"><a href="#cb110-1379" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.2</span></span>
<span id="cb110-1380"><a href="#cb110-1380" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb110-1381"><a href="#cb110-1381" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_smooth</span>(</span>
<span id="cb110-1382"><a href="#cb110-1382" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">y =</span> lwr),</span>
<span id="cb110-1383"><a href="#cb110-1383" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="cn">FALSE</span>,</span>
<span id="cb110-1384"><a href="#cb110-1384" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"loess"</span>,</span>
<span id="cb110-1385"><a href="#cb110-1385" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb110-1386"><a href="#cb110-1386" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb110-1387"><a href="#cb110-1387" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">0.2</span>,</span>
<span id="cb110-1388"><a href="#cb110-1388" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"black"</span></span>
<span id="cb110-1389"><a href="#cb110-1389" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb110-1390"><a href="#cb110-1390" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_smooth</span>(</span>
<span id="cb110-1391"><a href="#cb110-1391" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">y =</span> upr),</span>
<span id="cb110-1392"><a href="#cb110-1392" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="cn">FALSE</span>,</span>
<span id="cb110-1393"><a href="#cb110-1393" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"loess"</span>,</span>
<span id="cb110-1394"><a href="#cb110-1394" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb110-1395"><a href="#cb110-1395" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb110-1396"><a href="#cb110-1396" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">0.2</span>,</span>
<span id="cb110-1397"><a href="#cb110-1397" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"black"</span></span>
<span id="cb110-1398"><a href="#cb110-1398" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb110-1399"><a href="#cb110-1399" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb110-1400"><a href="#cb110-1400" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb110-1401"><a href="#cb110-1401" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb110-1402"><a href="#cb110-1402" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Observed"</span>, </span>
<span id="cb110-1403"><a href="#cb110-1403" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Predicted"</span>, </span>
<span id="cb110-1404"><a href="#cb110-1404" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(</span>
<span id="cb110-1405"><a href="#cb110-1405" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(</span>
<span id="cb110-1406"><a href="#cb110-1406" aria-hidden="true" tabindex="-1"></a>        <span class="fu">lm_str_fun</span>(fit_engine, <span class="at">digits =</span> <span class="dv">3</span>, <span class="at">latex2exp =</span> <span class="cn">FALSE</span>), <span class="st">" | "</span>,</span>
<span id="cb110-1407"><a href="#cb110-1407" aria-hidden="true" tabindex="-1"></a>        <span class="st">"$R^{2} = "</span>, <span class="fu">round</span>(broom<span class="sc">::</span><span class="fu">glance</span>(fit)<span class="sc">$</span>r.squared, <span class="dv">3</span>), <span class="st">"$ | "</span>,</span>
<span id="cb110-1408"><a href="#cb110-1408" aria-hidden="true" tabindex="-1"></a>        <span class="st">"$R^{2}_{adj} = "</span>, <span class="fu">round</span>(broom<span class="sc">::</span><span class="fu">glance</span>(fit)<span class="sc">$</span>adj.r.squared, <span class="dv">3</span>), <span class="st">"$"</span></span>
<span id="cb110-1409"><a href="#cb110-1409" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb110-1410"><a href="#cb110-1410" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb110-1411"><a href="#cb110-1411" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb110-1412"><a href="#cb110-1412" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1413"><a href="#cb110-1413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1414"><a href="#cb110-1414" aria-hidden="true" tabindex="-1"></a>Relation between observed and predicted values. The red line is a 45-degree line originating from the plane's origin and represents a perfect fit. The shaded area depicts a smoothed version of the 95% confidence of the <span class="co">[</span><span class="ot">prediction interval</span><span class="co">](http://www.sthda.com/english/articles/40-regression-analysis/166-predict-in-r-model-predictions-and-confidence-intervals/)</span>.</span>
<span id="cb110-1415"><a href="#cb110-1415" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb110-1416"><a href="#cb110-1416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1417"><a href="#cb110-1417" aria-hidden="true" tabindex="-1"></a><span class="fu">### Adjusted predictions</span></span>
<span id="cb110-1418"><a href="#cb110-1418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1419"><a href="#cb110-1419" aria-hidden="true" tabindex="-1"></a>If we keep all predictors fixed except one, we can observe the regression line between that independent variable and the dependent variable. Here, we present different visualizations of the fitted model. This is important for understanding how each predictor is associated with the outcome.</span>
<span id="cb110-1420"><a href="#cb110-1420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1421"><a href="#cb110-1421" aria-hidden="true" tabindex="-1"></a>::: {#fig-model-fit-comparison-2}</span>
<span id="cb110-1424"><a href="#cb110-1424" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1425"><a href="#cb110-1425" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">|&gt;</span></span>
<span id="cb110-1426"><a href="#cb110-1426" aria-hidden="true" tabindex="-1"></a>  broom<span class="sc">::</span><span class="fu">augment</span>(data) <span class="sc">|&gt;</span></span>
<span id="cb110-1427"><a href="#cb110-1427" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(bill_length_mm, flipper_length_mm)) <span class="sc">+</span></span>
<span id="cb110-1428"><a href="#cb110-1428" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb110-1429"><a href="#cb110-1429" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_line</span>(</span>
<span id="cb110-1430"><a href="#cb110-1430" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">y =</span> .pred, <span class="at">color =</span> <span class="st">"Prediction"</span>),</span>
<span id="cb110-1431"><a href="#cb110-1431" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.5</span>,</span>
<span id="cb110-1432"><a href="#cb110-1432" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb110-1433"><a href="#cb110-1433" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb110-1434"><a href="#cb110-1434" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_function</span>(</span>
<span id="cb110-1435"><a href="#cb110-1435" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">y =</span> .pred, <span class="at">color =</span> <span class="st">"Adjusted prediction"</span>),</span>
<span id="cb110-1436"><a href="#cb110-1436" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> <span class="fu">lm_fun</span>(fit_engine, <span class="at">fix_all_but =</span> <span class="dv">1</span>, <span class="at">data =</span> data),</span>
<span id="cb110-1437"><a href="#cb110-1437" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="dv">1</span></span>
<span id="cb110-1438"><a href="#cb110-1438" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb110-1439"><a href="#cb110-1439" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb110-1440"><a href="#cb110-1440" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Bill length (mm)"</span>,</span>
<span id="cb110-1441"><a href="#cb110-1441" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Flipper length (mm)"</span>,</span>
<span id="cb110-1442"><a href="#cb110-1442" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">lm_str_fun</span>(fit_engine, <span class="at">fix_all_but =</span> <span class="dv">1</span>),</span>
<span id="cb110-1443"><a href="#cb110-1443" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>()</span>
<span id="cb110-1444"><a href="#cb110-1444" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb110-1445"><a href="#cb110-1445" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_color_manual</span>(</span>
<span id="cb110-1446"><a href="#cb110-1446" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Prediction"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"Adjusted prediction"</span> <span class="ot">=</span> <span class="st">"red"</span>)</span>
<span id="cb110-1447"><a href="#cb110-1447" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb110-1448"><a href="#cb110-1448" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1449"><a href="#cb110-1449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1450"><a href="#cb110-1450" aria-hidden="true" tabindex="-1"></a>Model prediction (blue line) and adjusted prediction (red line) plotted against a scatter plot of the dependent variable (<span class="in">`flipper_length_mm`</span>) and one of the independent variables (<span class="in">`bill_length_mm`</span>). The adjusted prediction is calculated by holding the <span class="in">`bill_depth_mm`</span> variable constant at its mean value.</span>
<span id="cb110-1451"><a href="#cb110-1451" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb110-1452"><a href="#cb110-1452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1453"><a href="#cb110-1453" aria-hidden="true" tabindex="-1"></a>::: {#fig-model-fit-comparison-3}</span>
<span id="cb110-1456"><a href="#cb110-1456" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1457"><a href="#cb110-1457" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">|&gt;</span></span>
<span id="cb110-1458"><a href="#cb110-1458" aria-hidden="true" tabindex="-1"></a>  broom<span class="sc">::</span><span class="fu">augment</span>(data) <span class="sc">|&gt;</span></span>
<span id="cb110-1459"><a href="#cb110-1459" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(bill_depth_mm, flipper_length_mm)) <span class="sc">+</span></span>
<span id="cb110-1460"><a href="#cb110-1460" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb110-1461"><a href="#cb110-1461" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_line</span>(</span>
<span id="cb110-1462"><a href="#cb110-1462" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">y =</span> .pred, <span class="at">color =</span> <span class="st">"Prediction"</span>), </span>
<span id="cb110-1463"><a href="#cb110-1463" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.5</span>,</span>
<span id="cb110-1464"><a href="#cb110-1464" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb110-1465"><a href="#cb110-1465" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb110-1466"><a href="#cb110-1466" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_function</span>(</span>
<span id="cb110-1467"><a href="#cb110-1467" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">y =</span> .pred, <span class="at">color =</span> <span class="st">"Adjusted prediction"</span>),</span>
<span id="cb110-1468"><a href="#cb110-1468" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> <span class="fu">lm_fun</span>(fit_engine, <span class="at">fix_all_but =</span> <span class="dv">2</span>, <span class="at">data =</span> data),</span>
<span id="cb110-1469"><a href="#cb110-1469" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="dv">1</span></span>
<span id="cb110-1470"><a href="#cb110-1470" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb110-1471"><a href="#cb110-1471" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb110-1472"><a href="#cb110-1472" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Bill depth (mm)"</span>,</span>
<span id="cb110-1473"><a href="#cb110-1473" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Flipper length (mm)"</span>,</span>
<span id="cb110-1474"><a href="#cb110-1474" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">lm_str_fun</span>(fit_engine, <span class="at">fix_all_but =</span> <span class="dv">2</span>),</span>
<span id="cb110-1475"><a href="#cb110-1475" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>()</span>
<span id="cb110-1476"><a href="#cb110-1476" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb110-1477"><a href="#cb110-1477" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_color_manual</span>(</span>
<span id="cb110-1478"><a href="#cb110-1478" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Prediction"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"Adjusted prediction"</span> <span class="ot">=</span> <span class="st">"red"</span>)</span>
<span id="cb110-1479"><a href="#cb110-1479" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb110-1480"><a href="#cb110-1480" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1481"><a href="#cb110-1481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1482"><a href="#cb110-1482" aria-hidden="true" tabindex="-1"></a>Model prediction (blue line) and adjusted prediction (red line) plotted against a scatter plot of the dependent variable (<span class="in">`flipper_length_mm`</span>) and one of the independent variables (<span class="in">`bill_depth_mm`</span>). The adjusted prediction is calculated by holding the <span class="in">`bill_depth_mm`</span> variable constant at its mean value.</span>
<span id="cb110-1483"><a href="#cb110-1483" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb110-1484"><a href="#cb110-1484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1485"><a href="#cb110-1485" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- See: https://cran.r-project.org/web/packages/predict3d/vignettes/predict3d.html --&gt;</span></span>
<span id="cb110-1486"><a href="#cb110-1486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1489"><a href="#cb110-1489" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1490"><a href="#cb110-1490" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb110-1491"><a href="#cb110-1491" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb110-1492"><a href="#cb110-1492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1493"><a href="#cb110-1493" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span></span>
<span id="cb110-1494"><a href="#cb110-1494" aria-hidden="true" tabindex="-1"></a>  predict3d<span class="sc">::</span><span class="fu">ggPredict</span>(</span>
<span id="cb110-1495"><a href="#cb110-1495" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.point =</span> <span class="cn">TRUE</span>,</span>
<span id="cb110-1496"><a href="#cb110-1496" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="cn">FALSE</span>, </span>
<span id="cb110-1497"><a href="#cb110-1497" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.1</span>,</span>
<span id="cb110-1498"><a href="#cb110-1498" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.text =</span> <span class="cn">FALSE</span>,</span>
<span id="cb110-1499"><a href="#cb110-1499" aria-hidden="true" tabindex="-1"></a>    <span class="at">xpos =</span> <span class="fl">0.5</span>,</span>
<span id="cb110-1500"><a href="#cb110-1500" aria-hidden="true" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb110-1501"><a href="#cb110-1501" aria-hidden="true" tabindex="-1"></a>    <span class="at">facet.modx =</span> <span class="cn">FALSE</span></span>
<span id="cb110-1502"><a href="#cb110-1502" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb110-1503"><a href="#cb110-1503" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1504"><a href="#cb110-1504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1505"><a href="#cb110-1505" aria-hidden="true" tabindex="-1"></a>::: {#fig-model-fit-comparison-4}</span>
<span id="cb110-1508"><a href="#cb110-1508" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1509"><a href="#cb110-1509" aria-hidden="true" tabindex="-1"></a>fit_engine_2 <span class="sc">|&gt;</span></span>
<span id="cb110-1510"><a href="#cb110-1510" aria-hidden="true" tabindex="-1"></a>  ggeffects<span class="sc">::</span><span class="fu">predict_response</span>(</span>
<span id="cb110-1511"><a href="#cb110-1511" aria-hidden="true" tabindex="-1"></a>    <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"bill_length_mm"</span>, <span class="st">"bill_depth_mm"</span>)</span>
<span id="cb110-1512"><a href="#cb110-1512" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb110-1513"><a href="#cb110-1513" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">show_data =</span> <span class="cn">TRUE</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb110-1514"><a href="#cb110-1514" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb110-1515"><a href="#cb110-1515" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>(),</span>
<span id="cb110-1516"><a href="#cb110-1516" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Bill length (mm)"</span>,</span>
<span id="cb110-1517"><a href="#cb110-1517" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Flipper length (mm)"</span>,</span>
<span id="cb110-1518"><a href="#cb110-1518" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Bill depth (mm)"</span></span>
<span id="cb110-1519"><a href="#cb110-1519" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb110-1520"><a href="#cb110-1520" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_gray</span>()</span>
<span id="cb110-1521"><a href="#cb110-1521" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1522"><a href="#cb110-1522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1523"><a href="#cb110-1523" aria-hidden="true" tabindex="-1"></a>Relationship between <span class="in">`flipper_length_mm`</span> and <span class="in">`bill_length_mm`</span>, with data points represented as dots. The three lines show model predictions for different values of the variable <span class="in">`bill_depth_mm`</span>, with the shaded areas representing confidence intervals.</span>
<span id="cb110-1524"><a href="#cb110-1524" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb110-1525"><a href="#cb110-1525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1526"><a href="#cb110-1526" aria-hidden="true" tabindex="-1"></a><span class="fu">### Posterior predictive checks</span></span>
<span id="cb110-1527"><a href="#cb110-1527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1528"><a href="#cb110-1528" aria-hidden="true" tabindex="-1"></a>Posterior predictive checks are a technique used in Bayesian statistics to assess the fit of a model by comparing observed data to data simulated from the <span class="co">[</span><span class="ot">posterior predictive distribution</span><span class="co">](https://en.wikipedia.org/wiki/Posterior_predictive_distribution)</span>. The model-predicted lines should resemble the observed data line.</span>
<span id="cb110-1529"><a href="#cb110-1529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1532"><a href="#cb110-1532" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1533"><a href="#cb110-1533" aria-hidden="true" tabindex="-1"></a>diag_sum_plots <span class="ot">&lt;-</span> </span>
<span id="cb110-1534"><a href="#cb110-1534" aria-hidden="true" tabindex="-1"></a>  fit_engine_2 <span class="sc">|&gt;</span> </span>
<span id="cb110-1535"><a href="#cb110-1535" aria-hidden="true" tabindex="-1"></a>  performance<span class="sc">::</span><span class="fu">check_model</span>(</span>
<span id="cb110-1536"><a href="#cb110-1536" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel =</span> <span class="cn">FALSE</span>,</span>
<span id="cb110-1537"><a href="#cb110-1537" aria-hidden="true" tabindex="-1"></a>    <span class="at">colors =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"black"</span>, <span class="st">"black"</span>)</span>
<span id="cb110-1538"><a href="#cb110-1538" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb110-1539"><a href="#cb110-1539" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>() <span class="sc">|&gt;</span></span>
<span id="cb110-1540"><a href="#cb110-1540" aria-hidden="true" tabindex="-1"></a>  rutils<span class="sc">:::</span><span class="fu">shush</span>()</span>
<span id="cb110-1541"><a href="#cb110-1541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1542"><a href="#cb110-1542" aria-hidden="true" tabindex="-1"></a>diag_sum_plots<span class="sc">$</span>PP_CHECK <span class="sc">+</span></span>
<span id="cb110-1543"><a href="#cb110-1543" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb110-1544"><a href="#cb110-1544" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>(),</span>
<span id="cb110-1545"><a href="#cb110-1545" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>(),</span>
<span id="cb110-1546"><a href="#cb110-1546" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Flipper length (mm)"</span>,</span>
<span id="cb110-1547"><a href="#cb110-1547" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb110-1548"><a href="#cb110-1548" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_gray</span>()</span>
<span id="cb110-1549"><a href="#cb110-1549" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1550"><a href="#cb110-1550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1551"><a href="#cb110-1551" aria-hidden="true" tabindex="-1"></a><span class="fu">## Performing model diagnostics</span></span>
<span id="cb110-1552"><a href="#cb110-1552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1553"><a href="#cb110-1553" aria-hidden="true" tabindex="-1"></a><span class="fu">### Normality</span></span>
<span id="cb110-1554"><a href="#cb110-1554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1555"><a href="#cb110-1555" aria-hidden="true" tabindex="-1"></a>**Assumption 2** is satisfied, as the residuals shown a normal distribution in 11 types of normality tests with different approaches (e.g., moments, regression/correlations; ECDFs).</span>
<span id="cb110-1556"><a href="#cb110-1556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1557"><a href="#cb110-1557" aria-hidden="true" tabindex="-1"></a><span class="fu">### Visual inspection</span></span>
<span id="cb110-1558"><a href="#cb110-1558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1559"><a href="#cb110-1559" aria-hidden="true" tabindex="-1"></a>::: {#fig-model-residual-diag-normality-1}</span>
<span id="cb110-1562"><a href="#cb110-1562" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1563"><a href="#cb110-1563" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span></span>
<span id="cb110-1564"><a href="#cb110-1564" aria-hidden="true" tabindex="-1"></a>  stats<span class="sc">::</span><span class="fu">residuals</span>() <span class="sc">|&gt;</span></span>
<span id="cb110-1565"><a href="#cb110-1565" aria-hidden="true" tabindex="-1"></a>  <span class="fu">test_normality</span>(<span class="at">name =</span> <span class="st">"Residuals"</span>)</span>
<span id="cb110-1566"><a href="#cb110-1566" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1567"><a href="#cb110-1567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1568"><a href="#cb110-1568" aria-hidden="true" tabindex="-1"></a>Histogram of the model residuals with a kernel density estimate, along with a quantile-quantile (Q-Q) plot between the residuals and the theoretical quantiles of the normal distribution.</span>
<span id="cb110-1569"><a href="#cb110-1569" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb110-1570"><a href="#cb110-1570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1571"><a href="#cb110-1571" aria-hidden="true" tabindex="-1"></a>::: {#fig-model-residual-diag-normality-2}</span>
<span id="cb110-1574"><a href="#cb110-1574" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1575"><a href="#cb110-1575" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">|&gt;</span> </span>
<span id="cb110-1576"><a href="#cb110-1576" aria-hidden="true" tabindex="-1"></a>  broom<span class="sc">::</span><span class="fu">augment</span>(data) <span class="sc">|&gt;</span></span>
<span id="cb110-1577"><a href="#cb110-1577" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(.resid) <span class="sc">|&gt;</span></span>
<span id="cb110-1578"><a href="#cb110-1578" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(.resid) <span class="sc">|&gt;</span></span>
<span id="cb110-1579"><a href="#cb110-1579" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> name, <span class="at">y =</span> value, <span class="at">fill =</span> name)) <span class="sc">+</span></span>
<span id="cb110-1580"><a href="#cb110-1580" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_boxplot</span>(</span>
<span id="cb110-1581"><a href="#cb110-1581" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.colour =</span> <span class="st">"red"</span>, </span>
<span id="cb110-1582"><a href="#cb110-1582" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.shape =</span> <span class="dv">1</span>,</span>
<span id="cb110-1583"><a href="#cb110-1583" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="fl">0.5</span></span>
<span id="cb110-1584"><a href="#cb110-1584" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb110-1585"><a href="#cb110-1585" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb110-1586"><a href="#cb110-1586" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_fill_manual</span>(</span>
<span id="cb110-1587"><a href="#cb110-1587" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="st">"Residuals"</span>,</span>
<span id="cb110-1588"><a href="#cb110-1588" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">gg_color_hue</span>(<span class="dv">1</span>)</span>
<span id="cb110-1589"><a href="#cb110-1589" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb110-1590"><a href="#cb110-1590" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Variable"</span>, <span class="at">y =</span> <span class="st">"Value"</span>, <span class="at">fill =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb110-1591"><a href="#cb110-1591" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb110-1592"><a href="#cb110-1592" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(</span>
<span id="cb110-1593"><a href="#cb110-1593" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>(),</span>
<span id="cb110-1594"><a href="#cb110-1594" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>(),</span>
<span id="cb110-1595"><a href="#cb110-1595" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.y =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>()</span>
<span id="cb110-1596"><a href="#cb110-1596" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb110-1597"><a href="#cb110-1597" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1598"><a href="#cb110-1598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1599"><a href="#cb110-1599" aria-hidden="true" tabindex="-1"></a>Boxplot of model residuals with outliers highlighted in red and other residuals indicated by jittered points.</span>
<span id="cb110-1600"><a href="#cb110-1600" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb110-1601"><a href="#cb110-1601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1602"><a href="#cb110-1602" aria-hidden="true" tabindex="-1"></a>::: {#tbl-model-residual-diag-normality-1}</span>
<span id="cb110-1605"><a href="#cb110-1605" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1606"><a href="#cb110-1606" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span></span>
<span id="cb110-1607"><a href="#cb110-1607" aria-hidden="true" tabindex="-1"></a>  stats<span class="sc">::</span><span class="fu">residuals</span>() <span class="sc">|&gt;</span></span>
<span id="cb110-1608"><a href="#cb110-1608" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stats_sum</span>(<span class="at">name =</span> <span class="st">"Residuals"</span>)</span>
<span id="cb110-1609"><a href="#cb110-1609" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1610"><a href="#cb110-1610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1611"><a href="#cb110-1611" aria-hidden="true" tabindex="-1"></a>Summary statistics of model residuals.</span>
<span id="cb110-1612"><a href="#cb110-1612" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb110-1613"><a href="#cb110-1613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1614"><a href="#cb110-1614" aria-hidden="true" tabindex="-1"></a><span class="fu">### Tests</span></span>
<span id="cb110-1615"><a href="#cb110-1615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1616"><a href="#cb110-1616" aria-hidden="true" tabindex="-1"></a>It's important to note that the Kolmogorov-Smirnov and Pearson chi-square tests are included here just for reference, as many authors don't recommend using them when testing for normality <span class="co">[</span><span class="ot">@dagostino1990</span><span class="co">]</span>. Learn more about normality tests in @thode2002.</span>
<span id="cb110-1617"><a href="#cb110-1617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1618"><a href="#cb110-1618" aria-hidden="true" tabindex="-1"></a>We also recommend checking the original papers for each test to understand their assumptions and limitations:</span>
<span id="cb110-1619"><a href="#cb110-1619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1620"><a href="#cb110-1620" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Anderson-Darling test</span><span class="co">](https://en.wikipedia.org/wiki/Anderson%E2%80%93Darling_test)</span>: @anderson1952; @anderson1954.</span>
<span id="cb110-1621"><a href="#cb110-1621" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Bonett-Seier test: @bonett2002.</span>
<span id="cb110-1622"><a href="#cb110-1622" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Cramér-von Mises test</span><span class="co">](https://en.wikipedia.org/wiki/Cram%C3%A9r%E2%80%93von_Mises_criterion)</span>: @cramer1928; @anderson1962.</span>
<span id="cb110-1623"><a href="#cb110-1623" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">D'Agostino test</span><span class="co">](https://en.wikipedia.org/wiki/D%27Agostino%27s_K-squared_test)</span>: @dagostino1971; @dagostino1973.</span>
<span id="cb110-1624"><a href="#cb110-1624" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Jarque–Bera test</span><span class="co">](https://en.wikipedia.org/wiki/Jarque%E2%80%93Bera_test)</span>: @jarque1980; @bera1981; @jarque1987.</span>
<span id="cb110-1625"><a href="#cb110-1625" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Lilliefors (K-S) test</span><span class="co">](https://en.wikipedia.org/wiki/Lilliefors_test)</span>:  @smirnov1948; @kolmogorov1933; @massey1951; @lilliefors1967; @dallal1986.</span>
<span id="cb110-1626"><a href="#cb110-1626" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Pearson chi-square test</span><span class="co">](https://en.wikipedia.org/wiki/Pearson%27s_chi-squared_test)</span>: @pearson1900.</span>
<span id="cb110-1627"><a href="#cb110-1627" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Shapiro-Francia test</span><span class="co">](https://en.wikipedia.org/wiki/Shapiro%E2%80%93Francia_test)</span>: @shapiro1972.</span>
<span id="cb110-1628"><a href="#cb110-1628" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Shapiro-Wilk test</span><span class="co">](https://en.wikipedia.org/wiki/Shapiro%E2%80%93Wilk_test)</span>: @shapiro1965.</span>
<span id="cb110-1629"><a href="#cb110-1629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1630"><a href="#cb110-1630" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb110-1631"><a href="#cb110-1631" aria-hidden="true" tabindex="-1"></a>\begin{cases}</span>
<span id="cb110-1632"><a href="#cb110-1632" aria-hidden="true" tabindex="-1"></a>\text{H}_{0}: \text{The data is normally distributed} <span class="sc">\\</span></span>
<span id="cb110-1633"><a href="#cb110-1633" aria-hidden="true" tabindex="-1"></a>\text{H}_{a}: \text{The data is not normally distributed}</span>
<span id="cb110-1634"><a href="#cb110-1634" aria-hidden="true" tabindex="-1"></a>\end{cases}</span>
<span id="cb110-1635"><a href="#cb110-1635" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb110-1636"><a href="#cb110-1636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1637"><a href="#cb110-1637" aria-hidden="true" tabindex="-1"></a>::: {#tbl-model-residual-diag-normality-2}</span>
<span id="cb110-1640"><a href="#cb110-1640" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1641"><a href="#cb110-1641" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span></span>
<span id="cb110-1642"><a href="#cb110-1642" aria-hidden="true" tabindex="-1"></a>  stats<span class="sc">::</span><span class="fu">residuals</span>() <span class="sc">|&gt;</span></span>
<span id="cb110-1643"><a href="#cb110-1643" aria-hidden="true" tabindex="-1"></a>  <span class="fu">normality_sum</span>()</span>
<span id="cb110-1644"><a href="#cb110-1644" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1645"><a href="#cb110-1645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1646"><a href="#cb110-1646" aria-hidden="true" tabindex="-1"></a>Summary of statistical tests conducted to assess the normality of the residuals.</span>
<span id="cb110-1647"><a href="#cb110-1647" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb110-1648"><a href="#cb110-1648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1649"><a href="#cb110-1649" aria-hidden="true" tabindex="-1"></a>Correlation between observed residuals and expected residuals under normality.</span>
<span id="cb110-1650"><a href="#cb110-1650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1653"><a href="#cb110-1653" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1654"><a href="#cb110-1654" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb110-1655"><a href="#cb110-1655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1656"><a href="#cb110-1656" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> olsrr<span class="sc">::</span><span class="fu">ols_test_correlation</span>()</span>
<span id="cb110-1657"><a href="#cb110-1657" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1658"><a href="#cb110-1658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1659"><a href="#cb110-1659" aria-hidden="true" tabindex="-1"></a><span class="fu">### Linearity</span></span>
<span id="cb110-1660"><a href="#cb110-1660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1661"><a href="#cb110-1661" aria-hidden="true" tabindex="-1"></a>**Assumption 3** is satisfied, as the relationship between the variables is fairly linear.</span>
<span id="cb110-1662"><a href="#cb110-1662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1663"><a href="#cb110-1663" aria-hidden="true" tabindex="-1"></a>::: {#fig-model-residual-diag-fitted-values-1}</span>
<span id="cb110-1666"><a href="#cb110-1666" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1667"><a href="#cb110-1667" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">|&gt;</span></span>
<span id="cb110-1668"><a href="#cb110-1668" aria-hidden="true" tabindex="-1"></a>  broom<span class="sc">::</span><span class="fu">augment</span>(data) <span class="sc">|&gt;</span></span>
<span id="cb110-1669"><a href="#cb110-1669" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(.pred, .resid)) <span class="sc">+</span></span>
<span id="cb110-1670"><a href="#cb110-1670" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb110-1671"><a href="#cb110-1671" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_hline</span>(</span>
<span id="cb110-1672"><a href="#cb110-1672" aria-hidden="true" tabindex="-1"></a>    <span class="at">yintercept =</span> <span class="dv">0</span>, </span>
<span id="cb110-1673"><a href="#cb110-1673" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb110-1674"><a href="#cb110-1674" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.5</span>,</span>
<span id="cb110-1675"><a href="#cb110-1675" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span> </span>
<span id="cb110-1676"><a href="#cb110-1676" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb110-1677"><a href="#cb110-1677" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_smooth</span>(<span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb110-1678"><a href="#cb110-1678" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Fitted values"</span>, <span class="at">y =</span> <span class="st">"Residuals"</span>)</span>
<span id="cb110-1679"><a href="#cb110-1679" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1680"><a href="#cb110-1680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1681"><a href="#cb110-1681" aria-hidden="true" tabindex="-1"></a>Residual plot showing the relationship between fitted values and residuals, with the dashed black line representing zero residuals, indicating an ideal model fit, and the red line indicating the smoothed conditional mean of residuals, with the shaded region representing the confidence interval of this estimate.</span>
<span id="cb110-1682"><a href="#cb110-1682" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb110-1683"><a href="#cb110-1683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1684"><a href="#cb110-1684" aria-hidden="true" tabindex="-1"></a>::: {#fig-model-residual-diag-linearity-1}</span>
<span id="cb110-1687"><a href="#cb110-1687" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1688"><a href="#cb110-1688" aria-hidden="true" tabindex="-1"></a>plots <span class="ot">&lt;-</span> fit_engine <span class="sc">|&gt;</span> olsrr<span class="sc">::</span><span class="fu">ols_plot_resid_fit_spread</span>(<span class="at">print_plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb110-1689"><a href="#cb110-1689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1690"><a href="#cb110-1690" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(plots)) {</span>
<span id="cb110-1691"><a href="#cb110-1691" aria-hidden="true" tabindex="-1"></a>  q <span class="ot">&lt;-</span> plots[[i]] <span class="sc">+</span> ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>())</span>
<span id="cb110-1692"><a href="#cb110-1692" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-1693"><a href="#cb110-1693" aria-hidden="true" tabindex="-1"></a>  q <span class="ot">&lt;-</span> q <span class="sc">|&gt;</span> ggplot2<span class="sc">::</span><span class="fu">ggplot_build</span>()</span>
<span id="cb110-1694"><a href="#cb110-1694" aria-hidden="true" tabindex="-1"></a>  q<span class="sc">$</span>data[[<span class="dv">1</span>]]<span class="sc">$</span>colour <span class="ot">&lt;-</span> <span class="st">"red"</span></span>
<span id="cb110-1695"><a href="#cb110-1695" aria-hidden="true" tabindex="-1"></a>  q<span class="sc">$</span>plot<span class="sc">$</span>layers[[<span class="dv">1</span>]]<span class="sc">$</span>constructor<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="st">"red"</span></span>
<span id="cb110-1696"><a href="#cb110-1696" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-1697"><a href="#cb110-1697" aria-hidden="true" tabindex="-1"></a>  plots[[i]] <span class="ot">&lt;-</span> q <span class="sc">|&gt;</span> ggplot2<span class="sc">::</span><span class="fu">ggplot_gtable</span>() <span class="sc">|&gt;</span> ggplotify<span class="sc">::</span><span class="fu">as.ggplot</span>()</span>
<span id="cb110-1698"><a href="#cb110-1698" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb110-1699"><a href="#cb110-1699" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-1700"><a href="#cb110-1700" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(plots<span class="sc">$</span>fm_plot, plots<span class="sc">$</span>rsd_plot, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb110-1701"><a href="#cb110-1701" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1702"><a href="#cb110-1702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1703"><a href="#cb110-1703" aria-hidden="true" tabindex="-1"></a>Residual fit spread plots to detect non-linearity, influential observations, and outliers. The side-by-side plots show the centered fit and residuals, illustrating the variation explained by the model and what remains in the residuals. Inappropriately specified models often exhibit greater spread in the residuals than in the centered fit. "Proportion Less" indicates the cumulative distribution function, representing the proportion of observations below a specific value, facilitating an assessment of model performance.</span>
<span id="cb110-1704"><a href="#cb110-1704" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb110-1705"><a href="#cb110-1705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1706"><a href="#cb110-1706" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Ramsey's RESET test</span><span class="co">](https://en.wikipedia.org/wiki/Ramsey_RESET_test)</span> indicates that the model may has no omitted variables. This test examines whether non-linear combinations of the fitted values can explain the response variable.</span>
<span id="cb110-1707"><a href="#cb110-1707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1708"><a href="#cb110-1708" aria-hidden="true" tabindex="-1"></a>Learn more about the Ramsey's RESET test in: @ramsey1969.</span>
<span id="cb110-1709"><a href="#cb110-1709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1710"><a href="#cb110-1710" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb110-1711"><a href="#cb110-1711" aria-hidden="true" tabindex="-1"></a>\begin{cases}</span>
<span id="cb110-1712"><a href="#cb110-1712" aria-hidden="true" tabindex="-1"></a>\text{H}_{0}: \text{The model has no omitted variables} <span class="sc">\\</span></span>
<span id="cb110-1713"><a href="#cb110-1713" aria-hidden="true" tabindex="-1"></a>\text{H}_{a}: \text{The model has omitted variables}</span>
<span id="cb110-1714"><a href="#cb110-1714" aria-hidden="true" tabindex="-1"></a>\end{cases}</span>
<span id="cb110-1715"><a href="#cb110-1715" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb110-1716"><a href="#cb110-1716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1719"><a href="#cb110-1719" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1720"><a href="#cb110-1720" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> lmtest<span class="sc">::</span><span class="fu">resettest</span>(<span class="at">power =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb110-1721"><a href="#cb110-1721" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1722"><a href="#cb110-1722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1725"><a href="#cb110-1725" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1726"><a href="#cb110-1726" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> lmtest<span class="sc">::</span><span class="fu">resettest</span>(<span class="at">type =</span> <span class="st">"regressor"</span>)</span>
<span id="cb110-1727"><a href="#cb110-1727" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1728"><a href="#cb110-1728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1729"><a href="#cb110-1729" aria-hidden="true" tabindex="-1"></a><span class="fu">### Homoscedasticity (common variance)</span></span>
<span id="cb110-1730"><a href="#cb110-1730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1731"><a href="#cb110-1731" aria-hidden="true" tabindex="-1"></a>**Assumption 4** is satisfied, as the residuals exhibit constant variance. While some heteroscedasticity is present, the Breusch-Pagan test (not studentized) indicate that it is not severe.</span>
<span id="cb110-1732"><a href="#cb110-1732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1733"><a href="#cb110-1733" aria-hidden="true" tabindex="-1"></a>When comparing the  standardized residuals ($\sqrt{|\text{Standardized Residuals}|}$) spread to the fitted values and each predictor, we can observe that the residuals are fairly constant across the range of values. This suggests that the residuals have a constant variance.</span>
<span id="cb110-1734"><a href="#cb110-1734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1735"><a href="#cb110-1735" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Visual inspection</span></span>
<span id="cb110-1736"><a href="#cb110-1736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1737"><a href="#cb110-1737" aria-hidden="true" tabindex="-1"></a>::: {#fig-model-diag-homoscedasticity-1}</span>
<span id="cb110-1740"><a href="#cb110-1740" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1741"><a href="#cb110-1741" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">|&gt;</span></span>
<span id="cb110-1742"><a href="#cb110-1742" aria-hidden="true" tabindex="-1"></a>  stats<span class="sc">::</span><span class="fu">predict</span>(data) <span class="sc">|&gt;</span></span>
<span id="cb110-1743"><a href="#cb110-1743" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb110-1744"><a href="#cb110-1744" aria-hidden="true" tabindex="-1"></a>    <span class="at">.sd_resid =</span> </span>
<span id="cb110-1745"><a href="#cb110-1745" aria-hidden="true" tabindex="-1"></a>      fit_engine <span class="sc">|&gt;</span></span>
<span id="cb110-1746"><a href="#cb110-1746" aria-hidden="true" tabindex="-1"></a>      stats<span class="sc">::</span><span class="fu">rstandard</span>() <span class="sc">|&gt;</span> </span>
<span id="cb110-1747"><a href="#cb110-1747" aria-hidden="true" tabindex="-1"></a>      <span class="fu">abs</span>() <span class="sc">|&gt;</span></span>
<span id="cb110-1748"><a href="#cb110-1748" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sqrt</span>()</span>
<span id="cb110-1749"><a href="#cb110-1749" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb110-1750"><a href="#cb110-1750" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(.pred, .sd_resid)) <span class="sc">+</span></span>
<span id="cb110-1751"><a href="#cb110-1751" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb110-1752"><a href="#cb110-1752" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_smooth</span>(<span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb110-1753"><a href="#cb110-1753" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb110-1754"><a href="#cb110-1754" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Fitted values"</span>, </span>
<span id="cb110-1755"><a href="#cb110-1755" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">sqrt{|Standardized </span><span class="sc">\\</span><span class="st"> Residuals|}$"</span>)</span>
<span id="cb110-1756"><a href="#cb110-1756" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb110-1757"><a href="#cb110-1757" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1758"><a href="#cb110-1758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1759"><a href="#cb110-1759" aria-hidden="true" tabindex="-1"></a>Relation between the fitted values of the model and its standardized residuals.</span>
<span id="cb110-1760"><a href="#cb110-1760" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb110-1761"><a href="#cb110-1761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1762"><a href="#cb110-1762" aria-hidden="true" tabindex="-1"></a>::: {#fig-model-diag-homoscedasticity-2}</span>
<span id="cb110-1765"><a href="#cb110-1765" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1766"><a href="#cb110-1766" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">|&gt;</span></span>
<span id="cb110-1767"><a href="#cb110-1767" aria-hidden="true" tabindex="-1"></a>  stats<span class="sc">::</span><span class="fu">predict</span>(data) <span class="sc">|&gt;</span></span>
<span id="cb110-1768"><a href="#cb110-1768" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb110-1769"><a href="#cb110-1769" aria-hidden="true" tabindex="-1"></a>    <span class="at">.sd_resid =</span> </span>
<span id="cb110-1770"><a href="#cb110-1770" aria-hidden="true" tabindex="-1"></a>      fit_engine <span class="sc">|&gt;</span></span>
<span id="cb110-1771"><a href="#cb110-1771" aria-hidden="true" tabindex="-1"></a>      stats<span class="sc">::</span><span class="fu">rstandard</span>() <span class="sc">|&gt;</span> </span>
<span id="cb110-1772"><a href="#cb110-1772" aria-hidden="true" tabindex="-1"></a>      <span class="fu">abs</span>() <span class="sc">|&gt;</span></span>
<span id="cb110-1773"><a href="#cb110-1773" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sqrt</span>()</span>
<span id="cb110-1774"><a href="#cb110-1774" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb110-1775"><a href="#cb110-1775" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(data) <span class="sc">|&gt;</span></span>
<span id="cb110-1776"><a href="#cb110-1776" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(bill_length_mm, .sd_resid)) <span class="sc">+</span></span>
<span id="cb110-1777"><a href="#cb110-1777" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb110-1778"><a href="#cb110-1778" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_smooth</span>(<span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb110-1779"><a href="#cb110-1779" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb110-1780"><a href="#cb110-1780" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Bill length (mm)"</span>, </span>
<span id="cb110-1781"><a href="#cb110-1781" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">sqrt{|Standardized </span><span class="sc">\\</span><span class="st"> Residuals|}$"</span>)</span>
<span id="cb110-1782"><a href="#cb110-1782" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb110-1783"><a href="#cb110-1783" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1784"><a href="#cb110-1784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1785"><a href="#cb110-1785" aria-hidden="true" tabindex="-1"></a>Relation between <span class="in">`bill_length_mm`</span> and the model standardized residuals.</span>
<span id="cb110-1786"><a href="#cb110-1786" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb110-1787"><a href="#cb110-1787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1788"><a href="#cb110-1788" aria-hidden="true" tabindex="-1"></a>::: {#fig-model-diag-homoscedasticity-3}</span>
<span id="cb110-1791"><a href="#cb110-1791" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1792"><a href="#cb110-1792" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">|&gt;</span></span>
<span id="cb110-1793"><a href="#cb110-1793" aria-hidden="true" tabindex="-1"></a>  stats<span class="sc">::</span><span class="fu">predict</span>(data) <span class="sc">|&gt;</span></span>
<span id="cb110-1794"><a href="#cb110-1794" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb110-1795"><a href="#cb110-1795" aria-hidden="true" tabindex="-1"></a>    <span class="at">.sd_resid =</span> </span>
<span id="cb110-1796"><a href="#cb110-1796" aria-hidden="true" tabindex="-1"></a>      fit_engine <span class="sc">|&gt;</span></span>
<span id="cb110-1797"><a href="#cb110-1797" aria-hidden="true" tabindex="-1"></a>      stats<span class="sc">::</span><span class="fu">rstandard</span>() <span class="sc">|&gt;</span> </span>
<span id="cb110-1798"><a href="#cb110-1798" aria-hidden="true" tabindex="-1"></a>      <span class="fu">abs</span>() <span class="sc">|&gt;</span></span>
<span id="cb110-1799"><a href="#cb110-1799" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sqrt</span>()</span>
<span id="cb110-1800"><a href="#cb110-1800" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb110-1801"><a href="#cb110-1801" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(data) <span class="sc">|&gt;</span></span>
<span id="cb110-1802"><a href="#cb110-1802" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(bill_depth_mm, .sd_resid)) <span class="sc">+</span></span>
<span id="cb110-1803"><a href="#cb110-1803" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb110-1804"><a href="#cb110-1804" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_smooth</span>(<span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb110-1805"><a href="#cb110-1805" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb110-1806"><a href="#cb110-1806" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Bill depth (mm)"</span>, </span>
<span id="cb110-1807"><a href="#cb110-1807" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">sqrt{|Standardized </span><span class="sc">\\</span><span class="st"> Residuals|}$"</span>)</span>
<span id="cb110-1808"><a href="#cb110-1808" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb110-1809"><a href="#cb110-1809" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1810"><a href="#cb110-1810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1811"><a href="#cb110-1811" aria-hidden="true" tabindex="-1"></a>Relation between <span class="in">`bill_depth_mm`</span> and the model standardized residuals.</span>
<span id="cb110-1812"><a href="#cb110-1812" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb110-1813"><a href="#cb110-1813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1814"><a href="#cb110-1814" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Breusch-Pagan test</span></span>
<span id="cb110-1815"><a href="#cb110-1815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1816"><a href="#cb110-1816" aria-hidden="true" tabindex="-1"></a>The <span class="co">[</span><span class="ot">Breusch-Pagan test</span><span class="co">](https://en.wikipedia.org/wiki/Breusch%E2%80%93Pagan_test)</span> test indicates that the residuals exhibit constant variance.</span>
<span id="cb110-1817"><a href="#cb110-1817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1818"><a href="#cb110-1818" aria-hidden="true" tabindex="-1"></a>As we can see below, the result of the test is not significant, suggesting that the residuals have a constant variance.</span>
<span id="cb110-1819"><a href="#cb110-1819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1820"><a href="#cb110-1820" aria-hidden="true" tabindex="-1"></a>Learn more about the Breusch-Pagan test in: @breusch1979 and @koenker1981.</span>
<span id="cb110-1821"><a href="#cb110-1821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1822"><a href="#cb110-1822" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb110-1823"><a href="#cb110-1823" aria-hidden="true" tabindex="-1"></a>\begin{cases}</span>
<span id="cb110-1824"><a href="#cb110-1824" aria-hidden="true" tabindex="-1"></a>\text{H}_{0}: \text{The variance is constant} <span class="sc">\\</span></span>
<span id="cb110-1825"><a href="#cb110-1825" aria-hidden="true" tabindex="-1"></a>\text{H}_{a}: \text{The variance is not constant}</span>
<span id="cb110-1826"><a href="#cb110-1826" aria-hidden="true" tabindex="-1"></a>\end{cases}</span>
<span id="cb110-1827"><a href="#cb110-1827" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb110-1828"><a href="#cb110-1828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1831"><a href="#cb110-1831" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1832"><a href="#cb110-1832" aria-hidden="true" tabindex="-1"></a>fit_engine_2 <span class="sc">|&gt;</span> performance<span class="sc">::</span><span class="fu">check_heteroscedasticity</span>()</span>
<span id="cb110-1833"><a href="#cb110-1833" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1834"><a href="#cb110-1834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1837"><a href="#cb110-1837" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1838"><a href="#cb110-1838" aria-hidden="true" tabindex="-1"></a><span class="co"># With studentising modification of Koenker</span></span>
<span id="cb110-1839"><a href="#cb110-1839" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> lmtest<span class="sc">::</span><span class="fu">bptest</span>(<span class="at">studentize =</span> <span class="cn">TRUE</span>)</span>
<span id="cb110-1840"><a href="#cb110-1840" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1841"><a href="#cb110-1841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1844"><a href="#cb110-1844" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1845"><a href="#cb110-1845" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> lmtest<span class="sc">::</span><span class="fu">bptest</span>(<span class="at">studentize =</span> <span class="cn">FALSE</span>)</span>
<span id="cb110-1846"><a href="#cb110-1846" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1847"><a href="#cb110-1847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1850"><a href="#cb110-1850" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1851"><a href="#cb110-1851" aria-hidden="true" tabindex="-1"></a><span class="co"># With studentising modification of Koenker</span></span>
<span id="cb110-1852"><a href="#cb110-1852" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> skedastic<span class="sc">::</span><span class="fu">breusch_pagan</span>(<span class="at">koenker =</span> <span class="cn">TRUE</span>)</span>
<span id="cb110-1853"><a href="#cb110-1853" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1854"><a href="#cb110-1854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1857"><a href="#cb110-1857" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1858"><a href="#cb110-1858" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> skedastic<span class="sc">::</span><span class="fu">breusch_pagan</span>(<span class="at">koenker =</span> <span class="cn">FALSE</span>)</span>
<span id="cb110-1859"><a href="#cb110-1859" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1860"><a href="#cb110-1860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1863"><a href="#cb110-1863" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1864"><a href="#cb110-1864" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(form, <span class="at">data =</span> data) <span class="sc">|&gt;</span> car<span class="sc">::</span><span class="fu">ncvTest</span>()</span>
<span id="cb110-1865"><a href="#cb110-1865" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1866"><a href="#cb110-1866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1869"><a href="#cb110-1869" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1870"><a href="#cb110-1870" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> olsrr<span class="sc">::</span><span class="fu">ols_test_breusch_pagan</span>()</span>
<span id="cb110-1871"><a href="#cb110-1871" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1872"><a href="#cb110-1872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1873"><a href="#cb110-1873" aria-hidden="true" tabindex="-1"></a><span class="fu">#### White's test</span></span>
<span id="cb110-1874"><a href="#cb110-1874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1875"><a href="#cb110-1875" aria-hidden="true" tabindex="-1"></a>The <span class="co">[</span><span class="ot">White's test</span><span class="co">](https://en.wikipedia.org/wiki/White_test)</span> is a general test for heteroskedasticity. It is a generalization of the Breusch-Pagan test and is more flexible in terms of the types of heteroskedasticity it can detect. It has the same null hypothesis as the Breusch-Pagan test.</span>
<span id="cb110-1876"><a href="#cb110-1876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1877"><a href="#cb110-1877" aria-hidden="true" tabindex="-1"></a>Like the Breusch-Pagan, the results of the White's test indicate that the residuals exhibit constant variance.</span>
<span id="cb110-1878"><a href="#cb110-1878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1879"><a href="#cb110-1879" aria-hidden="true" tabindex="-1"></a>Learn more about the White's test in: @white1980.</span>
<span id="cb110-1880"><a href="#cb110-1880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1883"><a href="#cb110-1883" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1884"><a href="#cb110-1884" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> skedastic<span class="sc">::</span><span class="fu">white</span>()</span>
<span id="cb110-1885"><a href="#cb110-1885" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1886"><a href="#cb110-1886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1887"><a href="#cb110-1887" aria-hidden="true" tabindex="-1"></a><span class="fu">### Independence</span></span>
<span id="cb110-1888"><a href="#cb110-1888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1889"><a href="#cb110-1889" aria-hidden="true" tabindex="-1"></a>**Assumption 5** is satisfied. Although the residuals show some autocorrelation, they fall within the acceptable range of the Durbin–Watson statistic (1.5 to 2.5). It's also important to note that the observations for each predicted value are not related to any other prediction; in other words, they are not grouped or sequenced by any variable (by design) (see <span class="co">[</span><span class="ot">@hair2019, p. 291</span><span class="co">]</span> for more information).</span>
<span id="cb110-1890"><a href="#cb110-1890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1891"><a href="#cb110-1891" aria-hidden="true" tabindex="-1"></a>Many authors don't consider autocorrelation tests for linear regression models, as they are more relevant for time series data. However, we include them here for reference.</span>
<span id="cb110-1892"><a href="#cb110-1892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1893"><a href="#cb110-1893" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Visual inspection</span></span>
<span id="cb110-1894"><a href="#cb110-1894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1897"><a href="#cb110-1897" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1898"><a href="#cb110-1898" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> </span>
<span id="cb110-1899"><a href="#cb110-1899" aria-hidden="true" tabindex="-1"></a>  <span class="fu">residuals</span>() <span class="sc">|&gt;</span></span>
<span id="cb110-1900"><a href="#cb110-1900" aria-hidden="true" tabindex="-1"></a>  forecast<span class="sc">::</span><span class="fu">ggtsdisplay</span>(<span class="at">lag.max=</span><span class="dv">30</span>)</span>
<span id="cb110-1901"><a href="#cb110-1901" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1902"><a href="#cb110-1902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1903"><a href="#cb110-1903" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Newey-West estimator</span></span>
<span id="cb110-1904"><a href="#cb110-1904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1905"><a href="#cb110-1905" aria-hidden="true" tabindex="-1"></a>The <span class="co">[</span><span class="ot">Newey-West estimator</span><span class="co">](https://en.wikipedia.org/wiki/Newey%E2%80%93West_estimator)</span> is a method used to estimate the <span class="co">[</span><span class="ot">covariance matrix</span><span class="co">](https://en.wikipedia.org/wiki/Covariance_matrix)</span> of the coefficients in a regression model when the residuals are autocorrelated.</span>
<span id="cb110-1906"><a href="#cb110-1906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1907"><a href="#cb110-1907" aria-hidden="true" tabindex="-1"></a>Learn more about the Newey-West estimator in: @newey1987 and @newey1994.</span>
<span id="cb110-1908"><a href="#cb110-1908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1911"><a href="#cb110-1911" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1912"><a href="#cb110-1912" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> sandwich<span class="sc">::</span><span class="fu">NeweyWest</span>()</span>
<span id="cb110-1913"><a href="#cb110-1913" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1914"><a href="#cb110-1914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1915"><a href="#cb110-1915" aria-hidden="true" tabindex="-1"></a>The Heteroscedasticity and autocorrelation consistent (HAC) estimation of the covariance matrix of the coefficient estimates can also be computed in other ways. The HAC estimator below is a implementation made by @zeileis2004.</span>
<span id="cb110-1916"><a href="#cb110-1916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1919"><a href="#cb110-1919" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1920"><a href="#cb110-1920" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> sandwich<span class="sc">::</span><span class="fu">vcovHAC</span>()</span>
<span id="cb110-1921"><a href="#cb110-1921" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1922"><a href="#cb110-1922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1923"><a href="#cb110-1923" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Durbin-Watson test</span></span>
<span id="cb110-1924"><a href="#cb110-1924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1925"><a href="#cb110-1925" aria-hidden="true" tabindex="-1"></a>The <span class="co">[</span><span class="ot">Durbin-Watson test</span><span class="co">](https://en.wikipedia.org/wiki/Durbin%E2%80%93Watson_statistic)</span> is a statistical test used to detect the presence of autocorrelation at lag 1 in the residuals from a regression analysis. The test statistic ranges from 0 to 4, with a value of 2 indicating no autocorrelation. Values less than 2 indicate positive autocorrelation, while values greater than 2 indicate negative autocorrelation <span class="co">[</span><span class="ot">@fox2016</span><span class="co">]</span>.</span>
<span id="cb110-1926"><a href="#cb110-1926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1927"><a href="#cb110-1927" aria-hidden="true" tabindex="-1"></a>A common rule of thumb in the statistical community is that a Durbin-Watson statistic between 1.5 and 2.5 suggests little to no autocorrelation.</span>
<span id="cb110-1928"><a href="#cb110-1928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1929"><a href="#cb110-1929" aria-hidden="true" tabindex="-1"></a>Learn more about the Durbin-Watson test in: @durbin1950; @durbin1951; and @durbin1971.</span>
<span id="cb110-1930"><a href="#cb110-1930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1931"><a href="#cb110-1931" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb110-1932"><a href="#cb110-1932" aria-hidden="true" tabindex="-1"></a>\begin{cases}</span>
<span id="cb110-1933"><a href="#cb110-1933" aria-hidden="true" tabindex="-1"></a>\text{H}_{0}: \text{Autocorrelation of the disturbances is 0} <span class="sc">\\</span></span>
<span id="cb110-1934"><a href="#cb110-1934" aria-hidden="true" tabindex="-1"></a>\text{H}_{a}: \text{Autocorrelation of the disturbances is not equal to 0}</span>
<span id="cb110-1935"><a href="#cb110-1935" aria-hidden="true" tabindex="-1"></a>\end{cases}</span>
<span id="cb110-1936"><a href="#cb110-1936" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb110-1937"><a href="#cb110-1937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1940"><a href="#cb110-1940" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1941"><a href="#cb110-1941" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> olsrr<span class="sc">::</span><span class="fu">ols_correlations</span>()</span>
<span id="cb110-1942"><a href="#cb110-1942" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1943"><a href="#cb110-1943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1946"><a href="#cb110-1946" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1947"><a href="#cb110-1947" aria-hidden="true" tabindex="-1"></a>lmtest<span class="sc">::</span><span class="fu">dwtest</span>(fit_engine)</span>
<span id="cb110-1948"><a href="#cb110-1948" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1949"><a href="#cb110-1949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1952"><a href="#cb110-1952" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1953"><a href="#cb110-1953" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">durbinWatsonTest</span>(fit_engine)</span>
<span id="cb110-1954"><a href="#cb110-1954" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1955"><a href="#cb110-1955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1956"><a href="#cb110-1956" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Ljung-Box test</span></span>
<span id="cb110-1957"><a href="#cb110-1957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1958"><a href="#cb110-1958" aria-hidden="true" tabindex="-1"></a>Learn more about the <span class="co">[</span><span class="ot">Ljung-Box test</span><span class="co">](https://en.wikipedia.org/wiki/Ljung%E2%80%93Box_test)</span> in: @box1970 and @ljung1978.</span>
<span id="cb110-1959"><a href="#cb110-1959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1960"><a href="#cb110-1960" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb110-1961"><a href="#cb110-1961" aria-hidden="true" tabindex="-1"></a>\begin{cases}</span>
<span id="cb110-1962"><a href="#cb110-1962" aria-hidden="true" tabindex="-1"></a>\text{H}_{0}: \text{Residuals are independently distributed} <span class="sc">\\</span></span>
<span id="cb110-1963"><a href="#cb110-1963" aria-hidden="true" tabindex="-1"></a>\text{H}_{a}: \text{Residuals are not independently distributed}</span>
<span id="cb110-1964"><a href="#cb110-1964" aria-hidden="true" tabindex="-1"></a>\end{cases}</span>
<span id="cb110-1965"><a href="#cb110-1965" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb110-1966"><a href="#cb110-1966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1969"><a href="#cb110-1969" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1970"><a href="#cb110-1970" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span></span>
<span id="cb110-1971"><a href="#cb110-1971" aria-hidden="true" tabindex="-1"></a>  stats<span class="sc">::</span><span class="fu">residuals</span>() <span class="sc">|&gt;</span></span>
<span id="cb110-1972"><a href="#cb110-1972" aria-hidden="true" tabindex="-1"></a>  stats<span class="sc">::</span><span class="fu">Box.test</span>(<span class="at">type =</span> <span class="st">"Ljung-Box"</span>, <span class="at">lag =</span> <span class="dv">10</span>)</span>
<span id="cb110-1973"><a href="#cb110-1973" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-1974"><a href="#cb110-1974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1975"><a href="#cb110-1975" aria-hidden="true" tabindex="-1"></a><span class="fu">### Colinearity/Multicollinearity</span></span>
<span id="cb110-1976"><a href="#cb110-1976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1977"><a href="#cb110-1977" aria-hidden="true" tabindex="-1"></a>No high degree of colinearity was observed among the independent variables.</span>
<span id="cb110-1978"><a href="#cb110-1978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1979"><a href="#cb110-1979" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Variance Inflation Factor (VIF)</span></span>
<span id="cb110-1980"><a href="#cb110-1980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1981"><a href="#cb110-1981" aria-hidden="true" tabindex="-1"></a>The <span class="co">[</span><span class="ot">Variance Inflation Factor (VIF)</span><span class="co">](https://en.wikipedia.org/wiki/Variance_inflation_factor)</span> indicates the effect of other independent variables on the standard error of a regression coefficient. The VIF is directly related to the tolerance value ($\text{VIF}_{i} = 1/\text{TO}L$). High VIF values (larger than ~5 <span class="co">[</span><span class="ot">@@struck2024</span><span class="co">]</span>) suggest significant collinearity or multicollinearity among the independent variables <span class="co">[</span><span class="ot">@hair2019, p. 265</span><span class="co">]</span>.</span>
<span id="cb110-1982"><a href="#cb110-1982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1983"><a href="#cb110-1983" aria-hidden="true" tabindex="-1"></a>::: {#fig-model-diag-colinearity-1}</span>
<span id="cb110-1986"><a href="#cb110-1986" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-1987"><a href="#cb110-1987" aria-hidden="true" tabindex="-1"></a>diag_sum_plots <span class="ot">&lt;-</span> </span>
<span id="cb110-1988"><a href="#cb110-1988" aria-hidden="true" tabindex="-1"></a>  fit_engine_2 <span class="sc">|&gt;</span> </span>
<span id="cb110-1989"><a href="#cb110-1989" aria-hidden="true" tabindex="-1"></a>  performance<span class="sc">::</span><span class="fu">check_model</span>(<span class="at">panel =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb110-1990"><a href="#cb110-1990" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>() <span class="sc">|&gt;</span></span>
<span id="cb110-1991"><a href="#cb110-1991" aria-hidden="true" tabindex="-1"></a>  rutils<span class="sc">:::</span><span class="fu">shush</span>()</span>
<span id="cb110-1992"><a href="#cb110-1992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-1993"><a href="#cb110-1993" aria-hidden="true" tabindex="-1"></a>diag_sum_plots<span class="sc">$</span>VIF <span class="sc">+</span> </span>
<span id="cb110-1994"><a href="#cb110-1994" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb110-1995"><a href="#cb110-1995" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>(),</span>
<span id="cb110-1996"><a href="#cb110-1996" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>()</span>
<span id="cb110-1997"><a href="#cb110-1997" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb110-1998"><a href="#cb110-1998" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(</span>
<span id="cb110-1999"><a href="#cb110-1999" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb110-2000"><a href="#cb110-2000" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">colour =</span> <span class="st">"black"</span>),</span>
<span id="cb110-2001"><a href="#cb110-2001" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">"gray25"</span>),</span>
<span id="cb110-2002"><a href="#cb110-2002" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb110-2003"><a href="#cb110-2003" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">"black"</span>)</span>
<span id="cb110-2004"><a href="#cb110-2004" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb110-2005"><a href="#cb110-2005" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-2006"><a href="#cb110-2006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2007"><a href="#cb110-2007" aria-hidden="true" tabindex="-1"></a>Variance Inflation Factors (VIF) for each predictor variable. VIFs below 5 are considered acceptable. Between 5 and 10, the variable should be examined. Above 10, the variable must considered highly collinear.</span>
<span id="cb110-2008"><a href="#cb110-2008" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb110-2009"><a href="#cb110-2009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2010"><a href="#cb110-2010" aria-hidden="true" tabindex="-1"></a>::: {#tbl-model-residual-diag-colinearity-1}</span>
<span id="cb110-2013"><a href="#cb110-2013" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-2014"><a href="#cb110-2014" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> olsrr<span class="sc">::</span><span class="fu">ols_vif_tol</span>()</span>
<span id="cb110-2015"><a href="#cb110-2015" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-2016"><a href="#cb110-2016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2017"><a href="#cb110-2017" aria-hidden="true" tabindex="-1"></a>Variance Inflation Factors (VIF) and Tolerance values for each predictor variable.</span>
<span id="cb110-2018"><a href="#cb110-2018" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb110-2019"><a href="#cb110-2019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2022"><a href="#cb110-2022" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-2023"><a href="#cb110-2023" aria-hidden="true" tabindex="-1"></a>fit_engine_2 <span class="sc">|&gt;</span> performance<span class="sc">::</span><span class="fu">check_collinearity</span>()</span>
<span id="cb110-2024"><a href="#cb110-2024" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-2025"><a href="#cb110-2025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2026"><a href="#cb110-2026" aria-hidden="true" tabindex="-1"></a><span class="fu">### Condition Index</span></span>
<span id="cb110-2027"><a href="#cb110-2027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2028"><a href="#cb110-2028" aria-hidden="true" tabindex="-1"></a>The <span class="co">[</span><span class="ot">condition index</span><span class="co">](https://en.wikipedia.org/wiki/Condition_number)</span> is a measure of multicollinearity in a regression model. It is based on the <span class="co">[</span><span class="ot">eigenvalues</span><span class="co">](https://en.wikipedia.org/wiki/Eigenvalues_and_eigenvectors)</span> of the correlation matrix of the predictors. A condition index of 30 or higher is generally considered indicative of significant collinearity <span class="co">[</span><span class="ot">@belsley2004, p. 112-114</span><span class="co">]</span>.</span>
<span id="cb110-2029"><a href="#cb110-2029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2030"><a href="#cb110-2030" aria-hidden="true" tabindex="-1"></a>::: {#tbl-model-residual-diag-colinearity-2}</span>
<span id="cb110-2033"><a href="#cb110-2033" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-2034"><a href="#cb110-2034" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> olsrr<span class="sc">::</span><span class="fu">ols_eigen_cindex</span>()</span>
<span id="cb110-2035"><a href="#cb110-2035" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-2036"><a href="#cb110-2036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2037"><a href="#cb110-2037" aria-hidden="true" tabindex="-1"></a>Condition indexes and eigenvalues for each predictor variable.</span>
<span id="cb110-2038"><a href="#cb110-2038" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb110-2039"><a href="#cb110-2039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2040"><a href="#cb110-2040" aria-hidden="true" tabindex="-1"></a><span class="fu">### Measures of influence</span></span>
<span id="cb110-2041"><a href="#cb110-2041" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2042"><a href="#cb110-2042" aria-hidden="true" tabindex="-1"></a>In this section, we will check several measures of influence that can be used to assess the impact of individual observations on the model estimates.</span>
<span id="cb110-2043"><a href="#cb110-2043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2044"><a href="#cb110-2044" aria-hidden="true" tabindex="-1"></a>Leverage points</span>
<span id="cb110-2045"><a href="#cb110-2045" aria-hidden="true" tabindex="-1"></a>: **Leverage** is a measure of the distance between individual values of a predictor and other values of the predictor. In other words, a point with high leverage has an x-value far away from the other x-values. Points with high leverage have the potential to influence our model estimates <span class="co">[</span><span class="ot">@struck2024; @hair2019, p. 262</span><span class="co">]</span>.</span>
<span id="cb110-2046"><a href="#cb110-2046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2047"><a href="#cb110-2047" aria-hidden="true" tabindex="-1"></a>Influence points</span>
<span id="cb110-2048"><a href="#cb110-2048" aria-hidden="true" tabindex="-1"></a>: **Influence** is a measure of how much an observation affects the model estimates. If an observation with large influence were removed from the dataset, we would expect a large change in the predictive equation <span class="co">[</span><span class="ot">@struck2024</span><span class="co">]</span>.</span>
<span id="cb110-2049"><a href="#cb110-2049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2052"><a href="#cb110-2052" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-2053"><a href="#cb110-2053" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> stats<span class="sc">::</span><span class="fu">hatvalues</span>() <span class="sc">|&gt;</span> <span class="fu">head</span>()</span>
<span id="cb110-2054"><a href="#cb110-2054" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-2055"><a href="#cb110-2055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2056"><a href="#cb110-2056" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Cook's distance</span></span>
<span id="cb110-2057"><a href="#cb110-2057" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2058"><a href="#cb110-2058" aria-hidden="true" tabindex="-1"></a>The <span class="co">[</span><span class="ot">Cook's D</span><span class="co">](https://en.wikipedia.org/wiki/Cook%27s_distance)</span> measures each observation's influence on the model's fitted values. It is considered one of the most representative metrics for assessing overall influence <span class="co">[</span><span class="ot">@hair2019</span><span class="co">]</span>.</span>
<span id="cb110-2059"><a href="#cb110-2059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2060"><a href="#cb110-2060" aria-hidden="true" tabindex="-1"></a>A common practice is to flag observations with a Cook's distance of 1.0 or greater. However, a more conservative threshold of $4 / (n - k - 1)$, where $n$ is the sample size and $k$ is the number of independent variables, is suggested as a more conservative measure in small samples or for use with larger datasets <span class="co">[</span><span class="ot">@hair2019</span><span class="co">]</span>.</span>
<span id="cb110-2061"><a href="#cb110-2061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2062"><a href="#cb110-2062" aria-hidden="true" tabindex="-1"></a>Learn more about Cook's D in: @cook1977; @cook1979.</span>
<span id="cb110-2063"><a href="#cb110-2063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2066"><a href="#cb110-2066" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-2067"><a href="#cb110-2067" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> stats<span class="sc">::</span><span class="fu">cooks.distance</span>() <span class="sc">|&gt;</span> <span class="fu">head</span>()</span>
<span id="cb110-2068"><a href="#cb110-2068" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-2069"><a href="#cb110-2069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2072"><a href="#cb110-2072" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-2073"><a href="#cb110-2073" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> fit_engine <span class="sc">|&gt;</span> olsrr<span class="sc">::</span><span class="fu">ols_plot_cooksd_bar</span>(<span class="at">print_plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb110-2074"><a href="#cb110-2074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2075"><a href="#cb110-2075" aria-hidden="true" tabindex="-1"></a>q <span class="ot">&lt;-</span> plot<span class="sc">$</span>plot <span class="sc">+</span> ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>())</span>
<span id="cb110-2076"><a href="#cb110-2076" aria-hidden="true" tabindex="-1"></a>q <span class="ot">&lt;-</span> q <span class="sc">|&gt;</span> ggplot2<span class="sc">::</span><span class="fu">ggplot_build</span>()</span>
<span id="cb110-2077"><a href="#cb110-2077" aria-hidden="true" tabindex="-1"></a>q<span class="sc">$</span>data[[<span class="dv">5</span>]]<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="st">""</span></span>
<span id="cb110-2078"><a href="#cb110-2078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2079"><a href="#cb110-2079" aria-hidden="true" tabindex="-1"></a>q <span class="sc">|&gt;</span> ggplot2<span class="sc">::</span><span class="fu">ggplot_gtable</span>() <span class="sc">|&gt;</span> ggplotify<span class="sc">::</span><span class="fu">as.ggplot</span>()</span>
<span id="cb110-2080"><a href="#cb110-2080" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-2081"><a href="#cb110-2081" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2082"><a href="#cb110-2082" aria-hidden="true" tabindex="-1"></a>::: {#fig-model-diag-influence-1}</span>
<span id="cb110-2085"><a href="#cb110-2085" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-2086"><a href="#cb110-2086" aria-hidden="true" tabindex="-1"></a>diag_sum_plots <span class="ot">&lt;-</span> </span>
<span id="cb110-2087"><a href="#cb110-2087" aria-hidden="true" tabindex="-1"></a>  fit_engine_2 <span class="sc">|&gt;</span> </span>
<span id="cb110-2088"><a href="#cb110-2088" aria-hidden="true" tabindex="-1"></a>  performance<span class="sc">::</span><span class="fu">check_model</span>(</span>
<span id="cb110-2089"><a href="#cb110-2089" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel =</span> <span class="cn">FALSE</span>,</span>
<span id="cb110-2090"><a href="#cb110-2090" aria-hidden="true" tabindex="-1"></a>    <span class="at">colors =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"black"</span>, <span class="st">"black"</span>)</span>
<span id="cb110-2091"><a href="#cb110-2091" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb110-2092"><a href="#cb110-2092" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>() <span class="sc">|&gt;</span></span>
<span id="cb110-2093"><a href="#cb110-2093" aria-hidden="true" tabindex="-1"></a>  rutils<span class="sc">:::</span><span class="fu">shush</span>()</span>
<span id="cb110-2094"><a href="#cb110-2094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2095"><a href="#cb110-2095" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> </span>
<span id="cb110-2096"><a href="#cb110-2096" aria-hidden="true" tabindex="-1"></a>  diag_sum_plots<span class="sc">$</span>OUTLIERS <span class="sc">+</span></span>
<span id="cb110-2097"><a href="#cb110-2097" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb110-2098"><a href="#cb110-2098" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>(),</span>
<span id="cb110-2099"><a href="#cb110-2099" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>()</span>
<span id="cb110-2100"><a href="#cb110-2100" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb110-2101"><a href="#cb110-2101" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(</span>
<span id="cb110-2102"><a href="#cb110-2102" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb110-2103"><a href="#cb110-2103" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">colour =</span> <span class="st">"black"</span>),</span>
<span id="cb110-2104"><a href="#cb110-2104" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">"gray25"</span>),</span>
<span id="cb110-2105"><a href="#cb110-2105" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>)</span>
<span id="cb110-2106"><a href="#cb110-2106" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb110-2107"><a href="#cb110-2107" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_gray</span>()</span>
<span id="cb110-2108"><a href="#cb110-2108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2109"><a href="#cb110-2109" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> plot <span class="sc">|&gt;</span> ggplot2<span class="sc">::</span><span class="fu">ggplot_build</span>()</span>
<span id="cb110-2110"><a href="#cb110-2110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2111"><a href="#cb110-2111" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)) {</span>
<span id="cb110-2112"><a href="#cb110-2112" aria-hidden="true" tabindex="-1"></a>  <span class="co"># "#1b6ca8" "#3aaf85"</span></span>
<span id="cb110-2113"><a href="#cb110-2113" aria-hidden="true" tabindex="-1"></a>  plot<span class="sc">$</span>data[[i]]<span class="sc">$</span>colour <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb110-2114"><a href="#cb110-2114" aria-hidden="true" tabindex="-1"></a>    plot<span class="sc">$</span>data[[i]]<span class="sc">$</span>colour <span class="sc">==</span> <span class="st">"blue"</span> <span class="sc">~</span> <span class="fu">ifelse</span>(i <span class="sc">==</span> <span class="dv">4</span>, <span class="st">"red"</span>, <span class="st">"blue"</span>),</span>
<span id="cb110-2115"><a href="#cb110-2115" aria-hidden="true" tabindex="-1"></a>    plot<span class="sc">$</span>data[[i]]<span class="sc">$</span>colour <span class="sc">==</span> <span class="st">"#1b6ca8"</span> <span class="sc">~</span> <span class="st">"black"</span>,</span>
<span id="cb110-2116"><a href="#cb110-2116" aria-hidden="true" tabindex="-1"></a>    plot<span class="sc">$</span>data[[i]]<span class="sc">$</span>colour <span class="sc">==</span> <span class="st">"darkgray"</span> <span class="sc">~</span> <span class="st">"black"</span>,</span>
<span id="cb110-2117"><a href="#cb110-2117" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> plot<span class="sc">$</span>data[[i]]<span class="sc">$</span>colour</span>
<span id="cb110-2118"><a href="#cb110-2118" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb110-2119"><a href="#cb110-2119" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb110-2120"><a href="#cb110-2120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2121"><a href="#cb110-2121" aria-hidden="true" tabindex="-1"></a>plot <span class="sc">|&gt;</span> ggplot2<span class="sc">::</span><span class="fu">ggplot_gtable</span>() <span class="sc">|&gt;</span> ggplotify<span class="sc">::</span><span class="fu">as.ggplot</span>()</span>
<span id="cb110-2122"><a href="#cb110-2122" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-2123"><a href="#cb110-2123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2124"><a href="#cb110-2124" aria-hidden="true" tabindex="-1"></a>Influential observations. The blue line represents the <span class="co">[</span><span class="ot">Cook's distance</span><span class="co">](https://en.wikipedia.org/wiki/Cook%27s_distance)</span>. Any points outside the contour lines are influential observations.</span>
<span id="cb110-2125"><a href="#cb110-2125" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb110-2126"><a href="#cb110-2126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2127"><a href="#cb110-2127" aria-hidden="true" tabindex="-1"></a><span class="fu">####  Influence on prediction (DFFITS)</span></span>
<span id="cb110-2128"><a href="#cb110-2128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2129"><a href="#cb110-2129" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">DFFITS</span><span class="co">](https://en.wikipedia.org/wiki/DFFITS)</span> (difference in fits) is a standardized measure of how much the prediction for a given observation would change if it were deleted from the model. Each observation’s DFFITS is standardized by the standard deviation of fit at that point <span class="co">[</span><span class="ot">@struck2024</span><span class="co">]</span>.</span>
<span id="cb110-2130"><a href="#cb110-2130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2131"><a href="#cb110-2131" aria-hidden="true" tabindex="-1"></a>Learn more about DDFITS in: @welsch1977 and @belsley2004.</span>
<span id="cb110-2132"><a href="#cb110-2132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2135"><a href="#cb110-2135" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-2136"><a href="#cb110-2136" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> stats<span class="sc">::</span><span class="fu">dffits</span>() <span class="sc">|&gt;</span> <span class="fu">head</span>()</span>
<span id="cb110-2137"><a href="#cb110-2137" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-2138"><a href="#cb110-2138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2141"><a href="#cb110-2141" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-2142"><a href="#cb110-2142" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> olsrr<span class="sc">::</span><span class="fu">ols_plot_dffits</span>()</span>
<span id="cb110-2143"><a href="#cb110-2143" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-2144"><a href="#cb110-2144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2145"><a href="#cb110-2145" aria-hidden="true" tabindex="-1"></a><span class="fu">####  Influence on parameter estimates (DFBETAS)</span></span>
<span id="cb110-2146"><a href="#cb110-2146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2147"><a href="#cb110-2147" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">DFBETAS</span><span class="co">](https://en.wikipedia.org/wiki/Influential_observation#:~:text=measures%20of%20influence)</span> are standardized differences between regression coefficients in a model with a given observation, and a model without that observation. DFBETAS are standardized by the standard error of the coefficient.</span>
<span id="cb110-2148"><a href="#cb110-2148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2149"><a href="#cb110-2149" aria-hidden="true" tabindex="-1"></a>Learn more about DFBETAS in: @welsch1977 and @belsley2004.</span>
<span id="cb110-2150"><a href="#cb110-2150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2153"><a href="#cb110-2153" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-2154"><a href="#cb110-2154" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> stats<span class="sc">::</span><span class="fu">dfbeta</span>() <span class="sc">|&gt;</span> <span class="fu">head</span>()</span>
<span id="cb110-2155"><a href="#cb110-2155" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-2156"><a href="#cb110-2156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2159"><a href="#cb110-2159" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-2160"><a href="#cb110-2160" aria-hidden="true" tabindex="-1"></a>plots <span class="ot">&lt;-</span> fit_engine <span class="sc">|&gt;</span> olsrr<span class="sc">::</span><span class="fu">ols_plot_dfbetas</span>(<span class="at">print_plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb110-2161"><a href="#cb110-2161" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-2162"><a href="#cb110-2162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2165"><a href="#cb110-2165" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-2166"><a href="#cb110-2166" aria-hidden="true" tabindex="-1"></a>plots<span class="sc">$</span>plots[[<span class="dv">1</span>]]</span>
<span id="cb110-2167"><a href="#cb110-2167" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-2168"><a href="#cb110-2168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2171"><a href="#cb110-2171" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-2172"><a href="#cb110-2172" aria-hidden="true" tabindex="-1"></a>plots<span class="sc">$</span>plots[[<span class="dv">2</span>]]</span>
<span id="cb110-2173"><a href="#cb110-2173" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-2174"><a href="#cb110-2174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2177"><a href="#cb110-2177" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-2178"><a href="#cb110-2178" aria-hidden="true" tabindex="-1"></a>plots<span class="sc">$</span>plots[[<span class="dv">3</span>]]</span>
<span id="cb110-2179"><a href="#cb110-2179" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-2180"><a href="#cb110-2180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2183"><a href="#cb110-2183" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-2184"><a href="#cb110-2184" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> stats<span class="sc">::</span><span class="fu">dffits</span>() <span class="sc">|&gt;</span> <span class="fu">head</span>()</span>
<span id="cb110-2185"><a href="#cb110-2185" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-2186"><a href="#cb110-2186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2187"><a href="#cb110-2187" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Studentized residuals</span></span>
<span id="cb110-2188"><a href="#cb110-2188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2191"><a href="#cb110-2191" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-2192"><a href="#cb110-2192" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> stats<span class="sc">::</span><span class="fu">rstandard</span>() <span class="sc">|&gt;</span> <span class="fu">head</span>()</span>
<span id="cb110-2193"><a href="#cb110-2193" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-2194"><a href="#cb110-2194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2197"><a href="#cb110-2197" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-2198"><a href="#cb110-2198" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> stats<span class="sc">::</span><span class="fu">rstudent</span>() <span class="sc">|&gt;</span> <span class="fu">head</span>()</span>
<span id="cb110-2199"><a href="#cb110-2199" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-2200"><a href="#cb110-2200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2201"><a href="#cb110-2201" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Studentized Residual Plot</span><span class="co">](https://olsrr.rsquaredacademy.com/articles/influence_measures#studentized-residual-plot)</span></span>
<span id="cb110-2202"><a href="#cb110-2202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2205"><a href="#cb110-2205" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-2206"><a href="#cb110-2206" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> olsrr<span class="sc">::</span><span class="fu">ols_plot_resid_stud</span>()</span>
<span id="cb110-2207"><a href="#cb110-2207" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-2208"><a href="#cb110-2208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2209"><a href="#cb110-2209" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Standardized Residual Chart</span><span class="co">](https://olsrr.rsquaredacademy.com/articles/influence_measures#standardized-residual-chart)</span></span>
<span id="cb110-2210"><a href="#cb110-2210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2213"><a href="#cb110-2213" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-2214"><a href="#cb110-2214" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> olsrr<span class="sc">::</span><span class="fu">ols_plot_resid_stand</span>()</span>
<span id="cb110-2215"><a href="#cb110-2215" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-2216"><a href="#cb110-2216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2217"><a href="#cb110-2217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2218"><a href="#cb110-2218" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Studentized Residuals vs Leverage Plot</span><span class="co">](https://olsrr.rsquaredacademy.com/articles/influence_measures#standardized-residual-chart)</span></span>
<span id="cb110-2219"><a href="#cb110-2219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2220"><a href="#cb110-2220" aria-hidden="true" tabindex="-1"></a>::: {#fig-model-residual-diag-leverage}</span>
<span id="cb110-2223"><a href="#cb110-2223" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-2224"><a href="#cb110-2224" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> olsrr<span class="sc">::</span><span class="fu">ols_plot_resid_lev</span>()</span>
<span id="cb110-2225"><a href="#cb110-2225" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-2226"><a href="#cb110-2226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2227"><a href="#cb110-2227" aria-hidden="true" tabindex="-1"></a>Relation between the model studentized residuals and their leverage/influence points.</span>
<span id="cb110-2228"><a href="#cb110-2228" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb110-2229"><a href="#cb110-2229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2230"><a href="#cb110-2230" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Deleted Studentized Residual vs Fitted Values Plot</span><span class="co">](https://olsrr.rsquaredacademy.com/articles/influence_measures#standardized-residual-chart)</span></span>
<span id="cb110-2231"><a href="#cb110-2231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2234"><a href="#cb110-2234" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-2235"><a href="#cb110-2235" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> olsrr<span class="sc">::</span><span class="fu">ols_plot_resid_stud_fit</span>()</span>
<span id="cb110-2236"><a href="#cb110-2236" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-2237"><a href="#cb110-2237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2238"><a href="#cb110-2238" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Hadi plot</span></span>
<span id="cb110-2239"><a href="#cb110-2239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2240"><a href="#cb110-2240" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Hadi Plot</span><span class="co">](https://olsrr.rsquaredacademy.com/articles/influence_measures#hadi-plot)</span></span>
<span id="cb110-2241"><a href="#cb110-2241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2242"><a href="#cb110-2242" aria-hidden="true" tabindex="-1"></a>Learn more about Hadi's influence measure in: @chatterjee2012.</span>
<span id="cb110-2243"><a href="#cb110-2243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2246"><a href="#cb110-2246" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-2247"><a href="#cb110-2247" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> olsrr<span class="sc">::</span><span class="fu">ols_plot_hadi</span>()</span>
<span id="cb110-2248"><a href="#cb110-2248" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-2249"><a href="#cb110-2249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2250"><a href="#cb110-2250" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Potential Residual Plot</span><span class="co">](https://olsrr.rsquaredacademy.com/articles/influence_measures#hadi-plot)</span></span>
<span id="cb110-2251"><a href="#cb110-2251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2254"><a href="#cb110-2254" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-2255"><a href="#cb110-2255" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> olsrr<span class="sc">::</span><span class="fu">ols_plot_resid_pot</span>()</span>
<span id="cb110-2256"><a href="#cb110-2256" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-2257"><a href="#cb110-2257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2258"><a href="#cb110-2258" aria-hidden="true" tabindex="-1"></a><span class="fu">## Testing the hypothesis</span></span>
<span id="cb110-2259"><a href="#cb110-2259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2260"><a href="#cb110-2260" aria-hidden="true" tabindex="-1"></a>Let's now come back to our initial hypothesis:</span>
<span id="cb110-2261"><a href="#cb110-2261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2262"><a href="#cb110-2262" aria-hidden="true" tabindex="-1"></a>__Statement__</span>
<span id="cb110-2263"><a href="#cb110-2263" aria-hidden="true" tabindex="-1"></a>: The predictors <span class="in">`bill_length_mm`</span> and <span class="in">`bill_depth_mm`</span> effectively predict <span class="in">`flipper_length_mm`</span>.</span>
<span id="cb110-2264"><a href="#cb110-2264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2265"><a href="#cb110-2265" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb110-2266"><a href="#cb110-2266" aria-hidden="true" tabindex="-1"></a>\begin{cases}</span>
<span id="cb110-2267"><a href="#cb110-2267" aria-hidden="true" tabindex="-1"></a>\text{H}_{0}: \text{R}^{2}_{\text{adj}} \leq 0.5 <span class="sc">\\</span></span>
<span id="cb110-2268"><a href="#cb110-2268" aria-hidden="true" tabindex="-1"></a>\text{H}_{a}: \text{R}^{2}_{\text{adj}} &gt; 0.5</span>
<span id="cb110-2269"><a href="#cb110-2269" aria-hidden="true" tabindex="-1"></a>\end{cases}</span>
<span id="cb110-2270"><a href="#cb110-2270" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb110-2271"><a href="#cb110-2271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2272"><a href="#cb110-2272" aria-hidden="true" tabindex="-1"></a>Beyond a $\text{R}^{2}_{\text{adj}}$ over 0.5, predictor effects must be statistically significant, and model assumptions should be met.</span>
<span id="cb110-2273"><a href="#cb110-2273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2274"><a href="#cb110-2274" aria-hidden="true" tabindex="-1"></a>In the sections above, we have shown that the model meets the assumptions of linearity, normality, homoscedasticity, and independence. (**Model validity requirement**: True)</span>
<span id="cb110-2275"><a href="#cb110-2275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2276"><a href="#cb110-2276" aria-hidden="true" tabindex="-1"></a>The table below shows that the predictors <span class="in">`bill_length_mm`</span> and <span class="in">`bill_depth_mm`</span> are statistically significant in predicting <span class="in">`flipper_length_mm`</span>. (**Predictor significance requirement**: True)</span>
<span id="cb110-2277"><a href="#cb110-2277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2280"><a href="#cb110-2280" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-2281"><a href="#cb110-2281" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">|&gt;</span> </span>
<span id="cb110-2282"><a href="#cb110-2282" aria-hidden="true" tabindex="-1"></a>  broom<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">|&gt;</span></span>
<span id="cb110-2283"><a href="#cb110-2283" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">adorn_rounding</span>(<span class="dv">5</span>)</span>
<span id="cb110-2284"><a href="#cb110-2284" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-2285"><a href="#cb110-2285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2286"><a href="#cb110-2286" aria-hidden="true" tabindex="-1"></a>Now let's check the adjusted $R^{2}$ value to see if it is greater than 0.5. We can see in the table below that the adjusted $R^{2}$ is lower than 0.5 (<span class="in">`r round(broom::glance(fit)$adj.r.squared, 5)`</span>, which means that the model does not explain more than 50% of the variance in the dependent variable. So **we must reject the alternative hypothesis in favor of the null hypothesis**. (**Adjusted R squared requirement**: False)</span>
<span id="cb110-2287"><a href="#cb110-2287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2290"><a href="#cb110-2290" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-2291"><a href="#cb110-2291" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">|&gt;</span> </span>
<span id="cb110-2292"><a href="#cb110-2292" aria-hidden="true" tabindex="-1"></a>  broom<span class="sc">::</span><span class="fu">glance</span>() <span class="sc">|&gt;</span> </span>
<span id="cb110-2293"><a href="#cb110-2293" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">cols =</span> dplyr<span class="sc">::</span><span class="fu">everything</span>()) <span class="sc">|&gt;</span></span>
<span id="cb110-2294"><a href="#cb110-2294" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">adorn_rounding</span>(<span class="dv">10</span>)</span>
<span id="cb110-2295"><a href="#cb110-2295" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-2296"><a href="#cb110-2296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2299"><a href="#cb110-2299" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-2300"><a href="#cb110-2300" aria-hidden="true" tabindex="-1"></a><span class="co"># LCL = Lower Confidence Limit</span></span>
<span id="cb110-2301"><a href="#cb110-2301" aria-hidden="true" tabindex="-1"></a><span class="co"># UCL = Upper Confidence Limit</span></span>
<span id="cb110-2302"><a href="#cb110-2302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2303"><a href="#cb110-2303" aria-hidden="true" tabindex="-1"></a>psychometric<span class="sc">::</span><span class="fu">CI.Rsq</span>(</span>
<span id="cb110-2304"><a href="#cb110-2304" aria-hidden="true" tabindex="-1"></a>  <span class="at">rsq =</span> broom<span class="sc">::</span><span class="fu">glance</span>(fit)<span class="sc">$</span>adj.r.squared,</span>
<span id="cb110-2305"><a href="#cb110-2305" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="fu">nrow</span>(data),</span>
<span id="cb110-2306"><a href="#cb110-2306" aria-hidden="true" tabindex="-1"></a>  <span class="at">k =</span> <span class="fu">length</span>(fit_engine<span class="sc">$</span>coefficients) <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb110-2307"><a href="#cb110-2307" aria-hidden="true" tabindex="-1"></a>  <span class="at">level =</span> <span class="fl">0.95</span></span>
<span id="cb110-2308"><a href="#cb110-2308" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb110-2309"><a href="#cb110-2309" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-2310"><a href="#cb110-2310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2311"><a href="#cb110-2311" aria-hidden="true" tabindex="-1"></a>If we would like to interpret the adjusted $R^{2}$ value in terms of effect size, we can use the following code:</span>
<span id="cb110-2312"><a href="#cb110-2312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2313"><a href="#cb110-2313" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- @cohen1988 --&gt;</span></span>
<span id="cb110-2314"><a href="#cb110-2314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2317"><a href="#cb110-2317" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-2318"><a href="#cb110-2318" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">|&gt;</span> </span>
<span id="cb110-2319"><a href="#cb110-2319" aria-hidden="true" tabindex="-1"></a>  broom<span class="sc">::</span><span class="fu">glance</span>() <span class="sc">|&gt;</span> </span>
<span id="cb110-2320"><a href="#cb110-2320" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"adj.r.squared"</span>) <span class="sc">|&gt;</span></span>
<span id="cb110-2321"><a href="#cb110-2321" aria-hidden="true" tabindex="-1"></a>  effectsize<span class="sc">::</span><span class="fu">interpret_r2</span>(<span class="st">"cohen1988"</span>)</span>
<span id="cb110-2322"><a href="#cb110-2322" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-2323"><a href="#cb110-2323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2324"><a href="#cb110-2324" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- @falk1992 --&gt;</span></span>
<span id="cb110-2325"><a href="#cb110-2325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2328"><a href="#cb110-2328" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb110-2329"><a href="#cb110-2329" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">|&gt;</span> </span>
<span id="cb110-2330"><a href="#cb110-2330" aria-hidden="true" tabindex="-1"></a>  broom<span class="sc">::</span><span class="fu">glance</span>() <span class="sc">|&gt;</span> </span>
<span id="cb110-2331"><a href="#cb110-2331" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract2</span>(<span class="st">"adj.r.squared"</span>) <span class="sc">|&gt;</span></span>
<span id="cb110-2332"><a href="#cb110-2332" aria-hidden="true" tabindex="-1"></a>  effectsize<span class="sc">::</span><span class="fu">interpret_r2</span>(<span class="st">"falk1992"</span>)</span>
<span id="cb110-2333"><a href="#cb110-2333" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb110-2334"><a href="#cb110-2334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2335"><a href="#cb110-2335" aria-hidden="true" tabindex="-1"></a><span class="fu">## Conclusion</span></span>
<span id="cb110-2336"><a href="#cb110-2336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2337"><a href="#cb110-2337" aria-hidden="true" tabindex="-1"></a>Following our criteria we can now answer our question:</span>
<span id="cb110-2338"><a href="#cb110-2338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2339"><a href="#cb110-2339" aria-hidden="true" tabindex="-1"></a>**Can bill length and bill depth alone effectively predict flipper length in Adélie penguins?**</span>
<span id="cb110-2340"><a href="#cb110-2340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2341"><a href="#cb110-2341" aria-hidden="true" tabindex="-1"></a>The answer is **No**. The model does not explain more than 50% of the variance in the dependent variable, which means that the predictors <span class="in">`bill_length_mm`</span> and <span class="in">`bill_depth_mm`</span> are not effective in predicting <span class="in">`flipper_length_mm`</span>.</span>
<span id="cb110-2342"><a href="#cb110-2342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2343"><a href="#cb110-2343" aria-hidden="true" tabindex="-1"></a><span class="fu">## Notes</span></span>
<span id="cb110-2344"><a href="#cb110-2344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2345"><a href="#cb110-2345" aria-hidden="true" tabindex="-1"></a>Before using objective assumption tests (e.g., Anderson–Darling test), it's important to note that they may be not advisable in some contexts. In larger samples, these tests can be overly sensitive to minor deviations, while in smaller samples, they may not detect significant deviations. Additionally, they might overlook visual patterns that are not captured by a single metric. Therefore, visual assessment of diagnostic plots may be a better way <span class="co">[</span><span class="ot">@shatz2024; @kozak2018; @schucany2006</span><span class="co">]</span>. For a straightforward critique of normality tests specifically, refer to <span class="co">[</span><span class="ot">this</span><span class="co">](https://towardsdatascience.com/stop-testing-for-normality-dba96bb73f90)</span> article by @greener2020.</span>
<span id="cb110-2346"><a href="#cb110-2346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2347"><a href="#cb110-2347" aria-hidden="true" tabindex="-1"></a>I hope you like this report. If you have any questions, please feel free to ask. You can find me on <span class="co">[</span><span class="ot">GitHub</span><span class="co">](https://github.com/danielvartan)</span>.</span>
<span id="cb110-2348"><a href="#cb110-2348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2349"><a href="#cb110-2349" aria-hidden="true" tabindex="-1"></a><span class="fu">## Further reading</span></span>
<span id="cb110-2350"><a href="#cb110-2350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2351"><a href="#cb110-2351" aria-hidden="true" tabindex="-1"></a>I recommend the following resources for further reading:</span>
<span id="cb110-2352"><a href="#cb110-2352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2353"><a href="#cb110-2353" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>@allen1997</span>
<span id="cb110-2354"><a href="#cb110-2354" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>@bussab1988 (pt-BR)</span>
<span id="cb110-2355"><a href="#cb110-2355" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>@casella2002</span>
<span id="cb110-2356"><a href="#cb110-2356" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>@dalpiaz</span>
<span id="cb110-2357"><a href="#cb110-2357" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>@degroot2012</span>
<span id="cb110-2358"><a href="#cb110-2358" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>@dudek2020</span>
<span id="cb110-2359"><a href="#cb110-2359" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>@fox2016</span>
<span id="cb110-2360"><a href="#cb110-2360" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>@hair2019</span>
<span id="cb110-2361"><a href="#cb110-2361" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>@johnson2013</span>
<span id="cb110-2362"><a href="#cb110-2362" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>@kuhn2022</span>
<span id="cb110-2363"><a href="#cb110-2363" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>@struck2024</span>
<span id="cb110-2364"><a href="#cb110-2364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2365"><a href="#cb110-2365" aria-hidden="true" tabindex="-1"></a>I also highly recommend Josh Starmer's <span class="co">[</span><span class="ot">StatQuest</span><span class="co">](https://www.youtube.com/@statquest)</span> channel. The following videos are particularly helpful:</span>
<span id="cb110-2366"><a href="#cb110-2366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2367"><a href="#cb110-2367" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Starmer, J. (Nov 18, 2022). _Multiple Regression, Clearly Explained!!!_ <span class="co">[</span><span class="ot">YouTube video</span><span class="co">]</span>. <span class="co">[</span><span class="ot">https://youtu.be/EkAQAi3a4js?si=MfKPGlFcYqfFAM7j</span><span class="co">](https://youtu.be/EkAQAi3a4js?si=MfKPGlFcYqfFAM7j)</span></span>
<span id="cb110-2368"><a href="#cb110-2368" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Starmer, J. (Nov 18, 2022). _Multiple Regression in R, Step by Step!!!_ <span class="co">[</span><span class="ot">YouTube video</span><span class="co">]</span>. <span class="co">[</span><span class="ot">https://youtu.be/mno47Jn4gaU?si=oba5odJm8fjeizs0</span><span class="co">](https://youtu.be/mno47Jn4gaU?si=oba5odJm8fjeizs0)</span></span>
<span id="cb110-2369"><a href="#cb110-2369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2370"><a href="#cb110-2370" aria-hidden="true" tabindex="-1"></a><span class="fu">## References {.unnumbered}</span></span>
<span id="cb110-2371"><a href="#cb110-2371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2372"><a href="#cb110-2372" aria-hidden="true" tabindex="-1"></a>::: {#refs}</span>
<span id="cb110-2373"><a href="#cb110-2373" aria-hidden="true" tabindex="-1"></a>:::</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/danielvartan/linear-models/edit/main/index.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/danielvartan/linear-models/blob/main/index.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li><li><a href="https://github.com/danielvartan/linear-models/issues/" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>